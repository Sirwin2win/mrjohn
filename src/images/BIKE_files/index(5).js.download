(function(global2, factory) {
  typeof exports === "object" && typeof module !== "undefined" ? factory(exports, require("react")) : typeof define === "function" && define.amd ? define(["exports", "react"], factory) : (global2 = typeof globalThis !== "undefined" ? globalThis : global2 || self, factory(global2.ImHeaderNotification = {}, global2.React));
})(this, function(exports2, React) {
  "use strict";
  var VersionIs = /* @__PURE__ */ function(VersionIs2) {
    VersionIs2[VersionIs2["LessThan"] = -1] = "LessThan";
    VersionIs2[VersionIs2["EqualTo"] = 0] = "EqualTo";
    VersionIs2[VersionIs2["GreaterThan"] = 1] = "GreaterThan";
    return VersionIs2;
  }({});
  function versionCompare(current, other) {
    var cp = String(current).split(".");
    var op = String(other).split(".");
    for (var depth = 0; depth < Math.min(cp.length, op.length); depth++) {
      var cn = Number(cp[depth]);
      var on = Number(op[depth]);
      if (cn > on) return VersionIs.GreaterThan;
      if (on > cn) return VersionIs.LessThan;
      if (!isNaN(cn) && isNaN(on)) return VersionIs.GreaterThan;
      if (isNaN(cn) && !isNaN(on)) return VersionIs.LessThan;
    }
    return VersionIs.EqualTo;
  }
  var commonjsGlobal = typeof globalThis !== "undefined" ? globalThis : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : {};
  function getDefaultExportFromCjs(x) {
    return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, "default") ? x["default"] : x;
  }
  var md5$1 = { exports: {} };
  var crypt = { exports: {} };
  (function() {
    var base64map = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", crypt$1 = {
      // Bit-wise rotation left
      rotl: function(n, b) {
        return n << b | n >>> 32 - b;
      },
      // Bit-wise rotation right
      rotr: function(n, b) {
        return n << 32 - b | n >>> b;
      },
      // Swap big-endian to little-endian and vice versa
      endian: function(n) {
        if (n.constructor == Number) {
          return crypt$1.rotl(n, 8) & 16711935 | crypt$1.rotl(n, 24) & 4278255360;
        }
        for (var i = 0; i < n.length; i++)
          n[i] = crypt$1.endian(n[i]);
        return n;
      },
      // Generate an array of any length of random bytes
      randomBytes: function(n) {
        for (var bytes = []; n > 0; n--)
          bytes.push(Math.floor(Math.random() * 256));
        return bytes;
      },
      // Convert a byte array to big-endian 32-bit words
      bytesToWords: function(bytes) {
        for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)
          words[b >>> 5] |= bytes[i] << 24 - b % 32;
        return words;
      },
      // Convert big-endian 32-bit words to a byte array
      wordsToBytes: function(words) {
        for (var bytes = [], b = 0; b < words.length * 32; b += 8)
          bytes.push(words[b >>> 5] >>> 24 - b % 32 & 255);
        return bytes;
      },
      // Convert a byte array to a hex string
      bytesToHex: function(bytes) {
        for (var hex = [], i = 0; i < bytes.length; i++) {
          hex.push((bytes[i] >>> 4).toString(16));
          hex.push((bytes[i] & 15).toString(16));
        }
        return hex.join("");
      },
      // Convert a hex string to a byte array
      hexToBytes: function(hex) {
        for (var bytes = [], c = 0; c < hex.length; c += 2)
          bytes.push(parseInt(hex.substr(c, 2), 16));
        return bytes;
      },
      // Convert a byte array to a base-64 string
      bytesToBase64: function(bytes) {
        for (var base64 = [], i = 0; i < bytes.length; i += 3) {
          var triplet = bytes[i] << 16 | bytes[i + 1] << 8 | bytes[i + 2];
          for (var j = 0; j < 4; j++)
            if (i * 8 + j * 6 <= bytes.length * 8)
              base64.push(base64map.charAt(triplet >>> 6 * (3 - j) & 63));
            else
              base64.push("=");
        }
        return base64.join("");
      },
      // Convert a base-64 string to a byte array
      base64ToBytes: function(base64) {
        base64 = base64.replace(/[^A-Z0-9+\/]/ig, "");
        for (var bytes = [], i = 0, imod4 = 0; i < base64.length; imod4 = ++i % 4) {
          if (imod4 == 0) continue;
          bytes.push((base64map.indexOf(base64.charAt(i - 1)) & Math.pow(2, -2 * imod4 + 8) - 1) << imod4 * 2 | base64map.indexOf(base64.charAt(i)) >>> 6 - imod4 * 2);
        }
        return bytes;
      }
    };
    crypt.exports = crypt$1;
  })();
  var cryptExports = crypt.exports;
  var charenc = {
    // UTF-8 encoding
    utf8: {
      // Convert a string to a byte array
      stringToBytes: function(str) {
        return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));
      },
      // Convert a byte array to a string
      bytesToString: function(bytes) {
        return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));
      }
    },
    // Binary encoding
    bin: {
      // Convert a string to a byte array
      stringToBytes: function(str) {
        for (var bytes = [], i = 0; i < str.length; i++)
          bytes.push(str.charCodeAt(i) & 255);
        return bytes;
      },
      // Convert a byte array to a string
      bytesToString: function(bytes) {
        for (var str = [], i = 0; i < bytes.length; i++)
          str.push(String.fromCharCode(bytes[i]));
        return str.join("");
      }
    }
  };
  var charenc_1 = charenc;
  /*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   */
  var isBuffer_1 = function(obj) {
    return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer);
  };
  function isBuffer(obj) {
    return !!obj.constructor && typeof obj.constructor.isBuffer === "function" && obj.constructor.isBuffer(obj);
  }
  function isSlowBuffer(obj) {
    return typeof obj.readFloatLE === "function" && typeof obj.slice === "function" && isBuffer(obj.slice(0, 0));
  }
  (function() {
    var crypt2 = cryptExports, utf8 = charenc_1.utf8, isBuffer2 = isBuffer_1, bin = charenc_1.bin, md52 = function(message, options) {
      if (message.constructor == String)
        if (options && options.encoding === "binary")
          message = bin.stringToBytes(message);
        else
          message = utf8.stringToBytes(message);
      else if (isBuffer2(message))
        message = Array.prototype.slice.call(message, 0);
      else if (!Array.isArray(message) && message.constructor !== Uint8Array)
        message = message.toString();
      var m = crypt2.bytesToWords(message), l = message.length * 8, a = 1732584193, b = -271733879, c = -1732584194, d = 271733878;
      for (var i = 0; i < m.length; i++) {
        m[i] = (m[i] << 8 | m[i] >>> 24) & 16711935 | (m[i] << 24 | m[i] >>> 8) & 4278255360;
      }
      m[l >>> 5] |= 128 << l % 32;
      m[(l + 64 >>> 9 << 4) + 14] = l;
      var FF = md52._ff, GG = md52._gg, HH = md52._hh, II = md52._ii;
      for (var i = 0; i < m.length; i += 16) {
        var aa = a, bb = b, cc = c, dd = d;
        a = FF(a, b, c, d, m[i + 0], 7, -680876936);
        d = FF(d, a, b, c, m[i + 1], 12, -389564586);
        c = FF(c, d, a, b, m[i + 2], 17, 606105819);
        b = FF(b, c, d, a, m[i + 3], 22, -1044525330);
        a = FF(a, b, c, d, m[i + 4], 7, -176418897);
        d = FF(d, a, b, c, m[i + 5], 12, 1200080426);
        c = FF(c, d, a, b, m[i + 6], 17, -1473231341);
        b = FF(b, c, d, a, m[i + 7], 22, -45705983);
        a = FF(a, b, c, d, m[i + 8], 7, 1770035416);
        d = FF(d, a, b, c, m[i + 9], 12, -1958414417);
        c = FF(c, d, a, b, m[i + 10], 17, -42063);
        b = FF(b, c, d, a, m[i + 11], 22, -1990404162);
        a = FF(a, b, c, d, m[i + 12], 7, 1804603682);
        d = FF(d, a, b, c, m[i + 13], 12, -40341101);
        c = FF(c, d, a, b, m[i + 14], 17, -1502002290);
        b = FF(b, c, d, a, m[i + 15], 22, 1236535329);
        a = GG(a, b, c, d, m[i + 1], 5, -165796510);
        d = GG(d, a, b, c, m[i + 6], 9, -1069501632);
        c = GG(c, d, a, b, m[i + 11], 14, 643717713);
        b = GG(b, c, d, a, m[i + 0], 20, -373897302);
        a = GG(a, b, c, d, m[i + 5], 5, -701558691);
        d = GG(d, a, b, c, m[i + 10], 9, 38016083);
        c = GG(c, d, a, b, m[i + 15], 14, -660478335);
        b = GG(b, c, d, a, m[i + 4], 20, -405537848);
        a = GG(a, b, c, d, m[i + 9], 5, 568446438);
        d = GG(d, a, b, c, m[i + 14], 9, -1019803690);
        c = GG(c, d, a, b, m[i + 3], 14, -187363961);
        b = GG(b, c, d, a, m[i + 8], 20, 1163531501);
        a = GG(a, b, c, d, m[i + 13], 5, -1444681467);
        d = GG(d, a, b, c, m[i + 2], 9, -51403784);
        c = GG(c, d, a, b, m[i + 7], 14, 1735328473);
        b = GG(b, c, d, a, m[i + 12], 20, -1926607734);
        a = HH(a, b, c, d, m[i + 5], 4, -378558);
        d = HH(d, a, b, c, m[i + 8], 11, -2022574463);
        c = HH(c, d, a, b, m[i + 11], 16, 1839030562);
        b = HH(b, c, d, a, m[i + 14], 23, -35309556);
        a = HH(a, b, c, d, m[i + 1], 4, -1530992060);
        d = HH(d, a, b, c, m[i + 4], 11, 1272893353);
        c = HH(c, d, a, b, m[i + 7], 16, -155497632);
        b = HH(b, c, d, a, m[i + 10], 23, -1094730640);
        a = HH(a, b, c, d, m[i + 13], 4, 681279174);
        d = HH(d, a, b, c, m[i + 0], 11, -358537222);
        c = HH(c, d, a, b, m[i + 3], 16, -722521979);
        b = HH(b, c, d, a, m[i + 6], 23, 76029189);
        a = HH(a, b, c, d, m[i + 9], 4, -640364487);
        d = HH(d, a, b, c, m[i + 12], 11, -421815835);
        c = HH(c, d, a, b, m[i + 15], 16, 530742520);
        b = HH(b, c, d, a, m[i + 2], 23, -995338651);
        a = II(a, b, c, d, m[i + 0], 6, -198630844);
        d = II(d, a, b, c, m[i + 7], 10, 1126891415);
        c = II(c, d, a, b, m[i + 14], 15, -1416354905);
        b = II(b, c, d, a, m[i + 5], 21, -57434055);
        a = II(a, b, c, d, m[i + 12], 6, 1700485571);
        d = II(d, a, b, c, m[i + 3], 10, -1894986606);
        c = II(c, d, a, b, m[i + 10], 15, -1051523);
        b = II(b, c, d, a, m[i + 1], 21, -2054922799);
        a = II(a, b, c, d, m[i + 8], 6, 1873313359);
        d = II(d, a, b, c, m[i + 15], 10, -30611744);
        c = II(c, d, a, b, m[i + 6], 15, -1560198380);
        b = II(b, c, d, a, m[i + 13], 21, 1309151649);
        a = II(a, b, c, d, m[i + 4], 6, -145523070);
        d = II(d, a, b, c, m[i + 11], 10, -1120210379);
        c = II(c, d, a, b, m[i + 2], 15, 718787259);
        b = II(b, c, d, a, m[i + 9], 21, -343485551);
        a = a + aa >>> 0;
        b = b + bb >>> 0;
        c = c + cc >>> 0;
        d = d + dd >>> 0;
      }
      return crypt2.endian([a, b, c, d]);
    };
    md52._ff = function(a, b, c, d, x, s, t) {
      var n = a + (b & c | ~b & d) + (x >>> 0) + t;
      return (n << s | n >>> 32 - s) + b;
    };
    md52._gg = function(a, b, c, d, x, s, t) {
      var n = a + (b & d | c & ~d) + (x >>> 0) + t;
      return (n << s | n >>> 32 - s) + b;
    };
    md52._hh = function(a, b, c, d, x, s, t) {
      var n = a + (b ^ c ^ d) + (x >>> 0) + t;
      return (n << s | n >>> 32 - s) + b;
    };
    md52._ii = function(a, b, c, d, x, s, t) {
      var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;
      return (n << s | n >>> 32 - s) + b;
    };
    md52._blocksize = 16;
    md52._digestsize = 16;
    md5$1.exports = function(message, options) {
      if (message === void 0 || message === null)
        throw new Error("Illegal argument " + message);
      var digestbytes = crypt2.wordsToBytes(md52(message, options));
      return options && options.asBytes ? digestbytes : options && options.asString ? bin.bytesToString(digestbytes) : crypt2.bytesToHex(digestbytes);
    };
  })();
  var md5Exports = md5$1.exports;
  const md5 = /* @__PURE__ */ getDefaultExportFromCjs(md5Exports);
  var BigInteger$1 = { exports: {} };
  (function(module2) {
    var bigInt = function(undefined$1) {
      var BASE = 1e7, LOG_BASE = 7, MAX_INT = 9007199254740992, MAX_INT_ARR = smallToArray(MAX_INT), DEFAULT_ALPHABET = "0123456789abcdefghijklmnopqrstuvwxyz";
      var supportsNativeBigInt = typeof BigInt === "function";
      function Integer(v, radix, alphabet, caseSensitive) {
        if (typeof v === "undefined") return Integer[0];
        if (typeof radix !== "undefined") return +radix === 10 && !alphabet ? parseValue(v) : parseBase(v, radix, alphabet, caseSensitive);
        return parseValue(v);
      }
      function BigInteger2(value, sign) {
        this.value = value;
        this.sign = sign;
        this.isSmall = false;
      }
      BigInteger2.prototype = Object.create(Integer.prototype);
      function SmallInteger(value) {
        this.value = value;
        this.sign = value < 0;
        this.isSmall = true;
      }
      SmallInteger.prototype = Object.create(Integer.prototype);
      function NativeBigInt(value) {
        this.value = value;
      }
      NativeBigInt.prototype = Object.create(Integer.prototype);
      function isPrecise(n) {
        return -MAX_INT < n && n < MAX_INT;
      }
      function smallToArray(n) {
        if (n < 1e7)
          return [n];
        if (n < 1e14)
          return [n % 1e7, Math.floor(n / 1e7)];
        return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];
      }
      function arrayToSmall(arr) {
        trim(arr);
        var length = arr.length;
        if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {
          switch (length) {
            case 0:
              return 0;
            case 1:
              return arr[0];
            case 2:
              return arr[0] + arr[1] * BASE;
            default:
              return arr[0] + (arr[1] + arr[2] * BASE) * BASE;
          }
        }
        return arr;
      }
      function trim(v) {
        var i2 = v.length;
        while (v[--i2] === 0) ;
        v.length = i2 + 1;
      }
      function createArray(length) {
        var x = new Array(length);
        var i2 = -1;
        while (++i2 < length) {
          x[i2] = 0;
        }
        return x;
      }
      function truncate(n) {
        if (n > 0) return Math.floor(n);
        return Math.ceil(n);
      }
      function add(a, b) {
        var l_a = a.length, l_b = b.length, r = new Array(l_a), carry = 0, base = BASE, sum, i2;
        for (i2 = 0; i2 < l_b; i2++) {
          sum = a[i2] + b[i2] + carry;
          carry = sum >= base ? 1 : 0;
          r[i2] = sum - carry * base;
        }
        while (i2 < l_a) {
          sum = a[i2] + carry;
          carry = sum === base ? 1 : 0;
          r[i2++] = sum - carry * base;
        }
        if (carry > 0) r.push(carry);
        return r;
      }
      function addAny(a, b) {
        if (a.length >= b.length) return add(a, b);
        return add(b, a);
      }
      function addSmall(a, carry) {
        var l = a.length, r = new Array(l), base = BASE, sum, i2;
        for (i2 = 0; i2 < l; i2++) {
          sum = a[i2] - base + carry;
          carry = Math.floor(sum / base);
          r[i2] = sum - carry * base;
          carry += 1;
        }
        while (carry > 0) {
          r[i2++] = carry % base;
          carry = Math.floor(carry / base);
        }
        return r;
      }
      BigInteger2.prototype.add = function(v) {
        var n = parseValue(v);
        if (this.sign !== n.sign) {
          return this.subtract(n.negate());
        }
        var a = this.value, b = n.value;
        if (n.isSmall) {
          return new BigInteger2(addSmall(a, Math.abs(b)), this.sign);
        }
        return new BigInteger2(addAny(a, b), this.sign);
      };
      BigInteger2.prototype.plus = BigInteger2.prototype.add;
      SmallInteger.prototype.add = function(v) {
        var n = parseValue(v);
        var a = this.value;
        if (a < 0 !== n.sign) {
          return this.subtract(n.negate());
        }
        var b = n.value;
        if (n.isSmall) {
          if (isPrecise(a + b)) return new SmallInteger(a + b);
          b = smallToArray(Math.abs(b));
        }
        return new BigInteger2(addSmall(b, Math.abs(a)), a < 0);
      };
      SmallInteger.prototype.plus = SmallInteger.prototype.add;
      NativeBigInt.prototype.add = function(v) {
        return new NativeBigInt(this.value + parseValue(v).value);
      };
      NativeBigInt.prototype.plus = NativeBigInt.prototype.add;
      function subtract(a, b) {
        var a_l = a.length, b_l = b.length, r = new Array(a_l), borrow = 0, base = BASE, i2, difference;
        for (i2 = 0; i2 < b_l; i2++) {
          difference = a[i2] - borrow - b[i2];
          if (difference < 0) {
            difference += base;
            borrow = 1;
          } else borrow = 0;
          r[i2] = difference;
        }
        for (i2 = b_l; i2 < a_l; i2++) {
          difference = a[i2] - borrow;
          if (difference < 0) difference += base;
          else {
            r[i2++] = difference;
            break;
          }
          r[i2] = difference;
        }
        for (; i2 < a_l; i2++) {
          r[i2] = a[i2];
        }
        trim(r);
        return r;
      }
      function subtractAny(a, b, sign) {
        var value;
        if (compareAbs(a, b) >= 0) {
          value = subtract(a, b);
        } else {
          value = subtract(b, a);
          sign = !sign;
        }
        value = arrayToSmall(value);
        if (typeof value === "number") {
          if (sign) value = -value;
          return new SmallInteger(value);
        }
        return new BigInteger2(value, sign);
      }
      function subtractSmall(a, b, sign) {
        var l = a.length, r = new Array(l), carry = -b, base = BASE, i2, difference;
        for (i2 = 0; i2 < l; i2++) {
          difference = a[i2] + carry;
          carry = Math.floor(difference / base);
          difference %= base;
          r[i2] = difference < 0 ? difference + base : difference;
        }
        r = arrayToSmall(r);
        if (typeof r === "number") {
          if (sign) r = -r;
          return new SmallInteger(r);
        }
        return new BigInteger2(r, sign);
      }
      BigInteger2.prototype.subtract = function(v) {
        var n = parseValue(v);
        if (this.sign !== n.sign) {
          return this.add(n.negate());
        }
        var a = this.value, b = n.value;
        if (n.isSmall)
          return subtractSmall(a, Math.abs(b), this.sign);
        return subtractAny(a, b, this.sign);
      };
      BigInteger2.prototype.minus = BigInteger2.prototype.subtract;
      SmallInteger.prototype.subtract = function(v) {
        var n = parseValue(v);
        var a = this.value;
        if (a < 0 !== n.sign) {
          return this.add(n.negate());
        }
        var b = n.value;
        if (n.isSmall) {
          return new SmallInteger(a - b);
        }
        return subtractSmall(b, Math.abs(a), a >= 0);
      };
      SmallInteger.prototype.minus = SmallInteger.prototype.subtract;
      NativeBigInt.prototype.subtract = function(v) {
        return new NativeBigInt(this.value - parseValue(v).value);
      };
      NativeBigInt.prototype.minus = NativeBigInt.prototype.subtract;
      BigInteger2.prototype.negate = function() {
        return new BigInteger2(this.value, !this.sign);
      };
      SmallInteger.prototype.negate = function() {
        var sign = this.sign;
        var small = new SmallInteger(-this.value);
        small.sign = !sign;
        return small;
      };
      NativeBigInt.prototype.negate = function() {
        return new NativeBigInt(-this.value);
      };
      BigInteger2.prototype.abs = function() {
        return new BigInteger2(this.value, false);
      };
      SmallInteger.prototype.abs = function() {
        return new SmallInteger(Math.abs(this.value));
      };
      NativeBigInt.prototype.abs = function() {
        return new NativeBigInt(this.value >= 0 ? this.value : -this.value);
      };
      function multiplyLong(a, b) {
        var a_l = a.length, b_l = b.length, l = a_l + b_l, r = createArray(l), base = BASE, product, carry, i2, a_i, b_j;
        for (i2 = 0; i2 < a_l; ++i2) {
          a_i = a[i2];
          for (var j = 0; j < b_l; ++j) {
            b_j = b[j];
            product = a_i * b_j + r[i2 + j];
            carry = Math.floor(product / base);
            r[i2 + j] = product - carry * base;
            r[i2 + j + 1] += carry;
          }
        }
        trim(r);
        return r;
      }
      function multiplySmall(a, b) {
        var l = a.length, r = new Array(l), base = BASE, carry = 0, product, i2;
        for (i2 = 0; i2 < l; i2++) {
          product = a[i2] * b + carry;
          carry = Math.floor(product / base);
          r[i2] = product - carry * base;
        }
        while (carry > 0) {
          r[i2++] = carry % base;
          carry = Math.floor(carry / base);
        }
        return r;
      }
      function shiftLeft(x, n) {
        var r = [];
        while (n-- > 0) r.push(0);
        return r.concat(x);
      }
      function multiplyKaratsuba(x, y) {
        var n = Math.max(x.length, y.length);
        if (n <= 30) return multiplyLong(x, y);
        n = Math.ceil(n / 2);
        var b = x.slice(n), a = x.slice(0, n), d = y.slice(n), c = y.slice(0, n);
        var ac = multiplyKaratsuba(a, c), bd = multiplyKaratsuba(b, d), abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));
        var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));
        trim(product);
        return product;
      }
      function useKaratsuba(l1, l2) {
        return -0.012 * l1 - 0.012 * l2 + 15e-6 * l1 * l2 > 0;
      }
      BigInteger2.prototype.multiply = function(v) {
        var n = parseValue(v), a = this.value, b = n.value, sign = this.sign !== n.sign, abs;
        if (n.isSmall) {
          if (b === 0) return Integer[0];
          if (b === 1) return this;
          if (b === -1) return this.negate();
          abs = Math.abs(b);
          if (abs < BASE) {
            return new BigInteger2(multiplySmall(a, abs), sign);
          }
          b = smallToArray(abs);
        }
        if (useKaratsuba(a.length, b.length))
          return new BigInteger2(multiplyKaratsuba(a, b), sign);
        return new BigInteger2(multiplyLong(a, b), sign);
      };
      BigInteger2.prototype.times = BigInteger2.prototype.multiply;
      function multiplySmallAndArray(a, b, sign) {
        if (a < BASE) {
          return new BigInteger2(multiplySmall(b, a), sign);
        }
        return new BigInteger2(multiplyLong(b, smallToArray(a)), sign);
      }
      SmallInteger.prototype._multiplyBySmall = function(a) {
        if (isPrecise(a.value * this.value)) {
          return new SmallInteger(a.value * this.value);
        }
        return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);
      };
      BigInteger2.prototype._multiplyBySmall = function(a) {
        if (a.value === 0) return Integer[0];
        if (a.value === 1) return this;
        if (a.value === -1) return this.negate();
        return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);
      };
      SmallInteger.prototype.multiply = function(v) {
        return parseValue(v)._multiplyBySmall(this);
      };
      SmallInteger.prototype.times = SmallInteger.prototype.multiply;
      NativeBigInt.prototype.multiply = function(v) {
        return new NativeBigInt(this.value * parseValue(v).value);
      };
      NativeBigInt.prototype.times = NativeBigInt.prototype.multiply;
      function square(a) {
        var l = a.length, r = createArray(l + l), base = BASE, product, carry, i2, a_i, a_j;
        for (i2 = 0; i2 < l; i2++) {
          a_i = a[i2];
          carry = 0 - a_i * a_i;
          for (var j = i2; j < l; j++) {
            a_j = a[j];
            product = 2 * (a_i * a_j) + r[i2 + j] + carry;
            carry = Math.floor(product / base);
            r[i2 + j] = product - carry * base;
          }
          r[i2 + l] = carry;
        }
        trim(r);
        return r;
      }
      BigInteger2.prototype.square = function() {
        return new BigInteger2(square(this.value), false);
      };
      SmallInteger.prototype.square = function() {
        var value = this.value * this.value;
        if (isPrecise(value)) return new SmallInteger(value);
        return new BigInteger2(square(smallToArray(Math.abs(this.value))), false);
      };
      NativeBigInt.prototype.square = function(v) {
        return new NativeBigInt(this.value * this.value);
      };
      function divMod1(a, b) {
        var a_l = a.length, b_l = b.length, base = BASE, result = createArray(b.length), divisorMostSignificantDigit = b[b_l - 1], lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)), remainder = multiplySmall(a, lambda), divisor = multiplySmall(b, lambda), quotientDigit, shift, carry, borrow, i2, l, q;
        if (remainder.length <= a_l) remainder.push(0);
        divisor.push(0);
        divisorMostSignificantDigit = divisor[b_l - 1];
        for (shift = a_l - b_l; shift >= 0; shift--) {
          quotientDigit = base - 1;
          if (remainder[shift + b_l] !== divisorMostSignificantDigit) {
            quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);
          }
          carry = 0;
          borrow = 0;
          l = divisor.length;
          for (i2 = 0; i2 < l; i2++) {
            carry += quotientDigit * divisor[i2];
            q = Math.floor(carry / base);
            borrow += remainder[shift + i2] - (carry - q * base);
            carry = q;
            if (borrow < 0) {
              remainder[shift + i2] = borrow + base;
              borrow = -1;
            } else {
              remainder[shift + i2] = borrow;
              borrow = 0;
            }
          }
          while (borrow !== 0) {
            quotientDigit -= 1;
            carry = 0;
            for (i2 = 0; i2 < l; i2++) {
              carry += remainder[shift + i2] - base + divisor[i2];
              if (carry < 0) {
                remainder[shift + i2] = carry + base;
                carry = 0;
              } else {
                remainder[shift + i2] = carry;
                carry = 1;
              }
            }
            borrow += carry;
          }
          result[shift] = quotientDigit;
        }
        remainder = divModSmall(remainder, lambda)[0];
        return [arrayToSmall(result), arrayToSmall(remainder)];
      }
      function divMod2(a, b) {
        var a_l = a.length, b_l = b.length, result = [], part = [], base = BASE, guess, xlen, highx, highy, check;
        while (a_l) {
          part.unshift(a[--a_l]);
          trim(part);
          if (compareAbs(part, b) < 0) {
            result.push(0);
            continue;
          }
          xlen = part.length;
          highx = part[xlen - 1] * base + part[xlen - 2];
          highy = b[b_l - 1] * base + b[b_l - 2];
          if (xlen > b_l) {
            highx = (highx + 1) * base;
          }
          guess = Math.ceil(highx / highy);
          do {
            check = multiplySmall(b, guess);
            if (compareAbs(check, part) <= 0) break;
            guess--;
          } while (guess);
          result.push(guess);
          part = subtract(part, check);
        }
        result.reverse();
        return [arrayToSmall(result), arrayToSmall(part)];
      }
      function divModSmall(value, lambda) {
        var length = value.length, quotient = createArray(length), base = BASE, i2, q, remainder, divisor;
        remainder = 0;
        for (i2 = length - 1; i2 >= 0; --i2) {
          divisor = remainder * base + value[i2];
          q = truncate(divisor / lambda);
          remainder = divisor - q * lambda;
          quotient[i2] = q | 0;
        }
        return [quotient, remainder | 0];
      }
      function divModAny(self2, v) {
        var value, n = parseValue(v);
        if (supportsNativeBigInt) {
          return [new NativeBigInt(self2.value / n.value), new NativeBigInt(self2.value % n.value)];
        }
        var a = self2.value, b = n.value;
        var quotient;
        if (b === 0) throw new Error("Cannot divide by zero");
        if (self2.isSmall) {
          if (n.isSmall) {
            return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];
          }
          return [Integer[0], self2];
        }
        if (n.isSmall) {
          if (b === 1) return [self2, Integer[0]];
          if (b == -1) return [self2.negate(), Integer[0]];
          var abs = Math.abs(b);
          if (abs < BASE) {
            value = divModSmall(a, abs);
            quotient = arrayToSmall(value[0]);
            var remainder = value[1];
            if (self2.sign) remainder = -remainder;
            if (typeof quotient === "number") {
              if (self2.sign !== n.sign) quotient = -quotient;
              return [new SmallInteger(quotient), new SmallInteger(remainder)];
            }
            return [new BigInteger2(quotient, self2.sign !== n.sign), new SmallInteger(remainder)];
          }
          b = smallToArray(abs);
        }
        var comparison = compareAbs(a, b);
        if (comparison === -1) return [Integer[0], self2];
        if (comparison === 0) return [Integer[self2.sign === n.sign ? 1 : -1], Integer[0]];
        if (a.length + b.length <= 200)
          value = divMod1(a, b);
        else value = divMod2(a, b);
        quotient = value[0];
        var qSign = self2.sign !== n.sign, mod = value[1], mSign = self2.sign;
        if (typeof quotient === "number") {
          if (qSign) quotient = -quotient;
          quotient = new SmallInteger(quotient);
        } else quotient = new BigInteger2(quotient, qSign);
        if (typeof mod === "number") {
          if (mSign) mod = -mod;
          mod = new SmallInteger(mod);
        } else mod = new BigInteger2(mod, mSign);
        return [quotient, mod];
      }
      BigInteger2.prototype.divmod = function(v) {
        var result = divModAny(this, v);
        return {
          quotient: result[0],
          remainder: result[1]
        };
      };
      NativeBigInt.prototype.divmod = SmallInteger.prototype.divmod = BigInteger2.prototype.divmod;
      BigInteger2.prototype.divide = function(v) {
        return divModAny(this, v)[0];
      };
      NativeBigInt.prototype.over = NativeBigInt.prototype.divide = function(v) {
        return new NativeBigInt(this.value / parseValue(v).value);
      };
      SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger2.prototype.over = BigInteger2.prototype.divide;
      BigInteger2.prototype.mod = function(v) {
        return divModAny(this, v)[1];
      };
      NativeBigInt.prototype.mod = NativeBigInt.prototype.remainder = function(v) {
        return new NativeBigInt(this.value % parseValue(v).value);
      };
      SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger2.prototype.remainder = BigInteger2.prototype.mod;
      BigInteger2.prototype.pow = function(v) {
        var n = parseValue(v), a = this.value, b = n.value, value, x, y;
        if (b === 0) return Integer[1];
        if (a === 0) return Integer[0];
        if (a === 1) return Integer[1];
        if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];
        if (n.sign) {
          return Integer[0];
        }
        if (!n.isSmall) throw new Error("The exponent " + n.toString() + " is too large.");
        if (this.isSmall) {
          if (isPrecise(value = Math.pow(a, b)))
            return new SmallInteger(truncate(value));
        }
        x = this;
        y = Integer[1];
        while (true) {
          if (b & true) {
            y = y.times(x);
            --b;
          }
          if (b === 0) break;
          b /= 2;
          x = x.square();
        }
        return y;
      };
      SmallInteger.prototype.pow = BigInteger2.prototype.pow;
      NativeBigInt.prototype.pow = function(v) {
        var n = parseValue(v);
        var a = this.value, b = n.value;
        var _0 = BigInt(0), _1 = BigInt(1), _2 = BigInt(2);
        if (b === _0) return Integer[1];
        if (a === _0) return Integer[0];
        if (a === _1) return Integer[1];
        if (a === BigInt(-1)) return n.isEven() ? Integer[1] : Integer[-1];
        if (n.isNegative()) return new NativeBigInt(_0);
        var x = this;
        var y = Integer[1];
        while (true) {
          if ((b & _1) === _1) {
            y = y.times(x);
            --b;
          }
          if (b === _0) break;
          b /= _2;
          x = x.square();
        }
        return y;
      };
      BigInteger2.prototype.modPow = function(exp, mod) {
        exp = parseValue(exp);
        mod = parseValue(mod);
        if (mod.isZero()) throw new Error("Cannot take modPow with modulus 0");
        var r = Integer[1], base = this.mod(mod);
        if (exp.isNegative()) {
          exp = exp.multiply(Integer[-1]);
          base = base.modInv(mod);
        }
        while (exp.isPositive()) {
          if (base.isZero()) return Integer[0];
          if (exp.isOdd()) r = r.multiply(base).mod(mod);
          exp = exp.divide(2);
          base = base.square().mod(mod);
        }
        return r;
      };
      NativeBigInt.prototype.modPow = SmallInteger.prototype.modPow = BigInteger2.prototype.modPow;
      function compareAbs(a, b) {
        if (a.length !== b.length) {
          return a.length > b.length ? 1 : -1;
        }
        for (var i2 = a.length - 1; i2 >= 0; i2--) {
          if (a[i2] !== b[i2]) return a[i2] > b[i2] ? 1 : -1;
        }
        return 0;
      }
      BigInteger2.prototype.compareAbs = function(v) {
        var n = parseValue(v), a = this.value, b = n.value;
        if (n.isSmall) return 1;
        return compareAbs(a, b);
      };
      SmallInteger.prototype.compareAbs = function(v) {
        var n = parseValue(v), a = Math.abs(this.value), b = n.value;
        if (n.isSmall) {
          b = Math.abs(b);
          return a === b ? 0 : a > b ? 1 : -1;
        }
        return -1;
      };
      NativeBigInt.prototype.compareAbs = function(v) {
        var a = this.value;
        var b = parseValue(v).value;
        a = a >= 0 ? a : -a;
        b = b >= 0 ? b : -b;
        return a === b ? 0 : a > b ? 1 : -1;
      };
      BigInteger2.prototype.compare = function(v) {
        if (v === Infinity) {
          return -1;
        }
        if (v === -Infinity) {
          return 1;
        }
        var n = parseValue(v), a = this.value, b = n.value;
        if (this.sign !== n.sign) {
          return n.sign ? 1 : -1;
        }
        if (n.isSmall) {
          return this.sign ? -1 : 1;
        }
        return compareAbs(a, b) * (this.sign ? -1 : 1);
      };
      BigInteger2.prototype.compareTo = BigInteger2.prototype.compare;
      SmallInteger.prototype.compare = function(v) {
        if (v === Infinity) {
          return -1;
        }
        if (v === -Infinity) {
          return 1;
        }
        var n = parseValue(v), a = this.value, b = n.value;
        if (n.isSmall) {
          return a == b ? 0 : a > b ? 1 : -1;
        }
        if (a < 0 !== n.sign) {
          return a < 0 ? -1 : 1;
        }
        return a < 0 ? 1 : -1;
      };
      SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;
      NativeBigInt.prototype.compare = function(v) {
        if (v === Infinity) {
          return -1;
        }
        if (v === -Infinity) {
          return 1;
        }
        var a = this.value;
        var b = parseValue(v).value;
        return a === b ? 0 : a > b ? 1 : -1;
      };
      NativeBigInt.prototype.compareTo = NativeBigInt.prototype.compare;
      BigInteger2.prototype.equals = function(v) {
        return this.compare(v) === 0;
      };
      NativeBigInt.prototype.eq = NativeBigInt.prototype.equals = SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger2.prototype.eq = BigInteger2.prototype.equals;
      BigInteger2.prototype.notEquals = function(v) {
        return this.compare(v) !== 0;
      };
      NativeBigInt.prototype.neq = NativeBigInt.prototype.notEquals = SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger2.prototype.neq = BigInteger2.prototype.notEquals;
      BigInteger2.prototype.greater = function(v) {
        return this.compare(v) > 0;
      };
      NativeBigInt.prototype.gt = NativeBigInt.prototype.greater = SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger2.prototype.gt = BigInteger2.prototype.greater;
      BigInteger2.prototype.lesser = function(v) {
        return this.compare(v) < 0;
      };
      NativeBigInt.prototype.lt = NativeBigInt.prototype.lesser = SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger2.prototype.lt = BigInteger2.prototype.lesser;
      BigInteger2.prototype.greaterOrEquals = function(v) {
        return this.compare(v) >= 0;
      };
      NativeBigInt.prototype.geq = NativeBigInt.prototype.greaterOrEquals = SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger2.prototype.geq = BigInteger2.prototype.greaterOrEquals;
      BigInteger2.prototype.lesserOrEquals = function(v) {
        return this.compare(v) <= 0;
      };
      NativeBigInt.prototype.leq = NativeBigInt.prototype.lesserOrEquals = SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger2.prototype.leq = BigInteger2.prototype.lesserOrEquals;
      BigInteger2.prototype.isEven = function() {
        return (this.value[0] & 1) === 0;
      };
      SmallInteger.prototype.isEven = function() {
        return (this.value & 1) === 0;
      };
      NativeBigInt.prototype.isEven = function() {
        return (this.value & BigInt(1)) === BigInt(0);
      };
      BigInteger2.prototype.isOdd = function() {
        return (this.value[0] & 1) === 1;
      };
      SmallInteger.prototype.isOdd = function() {
        return (this.value & 1) === 1;
      };
      NativeBigInt.prototype.isOdd = function() {
        return (this.value & BigInt(1)) === BigInt(1);
      };
      BigInteger2.prototype.isPositive = function() {
        return !this.sign;
      };
      SmallInteger.prototype.isPositive = function() {
        return this.value > 0;
      };
      NativeBigInt.prototype.isPositive = SmallInteger.prototype.isPositive;
      BigInteger2.prototype.isNegative = function() {
        return this.sign;
      };
      SmallInteger.prototype.isNegative = function() {
        return this.value < 0;
      };
      NativeBigInt.prototype.isNegative = SmallInteger.prototype.isNegative;
      BigInteger2.prototype.isUnit = function() {
        return false;
      };
      SmallInteger.prototype.isUnit = function() {
        return Math.abs(this.value) === 1;
      };
      NativeBigInt.prototype.isUnit = function() {
        return this.abs().value === BigInt(1);
      };
      BigInteger2.prototype.isZero = function() {
        return false;
      };
      SmallInteger.prototype.isZero = function() {
        return this.value === 0;
      };
      NativeBigInt.prototype.isZero = function() {
        return this.value === BigInt(0);
      };
      BigInteger2.prototype.isDivisibleBy = function(v) {
        var n = parseValue(v);
        if (n.isZero()) return false;
        if (n.isUnit()) return true;
        if (n.compareAbs(2) === 0) return this.isEven();
        return this.mod(n).isZero();
      };
      NativeBigInt.prototype.isDivisibleBy = SmallInteger.prototype.isDivisibleBy = BigInteger2.prototype.isDivisibleBy;
      function isBasicPrime(v) {
        var n = v.abs();
        if (n.isUnit()) return false;
        if (n.equals(2) || n.equals(3) || n.equals(5)) return true;
        if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;
        if (n.lesser(49)) return true;
      }
      function millerRabinTest(n, a) {
        var nPrev = n.prev(), b = nPrev, r = 0, d, i2, x;
        while (b.isEven()) b = b.divide(2), r++;
        next: for (i2 = 0; i2 < a.length; i2++) {
          if (n.lesser(a[i2])) continue;
          x = bigInt(a[i2]).modPow(b, n);
          if (x.isUnit() || x.equals(nPrev)) continue;
          for (d = r - 1; d != 0; d--) {
            x = x.square().mod(n);
            if (x.isUnit()) return false;
            if (x.equals(nPrev)) continue next;
          }
          return false;
        }
        return true;
      }
      BigInteger2.prototype.isPrime = function(strict) {
        var isPrime = isBasicPrime(this);
        if (isPrime !== undefined$1) return isPrime;
        var n = this.abs();
        var bits = n.bitLength();
        if (bits <= 64)
          return millerRabinTest(n, [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37]);
        var logN = Math.log(2) * bits.toJSNumber();
        var t = Math.ceil(strict === true ? 2 * Math.pow(logN, 2) : logN);
        for (var a = [], i2 = 0; i2 < t; i2++) {
          a.push(bigInt(i2 + 2));
        }
        return millerRabinTest(n, a);
      };
      NativeBigInt.prototype.isPrime = SmallInteger.prototype.isPrime = BigInteger2.prototype.isPrime;
      BigInteger2.prototype.isProbablePrime = function(iterations, rng) {
        var isPrime = isBasicPrime(this);
        if (isPrime !== undefined$1) return isPrime;
        var n = this.abs();
        var t = iterations === undefined$1 ? 5 : iterations;
        for (var a = [], i2 = 0; i2 < t; i2++) {
          a.push(bigInt.randBetween(2, n.minus(2), rng));
        }
        return millerRabinTest(n, a);
      };
      NativeBigInt.prototype.isProbablePrime = SmallInteger.prototype.isProbablePrime = BigInteger2.prototype.isProbablePrime;
      BigInteger2.prototype.modInv = function(n) {
        var t = bigInt.zero, newT = bigInt.one, r = parseValue(n), newR = this.abs(), q, lastT, lastR;
        while (!newR.isZero()) {
          q = r.divide(newR);
          lastT = t;
          lastR = r;
          t = newT;
          r = newR;
          newT = lastT.subtract(q.multiply(newT));
          newR = lastR.subtract(q.multiply(newR));
        }
        if (!r.isUnit()) throw new Error(this.toString() + " and " + n.toString() + " are not co-prime");
        if (t.compare(0) === -1) {
          t = t.add(n);
        }
        if (this.isNegative()) {
          return t.negate();
        }
        return t;
      };
      NativeBigInt.prototype.modInv = SmallInteger.prototype.modInv = BigInteger2.prototype.modInv;
      BigInteger2.prototype.next = function() {
        var value = this.value;
        if (this.sign) {
          return subtractSmall(value, 1, this.sign);
        }
        return new BigInteger2(addSmall(value, 1), this.sign);
      };
      SmallInteger.prototype.next = function() {
        var value = this.value;
        if (value + 1 < MAX_INT) return new SmallInteger(value + 1);
        return new BigInteger2(MAX_INT_ARR, false);
      };
      NativeBigInt.prototype.next = function() {
        return new NativeBigInt(this.value + BigInt(1));
      };
      BigInteger2.prototype.prev = function() {
        var value = this.value;
        if (this.sign) {
          return new BigInteger2(addSmall(value, 1), true);
        }
        return subtractSmall(value, 1, this.sign);
      };
      SmallInteger.prototype.prev = function() {
        var value = this.value;
        if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);
        return new BigInteger2(MAX_INT_ARR, true);
      };
      NativeBigInt.prototype.prev = function() {
        return new NativeBigInt(this.value - BigInt(1));
      };
      var powersOfTwo = [1];
      while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);
      var powers2Length = powersOfTwo.length, highestPower2 = powersOfTwo[powers2Length - 1];
      function shift_isSmall(n) {
        return Math.abs(n) <= BASE;
      }
      BigInteger2.prototype.shiftLeft = function(v) {
        var n = parseValue(v).toJSNumber();
        if (!shift_isSmall(n)) {
          throw new Error(String(n) + " is too large for shifting.");
        }
        if (n < 0) return this.shiftRight(-n);
        var result = this;
        if (result.isZero()) return result;
        while (n >= powers2Length) {
          result = result.multiply(highestPower2);
          n -= powers2Length - 1;
        }
        return result.multiply(powersOfTwo[n]);
      };
      NativeBigInt.prototype.shiftLeft = SmallInteger.prototype.shiftLeft = BigInteger2.prototype.shiftLeft;
      BigInteger2.prototype.shiftRight = function(v) {
        var remQuo;
        var n = parseValue(v).toJSNumber();
        if (!shift_isSmall(n)) {
          throw new Error(String(n) + " is too large for shifting.");
        }
        if (n < 0) return this.shiftLeft(-n);
        var result = this;
        while (n >= powers2Length) {
          if (result.isZero() || result.isNegative() && result.isUnit()) return result;
          remQuo = divModAny(result, highestPower2);
          result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];
          n -= powers2Length - 1;
        }
        remQuo = divModAny(result, powersOfTwo[n]);
        return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];
      };
      NativeBigInt.prototype.shiftRight = SmallInteger.prototype.shiftRight = BigInteger2.prototype.shiftRight;
      function bitwise(x, y, fn) {
        y = parseValue(y);
        var xSign = x.isNegative(), ySign = y.isNegative();
        var xRem = xSign ? x.not() : x, yRem = ySign ? y.not() : y;
        var xDigit = 0, yDigit = 0;
        var xDivMod = null, yDivMod = null;
        var result = [];
        while (!xRem.isZero() || !yRem.isZero()) {
          xDivMod = divModAny(xRem, highestPower2);
          xDigit = xDivMod[1].toJSNumber();
          if (xSign) {
            xDigit = highestPower2 - 1 - xDigit;
          }
          yDivMod = divModAny(yRem, highestPower2);
          yDigit = yDivMod[1].toJSNumber();
          if (ySign) {
            yDigit = highestPower2 - 1 - yDigit;
          }
          xRem = xDivMod[0];
          yRem = yDivMod[0];
          result.push(fn(xDigit, yDigit));
        }
        var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);
        for (var i2 = result.length - 1; i2 >= 0; i2 -= 1) {
          sum = sum.multiply(highestPower2).add(bigInt(result[i2]));
        }
        return sum;
      }
      BigInteger2.prototype.not = function() {
        return this.negate().prev();
      };
      NativeBigInt.prototype.not = SmallInteger.prototype.not = BigInteger2.prototype.not;
      BigInteger2.prototype.and = function(n) {
        return bitwise(this, n, function(a, b) {
          return a & b;
        });
      };
      NativeBigInt.prototype.and = SmallInteger.prototype.and = BigInteger2.prototype.and;
      BigInteger2.prototype.or = function(n) {
        return bitwise(this, n, function(a, b) {
          return a | b;
        });
      };
      NativeBigInt.prototype.or = SmallInteger.prototype.or = BigInteger2.prototype.or;
      BigInteger2.prototype.xor = function(n) {
        return bitwise(this, n, function(a, b) {
          return a ^ b;
        });
      };
      NativeBigInt.prototype.xor = SmallInteger.prototype.xor = BigInteger2.prototype.xor;
      var LOBMASK_I = 1 << 30, LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;
      function roughLOB(n) {
        var v = n.value, x = typeof v === "number" ? v | LOBMASK_I : typeof v === "bigint" ? v | BigInt(LOBMASK_I) : v[0] + v[1] * BASE | LOBMASK_BI;
        return x & -x;
      }
      function integerLogarithm(value, base) {
        if (base.compareTo(value) <= 0) {
          var tmp = integerLogarithm(value, base.square(base));
          var p = tmp.p;
          var e = tmp.e;
          var t = p.multiply(base);
          return t.compareTo(value) <= 0 ? { p: t, e: e * 2 + 1 } : { p, e: e * 2 };
        }
        return { p: bigInt(1), e: 0 };
      }
      BigInteger2.prototype.bitLength = function() {
        var n = this;
        if (n.compareTo(bigInt(0)) < 0) {
          n = n.negate().subtract(bigInt(1));
        }
        if (n.compareTo(bigInt(0)) === 0) {
          return bigInt(0);
        }
        return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));
      };
      NativeBigInt.prototype.bitLength = SmallInteger.prototype.bitLength = BigInteger2.prototype.bitLength;
      function max(a, b) {
        a = parseValue(a);
        b = parseValue(b);
        return a.greater(b) ? a : b;
      }
      function min(a, b) {
        a = parseValue(a);
        b = parseValue(b);
        return a.lesser(b) ? a : b;
      }
      function gcd(a, b) {
        a = parseValue(a).abs();
        b = parseValue(b).abs();
        if (a.equals(b)) return a;
        if (a.isZero()) return b;
        if (b.isZero()) return a;
        var c = Integer[1], d, t;
        while (a.isEven() && b.isEven()) {
          d = min(roughLOB(a), roughLOB(b));
          a = a.divide(d);
          b = b.divide(d);
          c = c.multiply(d);
        }
        while (a.isEven()) {
          a = a.divide(roughLOB(a));
        }
        do {
          while (b.isEven()) {
            b = b.divide(roughLOB(b));
          }
          if (a.greater(b)) {
            t = b;
            b = a;
            a = t;
          }
          b = b.subtract(a);
        } while (!b.isZero());
        return c.isUnit() ? a : a.multiply(c);
      }
      function lcm(a, b) {
        a = parseValue(a).abs();
        b = parseValue(b).abs();
        return a.divide(gcd(a, b)).multiply(b);
      }
      function randBetween(a, b, rng) {
        a = parseValue(a);
        b = parseValue(b);
        var usedRNG = rng || Math.random;
        var low = min(a, b), high = max(a, b);
        var range = high.subtract(low).add(1);
        if (range.isSmall) return low.add(Math.floor(usedRNG() * range));
        var digits = toBase(range, BASE).value;
        var result = [], restricted = true;
        for (var i2 = 0; i2 < digits.length; i2++) {
          var top = restricted ? digits[i2] + (i2 + 1 < digits.length ? digits[i2 + 1] / BASE : 0) : BASE;
          var digit = truncate(usedRNG() * top);
          result.push(digit);
          if (digit < digits[i2]) restricted = false;
        }
        return low.add(Integer.fromArray(result, BASE, false));
      }
      var parseBase = function(text2, base, alphabet, caseSensitive) {
        alphabet = alphabet || DEFAULT_ALPHABET;
        text2 = String(text2);
        if (!caseSensitive) {
          text2 = text2.toLowerCase();
          alphabet = alphabet.toLowerCase();
        }
        var length = text2.length;
        var i2;
        var absBase = Math.abs(base);
        var alphabetValues = {};
        for (i2 = 0; i2 < alphabet.length; i2++) {
          alphabetValues[alphabet[i2]] = i2;
        }
        for (i2 = 0; i2 < length; i2++) {
          var c = text2[i2];
          if (c === "-") continue;
          if (c in alphabetValues) {
            if (alphabetValues[c] >= absBase) {
              if (c === "1" && absBase === 1) continue;
              throw new Error(c + " is not a valid digit in base " + base + ".");
            }
          }
        }
        base = parseValue(base);
        var digits = [];
        var isNegative = text2[0] === "-";
        for (i2 = isNegative ? 1 : 0; i2 < text2.length; i2++) {
          var c = text2[i2];
          if (c in alphabetValues) digits.push(parseValue(alphabetValues[c]));
          else if (c === "<") {
            var start = i2;
            do {
              i2++;
            } while (text2[i2] !== ">" && i2 < text2.length);
            digits.push(parseValue(text2.slice(start + 1, i2)));
          } else throw new Error(c + " is not a valid character");
        }
        return parseBaseFromArray(digits, base, isNegative);
      };
      function parseBaseFromArray(digits, base, isNegative) {
        var val = Integer[0], pow = Integer[1], i2;
        for (i2 = digits.length - 1; i2 >= 0; i2--) {
          val = val.add(digits[i2].times(pow));
          pow = pow.times(base);
        }
        return isNegative ? val.negate() : val;
      }
      function stringify2(digit, alphabet) {
        alphabet = alphabet || DEFAULT_ALPHABET;
        if (digit < alphabet.length) {
          return alphabet[digit];
        }
        return "<" + digit + ">";
      }
      function toBase(n, base) {
        base = bigInt(base);
        if (base.isZero()) {
          if (n.isZero()) return { value: [0], isNegative: false };
          throw new Error("Cannot convert nonzero numbers to base 0.");
        }
        if (base.equals(-1)) {
          if (n.isZero()) return { value: [0], isNegative: false };
          if (n.isNegative())
            return {
              value: [].concat.apply(
                [],
                Array.apply(null, Array(-n.toJSNumber())).map(Array.prototype.valueOf, [1, 0])
              ),
              isNegative: false
            };
          var arr = Array.apply(null, Array(n.toJSNumber() - 1)).map(Array.prototype.valueOf, [0, 1]);
          arr.unshift([1]);
          return {
            value: [].concat.apply([], arr),
            isNegative: false
          };
        }
        var neg = false;
        if (n.isNegative() && base.isPositive()) {
          neg = true;
          n = n.abs();
        }
        if (base.isUnit()) {
          if (n.isZero()) return { value: [0], isNegative: false };
          return {
            value: Array.apply(null, Array(n.toJSNumber())).map(Number.prototype.valueOf, 1),
            isNegative: neg
          };
        }
        var out = [];
        var left = n, divmod;
        while (left.isNegative() || left.compareAbs(base) >= 0) {
          divmod = left.divmod(base);
          left = divmod.quotient;
          var digit = divmod.remainder;
          if (digit.isNegative()) {
            digit = base.minus(digit).abs();
            left = left.next();
          }
          out.push(digit.toJSNumber());
        }
        out.push(left.toJSNumber());
        return { value: out.reverse(), isNegative: neg };
      }
      function toBaseString(n, base, alphabet) {
        var arr = toBase(n, base);
        return (arr.isNegative ? "-" : "") + arr.value.map(function(x) {
          return stringify2(x, alphabet);
        }).join("");
      }
      BigInteger2.prototype.toArray = function(radix) {
        return toBase(this, radix);
      };
      SmallInteger.prototype.toArray = function(radix) {
        return toBase(this, radix);
      };
      NativeBigInt.prototype.toArray = function(radix) {
        return toBase(this, radix);
      };
      BigInteger2.prototype.toString = function(radix, alphabet) {
        if (radix === undefined$1) radix = 10;
        if (radix !== 10 || alphabet) return toBaseString(this, radix, alphabet);
        var v = this.value, l = v.length, str = String(v[--l]), zeros = "0000000", digit;
        while (--l >= 0) {
          digit = String(v[l]);
          str += zeros.slice(digit.length) + digit;
        }
        var sign = this.sign ? "-" : "";
        return sign + str;
      };
      SmallInteger.prototype.toString = function(radix, alphabet) {
        if (radix === undefined$1) radix = 10;
        if (radix != 10 || alphabet) return toBaseString(this, radix, alphabet);
        return String(this.value);
      };
      NativeBigInt.prototype.toString = SmallInteger.prototype.toString;
      NativeBigInt.prototype.toJSON = BigInteger2.prototype.toJSON = SmallInteger.prototype.toJSON = function() {
        return this.toString();
      };
      BigInteger2.prototype.valueOf = function() {
        return parseInt(this.toString(), 10);
      };
      BigInteger2.prototype.toJSNumber = BigInteger2.prototype.valueOf;
      SmallInteger.prototype.valueOf = function() {
        return this.value;
      };
      SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;
      NativeBigInt.prototype.valueOf = NativeBigInt.prototype.toJSNumber = function() {
        return parseInt(this.toString(), 10);
      };
      function parseStringValue(v) {
        if (isPrecise(+v)) {
          var x = +v;
          if (x === truncate(x))
            return supportsNativeBigInt ? new NativeBigInt(BigInt(x)) : new SmallInteger(x);
          throw new Error("Invalid integer: " + v);
        }
        var sign = v[0] === "-";
        if (sign) v = v.slice(1);
        var split = v.split(/e/i);
        if (split.length > 2) throw new Error("Invalid integer: " + split.join("e"));
        if (split.length === 2) {
          var exp = split[1];
          if (exp[0] === "+") exp = exp.slice(1);
          exp = +exp;
          if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error("Invalid integer: " + exp + " is not a valid exponent.");
          var text2 = split[0];
          var decimalPlace = text2.indexOf(".");
          if (decimalPlace >= 0) {
            exp -= text2.length - decimalPlace - 1;
            text2 = text2.slice(0, decimalPlace) + text2.slice(decimalPlace + 1);
          }
          if (exp < 0) throw new Error("Cannot include negative exponent part for integers");
          text2 += new Array(exp + 1).join("0");
          v = text2;
        }
        var isValid = /^([0-9][0-9]*)$/.test(v);
        if (!isValid) throw new Error("Invalid integer: " + v);
        if (supportsNativeBigInt) {
          return new NativeBigInt(BigInt(sign ? "-" + v : v));
        }
        var r = [], max2 = v.length, l = LOG_BASE, min2 = max2 - l;
        while (max2 > 0) {
          r.push(+v.slice(min2, max2));
          min2 -= l;
          if (min2 < 0) min2 = 0;
          max2 -= l;
        }
        trim(r);
        return new BigInteger2(r, sign);
      }
      function parseNumberValue(v) {
        if (supportsNativeBigInt) {
          return new NativeBigInt(BigInt(v));
        }
        if (isPrecise(v)) {
          if (v !== truncate(v)) throw new Error(v + " is not an integer.");
          return new SmallInteger(v);
        }
        return parseStringValue(v.toString());
      }
      function parseValue(v) {
        if (typeof v === "number") {
          return parseNumberValue(v);
        }
        if (typeof v === "string") {
          return parseStringValue(v);
        }
        if (typeof v === "bigint") {
          return new NativeBigInt(v);
        }
        return v;
      }
      for (var i = 0; i < 1e3; i++) {
        Integer[i] = parseValue(i);
        if (i > 0) Integer[-i] = parseValue(-i);
      }
      Integer.one = Integer[1];
      Integer.zero = Integer[0];
      Integer.minusOne = Integer[-1];
      Integer.max = max;
      Integer.min = min;
      Integer.gcd = gcd;
      Integer.lcm = lcm;
      Integer.isInstance = function(x) {
        return x instanceof BigInteger2 || x instanceof SmallInteger || x instanceof NativeBigInt;
      };
      Integer.randBetween = randBetween;
      Integer.fromArray = function(digits, base, isNegative) {
        return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);
      };
      return Integer;
    }();
    if (module2.hasOwnProperty("exports")) {
      module2.exports = bigInt;
    }
  })(BigInteger$1);
  var BigIntegerExports = BigInteger$1.exports;
  const BigInteger = /* @__PURE__ */ getDefaultExportFromCjs(BigIntegerExports);
  var murmurhashJs = { exports: {} };
  var murmurhash3_gc = { exports: {} };
  (function(module2) {
    function murmurhash3_32_gc(key2, seed) {
      var remainder, bytes, h1, h1b, c1, c2, k1, i;
      remainder = key2.length & 3;
      bytes = key2.length - remainder;
      h1 = seed;
      c1 = 3432918353;
      c2 = 461845907;
      i = 0;
      while (i < bytes) {
        k1 = key2.charCodeAt(i) & 255 | (key2.charCodeAt(++i) & 255) << 8 | (key2.charCodeAt(++i) & 255) << 16 | (key2.charCodeAt(++i) & 255) << 24;
        ++i;
        k1 = (k1 & 65535) * c1 + (((k1 >>> 16) * c1 & 65535) << 16) & 4294967295;
        k1 = k1 << 15 | k1 >>> 17;
        k1 = (k1 & 65535) * c2 + (((k1 >>> 16) * c2 & 65535) << 16) & 4294967295;
        h1 ^= k1;
        h1 = h1 << 13 | h1 >>> 19;
        h1b = (h1 & 65535) * 5 + (((h1 >>> 16) * 5 & 65535) << 16) & 4294967295;
        h1 = (h1b & 65535) + 27492 + (((h1b >>> 16) + 58964 & 65535) << 16);
      }
      k1 = 0;
      switch (remainder) {
        case 3:
          k1 ^= (key2.charCodeAt(i + 2) & 255) << 16;
        case 2:
          k1 ^= (key2.charCodeAt(i + 1) & 255) << 8;
        case 1:
          k1 ^= key2.charCodeAt(i) & 255;
          k1 = (k1 & 65535) * c1 + (((k1 >>> 16) * c1 & 65535) << 16) & 4294967295;
          k1 = k1 << 15 | k1 >>> 17;
          k1 = (k1 & 65535) * c2 + (((k1 >>> 16) * c2 & 65535) << 16) & 4294967295;
          h1 ^= k1;
      }
      h1 ^= key2.length;
      h1 ^= h1 >>> 16;
      h1 = (h1 & 65535) * 2246822507 + (((h1 >>> 16) * 2246822507 & 65535) << 16) & 4294967295;
      h1 ^= h1 >>> 13;
      h1 = (h1 & 65535) * 3266489909 + (((h1 >>> 16) * 3266489909 & 65535) << 16) & 4294967295;
      h1 ^= h1 >>> 16;
      return h1 >>> 0;
    }
    {
      module2.exports = murmurhash3_32_gc;
    }
  })(murmurhash3_gc);
  var murmurhash3_gcExports = murmurhash3_gc.exports;
  var murmurhash2_gc = { exports: {} };
  (function(module2) {
    function murmurhash2_32_gc(str, seed) {
      var l = str.length, h = seed ^ l, i = 0, k;
      while (l >= 4) {
        k = str.charCodeAt(i) & 255 | (str.charCodeAt(++i) & 255) << 8 | (str.charCodeAt(++i) & 255) << 16 | (str.charCodeAt(++i) & 255) << 24;
        k = (k & 65535) * 1540483477 + (((k >>> 16) * 1540483477 & 65535) << 16);
        k ^= k >>> 24;
        k = (k & 65535) * 1540483477 + (((k >>> 16) * 1540483477 & 65535) << 16);
        h = (h & 65535) * 1540483477 + (((h >>> 16) * 1540483477 & 65535) << 16) ^ k;
        l -= 4;
        ++i;
      }
      switch (l) {
        case 3:
          h ^= (str.charCodeAt(i + 2) & 255) << 16;
        case 2:
          h ^= (str.charCodeAt(i + 1) & 255) << 8;
        case 1:
          h ^= str.charCodeAt(i) & 255;
          h = (h & 65535) * 1540483477 + (((h >>> 16) * 1540483477 & 65535) << 16);
      }
      h ^= h >>> 13;
      h = (h & 65535) * 1540483477 + (((h >>> 16) * 1540483477 & 65535) << 16);
      h ^= h >>> 15;
      return h >>> 0;
    }
    {
      module2.exports = murmurhash2_32_gc;
    }
  })(murmurhash2_gc);
  var murmurhash2_gcExports = murmurhash2_gc.exports;
  var murmur3 = murmurhash3_gcExports;
  var murmur2 = murmurhash2_gcExports;
  murmurhashJs.exports = murmur3;
  var murmur3_1 = murmurhashJs.exports.murmur3 = murmur3;
  murmurhashJs.exports.murmur2 = murmur2;
  var PART_NUM = 1e3;
  function MD5(str) {
    var hex = md5(str);
    var bigint = BigInteger(hex, 16);
    return bigint.abs().mod(PART_NUM);
  }
  function murmurhash3(str, seed) {
    var hash = murmur3_1(str, seed);
    return BigInteger(hash).abs().mod(PART_NUM);
  }
  function hashCode(str) {
    str = "" + str;
    var hash = 0, i;
    for (i = 0; i < str.length; i++) {
      hash = (hash << 5) - hash + str.charCodeAt(i) & 4294967295;
    }
    return BigInteger(hash).abs().mod(PART_NUM);
  }
  const Hasher = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
    __proto__: null,
    MD5,
    hashCode,
    murmurhash3
  }, Symbol.toStringTag, { value: "Module" }));
  const CONFIG = {
    cdnPath: "https://s.alicdn.com/@xconfig/dataphant",
    //rap2 mock
    algorithm: "MD5",
    //: MD5/murmurhash3/hashCode;  /controller/Hasher.ts
    controlGroupName: ""
    // 
  };
  function _extends$3() {
    _extends$3 = Object.assign ? Object.assign.bind() : function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key2 in source) {
          if (Object.prototype.hasOwnProperty.call(source, key2)) {
            target[key2] = source[key2];
          }
        }
      }
      return target;
    };
    return _extends$3.apply(this, arguments);
  }
  function getSegment(expConfig, userInfo) {
    var segments = expConfig.segments;
    var DiversionCondition = userInfo.DiversionCondition, diversionKey = userInfo.diversionKey;
    var filters = _extends$3({}, DiversionCondition, {
      whitelist: diversionKey
    });
    return segments.find(function(seg) {
      return seg.filterConditions.every(function(v) {
        var fieldName = v.fieldName, type = v.type, fieldValues = v.fieldValues;
        if (!filters.hasOwnProperty(fieldName)) return false;
        var current = filters[fieldName];
        switch (type) {
          case "$in":
            return fieldValues.includes(current);
          case "$re":
            return new RegExp("^" + fieldValues[0]).test(current);
          case "$eq":
            return current === fieldValues[0];
          case "$gt":
            return versionCompare(current, fieldValues[0]) > 0;
          case "$gte":
            return versionCompare(current, fieldValues[0]) >= 0;
          case "$lt":
            return versionCompare(current, fieldValues[0]) < 0;
          case "$lte":
            return versionCompare(current, fieldValues[0]) <= 0;
          case "$nin":
            return !fieldValues.includes(current);
          case "$neq":
            return current !== fieldValues[0];
        }
        return false;
      });
    });
  }
  function getRemainder(expConfig, userInfo) {
    var hashId = expConfig.hashId;
    var diversionKey = userInfo.diversionKey;
    var hashKey = getHashKey(diversionKey, hashId);
    return Hasher[CONFIG.algorithm](hashKey);
  }
  function getGatingKeyRemainder(gatingKey, userInfo) {
    var hashId = gatingKey.hashId, id = gatingKey.id;
    var diversionKey = userInfo.diversionKey;
    var hashKey = getHashKey(diversionKey, hashId || id);
    return Hasher[CONFIG.algorithm](hashKey);
  }
  function getBucket(groups, remainder) {
    return groups.find(function(item) {
      var ratioRanges = item.ratioRanges, ratioRangesWithVersion = item.ratioRangesWithVersion;
      if (ratioRangesWithVersion) {
        return ratioRangesWithVersion.some(function(v) {
          return remainder >= v.low && remainder <= v.high;
        });
      }
      return ratioRanges.some(function(v) {
        var min = Math.min.apply(null, v);
        var max = Math.max.apply(null, v);
        return remainder >= min && remainder <= max;
      });
    });
  }
  function getRange(ranges, remainder) {
    return ranges.find(function(item) {
      return remainder >= item.low && remainder <= item.high;
    });
  }
  function getHashKey(key2, salt) {
    return key2 + "_" + salt;
  }
  function _extends$2() {
    _extends$2 = Object.assign ? Object.assign.bind() : function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key2 in source) {
          if (Object.prototype.hasOwnProperty.call(source, key2)) {
            target[key2] = source[key2];
          }
        }
      }
      return target;
    };
    return _extends$2.apply(this, arguments);
  }
  var bucketInfoDefault = {
    segmentID: null,
    remainder: null,
    treatment: CONFIG.controlGroupName,
    // control,
    treatmentID: null,
    variantId: null,
    params: {},
    message: ""
  };
  function Allocate(appExpConfig, userInfo, testKey) {
    var experiments = appExpConfig.experiments, _appExpConfig$traffic = appExpConfig.trafficSourceExperiments, trafficSourceExperiments = _appExpConfig$traffic === void 0 ? [] : _appExpConfig$traffic, whiteList = appExpConfig.whiteList, launchConfig = appExpConfig.launchConfig;
    var expConfig = experiments.find(function(v) {
      return v.testKey === testKey;
    });
    if (!expConfig) {
      return getNoExperimentDiverResult(testKey, launchConfig);
    }
    return AllocateUnit({
      expConfig,
      trafficSourceExperiments,
      whiteList,
      launchConfig,
      userInfo
    });
  }
  function getNoExperimentDiverResult(testKey, launchConfig) {
    var _launchExperiment$lau;
    var result = _extends$2({}, bucketInfoDefault);
    var _launchConfig$launchE = launchConfig.launchExperiments, launchExperiments = _launchConfig$launchE === void 0 ? {} : _launchConfig$launchE, _launchConfig$launchP = launchConfig.launchParams, launchParams = _launchConfig$launchP === void 0 ? [] : _launchConfig$launchP;
    var launchExperiment = launchExperiments[testKey];
    if (!launchExperiment) {
      result.message = "Experiment: " + this.testKey + " not found. Please confirm the experiment is launched.";
      return result;
    }
    result.treatment = (_launchExperiment$lau = launchExperiment.launchGroupName) != null ? _launchExperiment$lau : "";
    var launchParam = launchParams.find(function(v) {
      return v.gatingKeyId === launchExperiment.gatingKeyId;
    });
    if (launchParam) {
      result.params = launchParam.params || {};
    }
    result.message = "experiment: " + testKey + " has been full pushed";
    return result;
  }
  function getExpConfigURL(_ref) {
    var appName = _ref.appName;
    return appName ? CONFIG.cdnPath + "/" + appName : "";
  }
  function getWhiteListURL(_ref2) {
    var appName = _ref2.appName;
    return appName ? CONFIG.cdnPath + "/whitelist/" + appName : "";
  }
  function getLaunchConfigURL(_ref3) {
    var appName = _ref3.appName;
    return appName ? CONFIG.cdnPath + "/launch/" + appName : "";
  }
  function AllocateUnit(_ref4) {
    var expConfig = _ref4.expConfig, trafficSourceExperiments = _ref4.trafficSourceExperiments, whiteList = _ref4.whiteList, launchConfig = _ref4.launchConfig, userInfo = _ref4.userInfo, _ref4$loopCount = _ref4.loopCount, loopCount = _ref4$loopCount === void 0 ? 0 : _ref4$loopCount;
    var result = _extends$2({}, bucketInfoDefault);
    if (loopCount > 10) {
      result.message = "experiment config invalid, there is a loop call";
      return result;
    }
    var diversionKey = userInfo.diversionKey;
    var gatingKey = expConfig.gatingKey, _expConfig$variants = expConfig.variants, variants = _expConfig$variants === void 0 ? [] : _expConfig$variants;
    if (whiteList) {
      var _whiteList$gatingKeyW = whiteList.gatingKeyWhitelist, gatingKeyWhitelist = _whiteList$gatingKeyW === void 0 ? {} : _whiteList$gatingKeyW;
      var _ref5 = gatingKeyWhitelist[gatingKey.id] || {}, members = _ref5.members;
      if (members) {
        var variantId = members[diversionKey];
        if (variantId) {
          var variant = variants.find(function(v) {
            return v.id === variantId;
          });
          if (variant && variant.name) {
            result.treatment = variant.name;
            result.variantId = variant.id;
            result.params = variant.params || {};
            result.message = "current user hit whiteList config";
            return result;
          } else {
            result.message = "hit exclusive experiment whitelist";
            return result;
          }
        }
      }
    }
    var trafficSourceExpTestKey = gatingKey.trafficSourceExpTestKey, trafficSourceVariantId = gatingKey.trafficSourceVariantId;
    if (trafficSourceExpTestKey) {
      var parentExpConfig = trafficSourceExperiments.find(function(v) {
        return v.testKey === trafficSourceExpTestKey;
      });
      if (!parentExpConfig) {
        result.message = "can not found parent experiment:" + trafficSourceExpTestKey + " config";
        return result;
      }
      var _AllocateUnit = AllocateUnit({
        expConfig: parentExpConfig,
        trafficSourceExperiments,
        userInfo,
        whiteList,
        launchConfig,
        loopCount: loopCount++
      }), _variantId = _AllocateUnit.variantId, segmentID = _AllocateUnit.segmentID;
      if (trafficSourceVariantId !== _variantId) {
        if (!segmentID) {
          result.message = "can not hit parent experiment:" + trafficSourceExpTestKey + " segment";
          return result;
        }
        result.message = "can not hit parent experiment:" + trafficSourceExpTestKey + " variant";
        return result;
      }
    }
    if (gatingKey) {
      var gatingKeyRemainder = getGatingKeyRemainder(gatingKey, userInfo);
      var ratioRanges = gatingKey.ratioRanges;
      var inRanges = ratioRanges.some(function(v) {
        var min = Math.min.apply(null, v);
        var max = Math.max.apply(null, v);
        return gatingKeyRemainder >= min && gatingKeyRemainder <= max;
      });
      if (!inRanges) {
        result.message = "can not hit experiment gatingKey";
        return result;
      }
    }
    var segment = getSegment(expConfig, userInfo);
    if (segment) {
      var id = segment.id, groups = segment.groups;
      result.segmentID = id;
      var remainder = parseInt(getRemainder(expConfig, userInfo));
      result.remainder = remainder;
      var group = getBucket(groups, remainder);
      if (group && group.name) {
        result.treatment = group.name;
        result.treatmentID = group.id;
        var ranges = group.ratioRangesWithVersion;
        if (ranges) {
          result.rangeInfo = getRange(ranges, remainder);
        }
        var _variant = variants.find(function(v) {
          return v.name === group.name;
        });
        if (_variant) {
          result.variantId = _variant.id;
          result.params = _variant.params || {};
        }
        result.message = "experiment group allocate succeed";
        return result;
      }
      result.message = "can not hit experiment group";
      return result;
    }
    result.message = "can not hit experiment segment";
    return result;
  }
  function stringify(json) {
    if (json === void 0) {
      json = {};
    }
    return Object.keys(json).map(function(key2) {
      return key2 + "=" + json[key2];
    }).join("&");
  }
  function parse$1(str, decode2) {
    if (str === void 0) {
      str = "";
    }
    if (decode2 === void 0) {
      decode2 = false;
    }
    var params = {};
    str.replace(/([^?&]+)=([^?&]+)/g, function(s, k, v) {
      if (decode2) {
        params[decodeURIComponent(k)] = decodeURIComponent(v);
      } else {
        params[k] = v;
      }
      return v + "=" + k;
    });
    return params;
  }
  var EXP_CACHE = {
    expire: 3e5,
    // 5
    storagePrefix: "dp_abtest_config_"
    // 
  };
  var EXP_LOG = {
    key: "/sc.dataphant.abtest.track",
    //
    action: {
      sdkInvoked: "exp_invoked",
      resultSucceed: "exp_treatment",
      resultFailed: "exp_failed"
    }
  };
  var EXP_RESULT = {
    globalKey: "__DP_ABTEST__",
    // windowkey
    aplusKey: "dp_abtest_params"
    // apluskey
  };
  function goldlog$1(action, params) {
    if (action === void 0) {
      action = "";
    }
    if (params === void 0) {
      params = null;
    }
    if (action) {
      var _goldlog$record, _window, _window$goldlog;
      if (params) {
        action += "&" + stringify(params);
      }
      var ext = "ext=" + encodeURIComponent(action);
      var record = (_goldlog$record = (_window = window) == null ? void 0 : (_window$goldlog = _window.goldlog) == null ? void 0 : _window$goldlog.record) != null ? _goldlog$record : null;
      if (record) {
        record(EXP_LOG.key, "EXP", ext, "GET");
      } else {
        var queue = window["goldlog_queue"] || (window["goldlog_queue"] = []);
        queue.push({
          action: "goldlog.record",
          arguments: [EXP_LOG.key, "CLK", ext, "GET"]
        });
      }
    }
  }
  const utils = {
    /**
     * debug
     */
    isDebug: function isDebug() {
      var _window$location$sear, _window, _window$location;
      return !!parse$1((_window$location$sear = (_window = window) == null ? void 0 : (_window$location = _window.location) == null ? void 0 : _window$location.search) != null ? _window$location$sear : "", true).debug;
    }
  };
  const Storage = {
    getItem: function getItem(key2) {
      return localStorage.getItem(key2);
    },
    setItem: function setItem(key2, val) {
      return localStorage.setItem(key2, val);
    }
  };
  var g = typeof globalThis !== "undefined" && globalThis || typeof self !== "undefined" && self || // eslint-disable-next-line no-undef
  typeof global !== "undefined" && global || {};
  var support = {
    searchParams: "URLSearchParams" in g,
    iterable: "Symbol" in g && "iterator" in Symbol,
    blob: "FileReader" in g && "Blob" in g && function() {
      try {
        new Blob();
        return true;
      } catch (e) {
        return false;
      }
    }(),
    formData: "FormData" in g,
    arrayBuffer: "ArrayBuffer" in g
  };
  function isDataView(obj) {
    return obj && DataView.prototype.isPrototypeOf(obj);
  }
  if (support.arrayBuffer) {
    var viewClasses = [
      "[object Int8Array]",
      "[object Uint8Array]",
      "[object Uint8ClampedArray]",
      "[object Int16Array]",
      "[object Uint16Array]",
      "[object Int32Array]",
      "[object Uint32Array]",
      "[object Float32Array]",
      "[object Float64Array]"
    ];
    var isArrayBufferView = ArrayBuffer.isView || function(obj) {
      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;
    };
  }
  function normalizeName(name) {
    if (typeof name !== "string") {
      name = String(name);
    }
    if (/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(name) || name === "") {
      throw new TypeError('Invalid character in header field name: "' + name + '"');
    }
    return name.toLowerCase();
  }
  function normalizeValue(value) {
    if (typeof value !== "string") {
      value = String(value);
    }
    return value;
  }
  function iteratorFor(items) {
    var iterator = {
      next: function() {
        var value = items.shift();
        return { done: value === void 0, value };
      }
    };
    if (support.iterable) {
      iterator[Symbol.iterator] = function() {
        return iterator;
      };
    }
    return iterator;
  }
  function Headers(headers) {
    this.map = {};
    if (headers instanceof Headers) {
      headers.forEach(function(value, name) {
        this.append(name, value);
      }, this);
    } else if (Array.isArray(headers)) {
      headers.forEach(function(header) {
        if (header.length != 2) {
          throw new TypeError("Headers constructor: expected name/value pair to be length 2, found" + header.length);
        }
        this.append(header[0], header[1]);
      }, this);
    } else if (headers) {
      Object.getOwnPropertyNames(headers).forEach(function(name) {
        this.append(name, headers[name]);
      }, this);
    }
  }
  Headers.prototype.append = function(name, value) {
    name = normalizeName(name);
    value = normalizeValue(value);
    var oldValue = this.map[name];
    this.map[name] = oldValue ? oldValue + ", " + value : value;
  };
  Headers.prototype["delete"] = function(name) {
    delete this.map[normalizeName(name)];
  };
  Headers.prototype.get = function(name) {
    name = normalizeName(name);
    return this.has(name) ? this.map[name] : null;
  };
  Headers.prototype.has = function(name) {
    return this.map.hasOwnProperty(normalizeName(name));
  };
  Headers.prototype.set = function(name, value) {
    this.map[normalizeName(name)] = normalizeValue(value);
  };
  Headers.prototype.forEach = function(callback, thisArg) {
    for (var name in this.map) {
      if (this.map.hasOwnProperty(name)) {
        callback.call(thisArg, this.map[name], name, this);
      }
    }
  };
  Headers.prototype.keys = function() {
    var items = [];
    this.forEach(function(value, name) {
      items.push(name);
    });
    return iteratorFor(items);
  };
  Headers.prototype.values = function() {
    var items = [];
    this.forEach(function(value) {
      items.push(value);
    });
    return iteratorFor(items);
  };
  Headers.prototype.entries = function() {
    var items = [];
    this.forEach(function(value, name) {
      items.push([name, value]);
    });
    return iteratorFor(items);
  };
  if (support.iterable) {
    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;
  }
  function consumed(body) {
    if (body._noBody) return;
    if (body.bodyUsed) {
      return Promise.reject(new TypeError("Already read"));
    }
    body.bodyUsed = true;
  }
  function fileReaderReady(reader) {
    return new Promise(function(resolve, reject) {
      reader.onload = function() {
        resolve(reader.result);
      };
      reader.onerror = function() {
        reject(reader.error);
      };
    });
  }
  function readBlobAsArrayBuffer(blob) {
    var reader = new FileReader();
    var promise = fileReaderReady(reader);
    reader.readAsArrayBuffer(blob);
    return promise;
  }
  function readBlobAsText(blob) {
    var reader = new FileReader();
    var promise = fileReaderReady(reader);
    var match = /charset=([A-Za-z0-9_-]+)/.exec(blob.type);
    var encoding = match ? match[1] : "utf-8";
    reader.readAsText(blob, encoding);
    return promise;
  }
  function readArrayBufferAsText(buf) {
    var view = new Uint8Array(buf);
    var chars = new Array(view.length);
    for (var i = 0; i < view.length; i++) {
      chars[i] = String.fromCharCode(view[i]);
    }
    return chars.join("");
  }
  function bufferClone(buf) {
    if (buf.slice) {
      return buf.slice(0);
    } else {
      var view = new Uint8Array(buf.byteLength);
      view.set(new Uint8Array(buf));
      return view.buffer;
    }
  }
  function Body() {
    this.bodyUsed = false;
    this._initBody = function(body) {
      this.bodyUsed = this.bodyUsed;
      this._bodyInit = body;
      if (!body) {
        this._noBody = true;
        this._bodyText = "";
      } else if (typeof body === "string") {
        this._bodyText = body;
      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
        this._bodyBlob = body;
      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
        this._bodyFormData = body;
      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
        this._bodyText = body.toString();
      } else if (support.arrayBuffer && support.blob && isDataView(body)) {
        this._bodyArrayBuffer = bufferClone(body.buffer);
        this._bodyInit = new Blob([this._bodyArrayBuffer]);
      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
        this._bodyArrayBuffer = bufferClone(body);
      } else {
        this._bodyText = body = Object.prototype.toString.call(body);
      }
      if (!this.headers.get("content-type")) {
        if (typeof body === "string") {
          this.headers.set("content-type", "text/plain;charset=UTF-8");
        } else if (this._bodyBlob && this._bodyBlob.type) {
          this.headers.set("content-type", this._bodyBlob.type);
        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
          this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
        }
      }
    };
    if (support.blob) {
      this.blob = function() {
        var rejected = consumed(this);
        if (rejected) {
          return rejected;
        }
        if (this._bodyBlob) {
          return Promise.resolve(this._bodyBlob);
        } else if (this._bodyArrayBuffer) {
          return Promise.resolve(new Blob([this._bodyArrayBuffer]));
        } else if (this._bodyFormData) {
          throw new Error("could not read FormData body as blob");
        } else {
          return Promise.resolve(new Blob([this._bodyText]));
        }
      };
    }
    this.arrayBuffer = function() {
      if (this._bodyArrayBuffer) {
        var isConsumed = consumed(this);
        if (isConsumed) {
          return isConsumed;
        } else if (ArrayBuffer.isView(this._bodyArrayBuffer)) {
          return Promise.resolve(
            this._bodyArrayBuffer.buffer.slice(
              this._bodyArrayBuffer.byteOffset,
              this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength
            )
          );
        } else {
          return Promise.resolve(this._bodyArrayBuffer);
        }
      } else if (support.blob) {
        return this.blob().then(readBlobAsArrayBuffer);
      } else {
        throw new Error("could not read as ArrayBuffer");
      }
    };
    this.text = function() {
      var rejected = consumed(this);
      if (rejected) {
        return rejected;
      }
      if (this._bodyBlob) {
        return readBlobAsText(this._bodyBlob);
      } else if (this._bodyArrayBuffer) {
        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));
      } else if (this._bodyFormData) {
        throw new Error("could not read FormData body as text");
      } else {
        return Promise.resolve(this._bodyText);
      }
    };
    if (support.formData) {
      this.formData = function() {
        return this.text().then(decode$1);
      };
    }
    this.json = function() {
      return this.text().then(JSON.parse);
    };
    return this;
  }
  var methods = ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"];
  function normalizeMethod(method) {
    var upcased = method.toUpperCase();
    return methods.indexOf(upcased) > -1 ? upcased : method;
  }
  function Request$1(input, options) {
    if (!(this instanceof Request$1)) {
      throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
    }
    options = options || {};
    var body = options.body;
    if (input instanceof Request$1) {
      if (input.bodyUsed) {
        throw new TypeError("Already read");
      }
      this.url = input.url;
      this.credentials = input.credentials;
      if (!options.headers) {
        this.headers = new Headers(input.headers);
      }
      this.method = input.method;
      this.mode = input.mode;
      this.signal = input.signal;
      if (!body && input._bodyInit != null) {
        body = input._bodyInit;
        input.bodyUsed = true;
      }
    } else {
      this.url = String(input);
    }
    this.credentials = options.credentials || this.credentials || "same-origin";
    if (options.headers || !this.headers) {
      this.headers = new Headers(options.headers);
    }
    this.method = normalizeMethod(options.method || this.method || "GET");
    this.mode = options.mode || this.mode || null;
    this.signal = options.signal || this.signal || function() {
      if ("AbortController" in g) {
        var ctrl = new AbortController();
        return ctrl.signal;
      }
    }();
    this.referrer = null;
    if ((this.method === "GET" || this.method === "HEAD") && body) {
      throw new TypeError("Body not allowed for GET or HEAD requests");
    }
    this._initBody(body);
    if (this.method === "GET" || this.method === "HEAD") {
      if (options.cache === "no-store" || options.cache === "no-cache") {
        var reParamSearch = /([?&])_=[^&]*/;
        if (reParamSearch.test(this.url)) {
          this.url = this.url.replace(reParamSearch, "$1_=" + (/* @__PURE__ */ new Date()).getTime());
        } else {
          var reQueryString = /\?/;
          this.url += (reQueryString.test(this.url) ? "&" : "?") + "_=" + (/* @__PURE__ */ new Date()).getTime();
        }
      }
    }
  }
  Request$1.prototype.clone = function() {
    return new Request$1(this, { body: this._bodyInit });
  };
  function decode$1(body) {
    var form = new FormData();
    body.trim().split("&").forEach(function(bytes) {
      if (bytes) {
        var split = bytes.split("=");
        var name = split.shift().replace(/\+/g, " ");
        var value = split.join("=").replace(/\+/g, " ");
        form.append(decodeURIComponent(name), decodeURIComponent(value));
      }
    });
    return form;
  }
  function parseHeaders(rawHeaders) {
    var headers = new Headers();
    var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, " ");
    preProcessedHeaders.split("\r").map(function(header) {
      return header.indexOf("\n") === 0 ? header.substr(1, header.length) : header;
    }).forEach(function(line) {
      var parts = line.split(":");
      var key2 = parts.shift().trim();
      if (key2) {
        var value = parts.join(":").trim();
        try {
          headers.append(key2, value);
        } catch (error) {
          console.warn("Response " + error.message);
        }
      }
    });
    return headers;
  }
  Body.call(Request$1.prototype);
  function Response(bodyInit, options) {
    if (!(this instanceof Response)) {
      throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
    }
    if (!options) {
      options = {};
    }
    this.type = "default";
    this.status = options.status === void 0 ? 200 : options.status;
    if (this.status < 200 || this.status > 599) {
      throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");
    }
    this.ok = this.status >= 200 && this.status < 300;
    this.statusText = options.statusText === void 0 ? "" : "" + options.statusText;
    this.headers = new Headers(options.headers);
    this.url = options.url || "";
    this._initBody(bodyInit);
  }
  Body.call(Response.prototype);
  Response.prototype.clone = function() {
    return new Response(this._bodyInit, {
      status: this.status,
      statusText: this.statusText,
      headers: new Headers(this.headers),
      url: this.url
    });
  };
  Response.error = function() {
    var response = new Response(null, { status: 200, statusText: "" });
    response.ok = false;
    response.status = 0;
    response.type = "error";
    return response;
  };
  var redirectStatuses = [301, 302, 303, 307, 308];
  Response.redirect = function(url, status) {
    if (redirectStatuses.indexOf(status) === -1) {
      throw new RangeError("Invalid status code");
    }
    return new Response(null, { status, headers: { location: url } });
  };
  var DOMException = g.DOMException;
  try {
    new DOMException();
  } catch (err) {
    DOMException = function(message, name) {
      this.message = message;
      this.name = name;
      var error = Error(message);
      this.stack = error.stack;
    };
    DOMException.prototype = Object.create(Error.prototype);
    DOMException.prototype.constructor = DOMException;
  }
  function fetch$2(input, init2) {
    return new Promise(function(resolve, reject) {
      var request = new Request$1(input, init2);
      if (request.signal && request.signal.aborted) {
        return reject(new DOMException("Aborted", "AbortError"));
      }
      var xhr = new XMLHttpRequest();
      function abortXhr() {
        xhr.abort();
      }
      xhr.onload = function() {
        var options = {
          statusText: xhr.statusText,
          headers: parseHeaders(xhr.getAllResponseHeaders() || "")
        };
        if (request.url.indexOf("file://") === 0 && (xhr.status < 200 || xhr.status > 599)) {
          options.status = 200;
        } else {
          options.status = xhr.status;
        }
        options.url = "responseURL" in xhr ? xhr.responseURL : options.headers.get("X-Request-URL");
        var body = "response" in xhr ? xhr.response : xhr.responseText;
        setTimeout(function() {
          resolve(new Response(body, options));
        }, 0);
      };
      xhr.onerror = function() {
        setTimeout(function() {
          reject(new TypeError("Network request failed"));
        }, 0);
      };
      xhr.ontimeout = function() {
        setTimeout(function() {
          reject(new TypeError("Network request timed out"));
        }, 0);
      };
      xhr.onabort = function() {
        setTimeout(function() {
          reject(new DOMException("Aborted", "AbortError"));
        }, 0);
      };
      function fixUrl(url) {
        try {
          return url === "" && g.location.href ? g.location.href : url;
        } catch (e) {
          return url;
        }
      }
      xhr.open(request.method, fixUrl(request.url), true);
      if (request.credentials === "include") {
        xhr.withCredentials = true;
      } else if (request.credentials === "omit") {
        xhr.withCredentials = false;
      }
      if ("responseType" in xhr) {
        if (support.blob) {
          xhr.responseType = "blob";
        } else if (support.arrayBuffer) {
          xhr.responseType = "arraybuffer";
        }
      }
      if (init2 && typeof init2.headers === "object" && !(init2.headers instanceof Headers || g.Headers && init2.headers instanceof g.Headers)) {
        var names = [];
        Object.getOwnPropertyNames(init2.headers).forEach(function(name) {
          names.push(normalizeName(name));
          xhr.setRequestHeader(name, normalizeValue(init2.headers[name]));
        });
        request.headers.forEach(function(value, name) {
          if (names.indexOf(name) === -1) {
            xhr.setRequestHeader(name, value);
          }
        });
      } else {
        request.headers.forEach(function(value, name) {
          xhr.setRequestHeader(name, value);
        });
      }
      if (request.signal) {
        request.signal.addEventListener("abort", abortXhr);
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4) {
            request.signal.removeEventListener("abort", abortXhr);
          }
        };
      }
      xhr.send(typeof request._bodyInit === "undefined" ? null : request._bodyInit);
    });
  }
  fetch$2.polyfill = true;
  if (!g.fetch) {
    g.fetch = fetch$2;
    g.Headers = Headers;
    g.Request = Request$1;
    g.Response = Response;
  }
  var fetchNpmBrowserify = self.fetch.bind(self);
  const fetch$1 = /* @__PURE__ */ getDefaultExportFromCjs(fetchNpmBrowserify);
  function Request(url, params) {
    if (params === void 0) {
      params = {};
    }
    return fetch$1(url, params);
  }
  function _extends$1() {
    _extends$1 = Object.assign ? Object.assign.bind() : function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key2 in source) {
          if (Object.prototype.hasOwnProperty.call(source, key2)) {
            target[key2] = source[key2];
          }
        }
      }
      return target;
    };
    return _extends$1.apply(this, arguments);
  }
  function getCna() {
    return new Promise(function(resolve) {
      var queue = window["goldlog_queue"] || (window["goldlog_queue"] = []);
      queue.push({
        action: "goldlog.aplus_pubsub.subscribe",
        arguments: ["CNA", function(_ref) {
          var value = _ref.value;
          resolve(value || "");
        }]
      });
    });
  }
  function injectIntoGoldlog(exdata) {
    var queue = window["goldlog_queue"] || (window["goldlog_queue"] = []);
    queue.push({
      action: "goldlog.appendMetaInfo",
      arguments: ["aplus-exdata", _extends$1({}, exdata)]
    });
  }
  /*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   */
  var parse_1 = parse;
  var decode = decodeURIComponent;
  function parse(str, options) {
    if (typeof str !== "string") {
      throw new TypeError("argument str must be a string");
    }
    var obj = {};
    var opt = options || {};
    var pairs = str.split(";");
    var dec = opt.decode || decode;
    for (var i = 0; i < pairs.length; i++) {
      var pair = pairs[i];
      var index = pair.indexOf("=");
      if (index < 0) {
        continue;
      }
      var key2 = pair.substring(0, index).trim();
      if (void 0 == obj[key2]) {
        var val = pair.substring(index + 1, pair.length).trim();
        if (val[0] === '"') {
          val = val.slice(1, -1);
        }
        obj[key2] = tryDecode(val, dec);
      }
    }
    return obj;
  }
  function tryDecode(str, decode2) {
    try {
      return decode2(str);
    } catch (e) {
      return str;
    }
  }
  typeof window === "undefined" && (window = { ctrl: {}, lib: {} });
  !window.ctrl && (window.ctrl = {});
  !window.lib && (window.lib = {});
  !function(a, b) {
    function c(a2, b2) {
      u[a2] || (u[a2] = true, console.log(b2));
    }
    function d() {
      var a2 = {}, b2 = new s(function(b3, c2) {
        a2.resolve = b3, a2.reject = c2;
      });
      return a2.promise = b2, a2;
    }
    function e(a2, b2) {
      for (var c2 in b2) void 0 === a2[c2] && (a2[c2] = b2[c2]);
      return a2;
    }
    function f(a2) {
      var b2 = document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0] || document.firstElementChild || document;
      b2.appendChild(a2);
    }
    function g2() {
      if (window.etSign) window.__etReady = true;
      else {
        window.etReady = function() {
          window.__etReady = true;
        };
        var a2 = document.createElement("script");
        a2.src = "//g.alicdn.com/sd/baxia-entry/index.js", f(a2);
      }
    }
    function h(a2) {
      var b2 = [];
      for (var c2 in a2) a2[c2] && b2.push(c2 + "=" + encodeURIComponent(a2[c2]));
      return b2.join("&");
    }
    function i(a2) {
      try {
        return ".com" !== a2.substring(a2.lastIndexOf(".")) ? (a2.split(".") || []).length <= 3 ? a2 : a2.split(".").slice(1).join(".") : a2.substring(a2.lastIndexOf(".", a2.lastIndexOf(".") - 1) + 1);
      } catch (b2) {
        return a2.substring(a2.lastIndexOf(".", a2.lastIndexOf(".") - 1) + 1);
      }
    }
    function j(a2) {
      function b2(a3, b3) {
        return a3 << b3 | a3 >>> 32 - b3;
      }
      function c2(a3, b3) {
        var c3, d3, e3, f3, g4;
        return e3 = 2147483648 & a3, f3 = 2147483648 & b3, c3 = 1073741824 & a3, d3 = 1073741824 & b3, g4 = (1073741823 & a3) + (1073741823 & b3), c3 & d3 ? 2147483648 ^ g4 ^ e3 ^ f3 : c3 | d3 ? 1073741824 & g4 ? 3221225472 ^ g4 ^ e3 ^ f3 : 1073741824 ^ g4 ^ e3 ^ f3 : g4 ^ e3 ^ f3;
      }
      function d2(a3, b3, c3) {
        return a3 & b3 | ~a3 & c3;
      }
      function e2(a3, b3, c3) {
        return a3 & c3 | b3 & ~c3;
      }
      function f2(a3, b3, c3) {
        return a3 ^ b3 ^ c3;
      }
      function g3(a3, b3, c3) {
        return b3 ^ (a3 | ~c3);
      }
      function h2(a3, e3, f3, g4, h3, i3, j3) {
        return a3 = c2(a3, c2(c2(d2(e3, f3, g4), h3), j3)), c2(b2(a3, i3), e3);
      }
      function i2(a3, d3, f3, g4, h3, i3, j3) {
        return a3 = c2(a3, c2(c2(e2(d3, f3, g4), h3), j3)), c2(b2(a3, i3), d3);
      }
      function j2(a3, d3, e3, g4, h3, i3, j3) {
        return a3 = c2(a3, c2(c2(f2(d3, e3, g4), h3), j3)), c2(b2(a3, i3), d3);
      }
      function k2(a3, d3, e3, f3, h3, i3, j3) {
        return a3 = c2(a3, c2(c2(g3(d3, e3, f3), h3), j3)), c2(b2(a3, i3), d3);
      }
      function l2(a3) {
        for (var b3, c3 = a3.length, d3 = c3 + 8, e3 = (d3 - d3 % 64) / 64, f3 = 16 * (e3 + 1), g4 = new Array(f3 - 1), h3 = 0, i3 = 0; c3 > i3; ) b3 = (i3 - i3 % 4) / 4, h3 = i3 % 4 * 8, g4[b3] = g4[b3] | a3.charCodeAt(i3) << h3, i3++;
        return b3 = (i3 - i3 % 4) / 4, h3 = i3 % 4 * 8, g4[b3] = g4[b3] | 128 << h3, g4[f3 - 2] = c3 << 3, g4[f3 - 1] = c3 >>> 29, g4;
      }
      function m2(a3) {
        var b3, c3, d3 = "", e3 = "";
        for (c3 = 0; 3 >= c3; c3++) b3 = a3 >>> 8 * c3 & 255, e3 = "0" + b3.toString(16), d3 += e3.substr(e3.length - 2, 2);
        return d3;
      }
      function n2(a3) {
        a3 = a3.replace(/\r\n/g, "\n");
        for (var b3 = "", c3 = 0; c3 < a3.length; c3++) {
          var d3 = a3.charCodeAt(c3);
          128 > d3 ? b3 += String.fromCharCode(d3) : d3 > 127 && 2048 > d3 ? (b3 += String.fromCharCode(d3 >> 6 | 192), b3 += String.fromCharCode(63 & d3 | 128)) : (b3 += String.fromCharCode(d3 >> 12 | 224), b3 += String.fromCharCode(d3 >> 6 & 63 | 128), b3 += String.fromCharCode(63 & d3 | 128));
        }
        return b3;
      }
      var o2, p2, q2, r2, s2, t2, u2, v2, w2, x2 = [], y2 = 7, z2 = 12, A2 = 17, B2 = 22, C2 = 5, D2 = 9, E2 = 14, F2 = 20, G2 = 4, H2 = 11, I2 = 16, J2 = 23, K = 6, L = 10, M = 15, N = 21;
      for (a2 = n2(a2), x2 = l2(a2), t2 = 1732584193, u2 = 4023233417, v2 = 2562383102, w2 = 271733878, o2 = 0; o2 < x2.length; o2 += 16) p2 = t2, q2 = u2, r2 = v2, s2 = w2, t2 = h2(t2, u2, v2, w2, x2[o2 + 0], y2, 3614090360), w2 = h2(w2, t2, u2, v2, x2[o2 + 1], z2, 3905402710), v2 = h2(v2, w2, t2, u2, x2[o2 + 2], A2, 606105819), u2 = h2(u2, v2, w2, t2, x2[o2 + 3], B2, 3250441966), t2 = h2(t2, u2, v2, w2, x2[o2 + 4], y2, 4118548399), w2 = h2(w2, t2, u2, v2, x2[o2 + 5], z2, 1200080426), v2 = h2(v2, w2, t2, u2, x2[o2 + 6], A2, 2821735955), u2 = h2(u2, v2, w2, t2, x2[o2 + 7], B2, 4249261313), t2 = h2(t2, u2, v2, w2, x2[o2 + 8], y2, 1770035416), w2 = h2(w2, t2, u2, v2, x2[o2 + 9], z2, 2336552879), v2 = h2(v2, w2, t2, u2, x2[o2 + 10], A2, 4294925233), u2 = h2(u2, v2, w2, t2, x2[o2 + 11], B2, 2304563134), t2 = h2(t2, u2, v2, w2, x2[o2 + 12], y2, 1804603682), w2 = h2(w2, t2, u2, v2, x2[o2 + 13], z2, 4254626195), v2 = h2(v2, w2, t2, u2, x2[o2 + 14], A2, 2792965006), u2 = h2(u2, v2, w2, t2, x2[o2 + 15], B2, 1236535329), t2 = i2(t2, u2, v2, w2, x2[o2 + 1], C2, 4129170786), w2 = i2(w2, t2, u2, v2, x2[o2 + 6], D2, 3225465664), v2 = i2(v2, w2, t2, u2, x2[o2 + 11], E2, 643717713), u2 = i2(u2, v2, w2, t2, x2[o2 + 0], F2, 3921069994), t2 = i2(t2, u2, v2, w2, x2[o2 + 5], C2, 3593408605), w2 = i2(w2, t2, u2, v2, x2[o2 + 10], D2, 38016083), v2 = i2(v2, w2, t2, u2, x2[o2 + 15], E2, 3634488961), u2 = i2(u2, v2, w2, t2, x2[o2 + 4], F2, 3889429448), t2 = i2(t2, u2, v2, w2, x2[o2 + 9], C2, 568446438), w2 = i2(w2, t2, u2, v2, x2[o2 + 14], D2, 3275163606), v2 = i2(v2, w2, t2, u2, x2[o2 + 3], E2, 4107603335), u2 = i2(u2, v2, w2, t2, x2[o2 + 8], F2, 1163531501), t2 = i2(t2, u2, v2, w2, x2[o2 + 13], C2, 2850285829), w2 = i2(w2, t2, u2, v2, x2[o2 + 2], D2, 4243563512), v2 = i2(v2, w2, t2, u2, x2[o2 + 7], E2, 1735328473), u2 = i2(u2, v2, w2, t2, x2[o2 + 12], F2, 2368359562), t2 = j2(t2, u2, v2, w2, x2[o2 + 5], G2, 4294588738), w2 = j2(w2, t2, u2, v2, x2[o2 + 8], H2, 2272392833), v2 = j2(v2, w2, t2, u2, x2[o2 + 11], I2, 1839030562), u2 = j2(u2, v2, w2, t2, x2[o2 + 14], J2, 4259657740), t2 = j2(t2, u2, v2, w2, x2[o2 + 1], G2, 2763975236), w2 = j2(w2, t2, u2, v2, x2[o2 + 4], H2, 1272893353), v2 = j2(v2, w2, t2, u2, x2[o2 + 7], I2, 4139469664), u2 = j2(u2, v2, w2, t2, x2[o2 + 10], J2, 3200236656), t2 = j2(t2, u2, v2, w2, x2[o2 + 13], G2, 681279174), w2 = j2(w2, t2, u2, v2, x2[o2 + 0], H2, 3936430074), v2 = j2(v2, w2, t2, u2, x2[o2 + 3], I2, 3572445317), u2 = j2(u2, v2, w2, t2, x2[o2 + 6], J2, 76029189), t2 = j2(t2, u2, v2, w2, x2[o2 + 9], G2, 3654602809), w2 = j2(w2, t2, u2, v2, x2[o2 + 12], H2, 3873151461), v2 = j2(v2, w2, t2, u2, x2[o2 + 15], I2, 530742520), u2 = j2(u2, v2, w2, t2, x2[o2 + 2], J2, 3299628645), t2 = k2(t2, u2, v2, w2, x2[o2 + 0], K, 4096336452), w2 = k2(w2, t2, u2, v2, x2[o2 + 7], L, 1126891415), v2 = k2(v2, w2, t2, u2, x2[o2 + 14], M, 2878612391), u2 = k2(u2, v2, w2, t2, x2[o2 + 5], N, 4237533241), t2 = k2(t2, u2, v2, w2, x2[o2 + 12], K, 1700485571), w2 = k2(w2, t2, u2, v2, x2[o2 + 3], L, 2399980690), v2 = k2(v2, w2, t2, u2, x2[o2 + 10], M, 4293915773), u2 = k2(u2, v2, w2, t2, x2[o2 + 1], N, 2240044497), t2 = k2(t2, u2, v2, w2, x2[o2 + 8], K, 1873313359), w2 = k2(w2, t2, u2, v2, x2[o2 + 15], L, 4264355552), v2 = k2(v2, w2, t2, u2, x2[o2 + 6], M, 2734768916), u2 = k2(u2, v2, w2, t2, x2[o2 + 13], N, 1309151649), t2 = k2(t2, u2, v2, w2, x2[o2 + 4], K, 4149444226), w2 = k2(w2, t2, u2, v2, x2[o2 + 11], L, 3174756917), v2 = k2(v2, w2, t2, u2, x2[o2 + 2], M, 718787259), u2 = k2(u2, v2, w2, t2, x2[o2 + 9], N, 3951481745), t2 = c2(t2, p2), u2 = c2(u2, q2), v2 = c2(v2, r2), w2 = c2(w2, s2);
      var O = m2(t2) + m2(u2) + m2(v2) + m2(w2);
      return O.toLowerCase();
    }
    function k(a2) {
      return "[object Object]" == {}.toString.call(a2);
    }
    function l(a2, b2, c2) {
      var d2 = c2 || {};
      document.cookie = a2.replace(/[^+#$&^`|]/g, encodeURIComponent).replace("(", "%28").replace(")", "%29") + "=" + b2.replace(/[^+#$&/:<-\[\]-}]/g, encodeURIComponent) + (d2.domain ? ";domain=" + d2.domain : "") + (d2.path ? ";path=" + d2.path : "") + (d2.secure ? ";secure" : "") + (d2.httponly ? ";HttpOnly" : "") + (d2.sameSite ? ";Samesite=" + d2.sameSite : "");
    }
    function m(a2) {
      var b2 = new RegExp("(?:^|;\\s*)" + a2 + "\\=([^;]+)(?:;\\s*|$)").exec(document.cookie);
      return b2 ? b2[1] : void 0;
    }
    function n(a2, b2, c2) {
      var d2 = /* @__PURE__ */ new Date();
      d2.setTime(d2.getTime() - 864e5);
      var e2 = "/";
      document.cookie = a2 + "=;path=" + e2 + ";domain=." + b2 + ";expires=" + d2.toGMTString(), document.cookie = a2 + "=;path=" + e2 + ";domain=." + c2 + "." + b2 + ";expires=" + d2.toGMTString();
    }
    function o(a2, b2) {
      for (var c2 = a2.split("."), d2 = b2.split("."), e2 = 3, f2 = 0; e2 > f2; f2++) {
        var g3 = Number(c2[f2]), h2 = Number(d2[f2]);
        if (g3 > h2) return 1;
        if (h2 > g3) return -1;
        if (!isNaN(g3) && isNaN(h2)) return 1;
        if (isNaN(g3) && !isNaN(h2)) return -1;
      }
      return 0;
    }
    function p() {
      var b2 = a.location.hostname;
      if (!b2) {
        var c2 = a.parent.location.hostname;
        c2 && ~c2.indexOf("zebra.alibaba-inc.com") && (b2 = c2);
      }
      var d2 = ["taobao.net", "taobao.com", "tmall.com", "tmall.hk", "alibaba-inc.com"], e2 = new RegExp("([^.]*?)\\.?((?:" + d2.join(")|(?:").replace(/\./g, "\\.") + "))", "i"), f2 = b2.match(e2) || [], g3 = f2[2] || "taobao.com", h2 = f2[1] || "m";
      "taobao.net" !== g3 || "x" !== h2 && "waptest" !== h2 && "daily" !== h2 ? "taobao.net" === g3 && "demo" === h2 ? h2 = "demo" : "alibaba-inc.com" === g3 && "zebra" === h2 ? h2 = "zebra" : "waptest" !== h2 && "wapa" !== h2 && "m" !== h2 && (h2 = "m") : h2 = "waptest";
      var i2 = "h5api";
      "taobao.net" === g3 && "waptest" === h2 && (i2 = "acs"), w.mainDomain = g3, w.subDomain = h2, w.prefix = i2;
    }
    function q() {
      var b2 = a.navigator.userAgent, c2 = b2.match(/WindVane[\/\s]([\d\.\_]+)/);
      c2 && (w.WindVaneVersion = c2[1]);
      var d2 = b2.match(/AliApp\(([^\/]+)\/([\d\.\_]+)\)/i);
      d2 && (w.AliAppName = d2[1], w.AliAppVersion = d2[2]);
      var e2 = b2.match(/AMapClient\/([\d\.\_]+)/i);
      e2 && (w.AliAppName = "AMAP", w.AliAppVersion = e2[1]);
    }
    function r(a2) {
      this.id = "" + (/* @__PURE__ */ new Date()).getTime() + ++C, this.params = e(a2 || {}, { v: "*", data: {}, type: "get", dataType: "jsonp" }), this.params.type = this.params.type.toLowerCase(), "object" == typeof this.params.data && (this.params.data = JSON.stringify(this.params.data)), this.middlewares = x.slice(0);
    }
    var s = a.Promise, t = (s || { resolve: function() {
      return void 0;
    } }).resolve(), u = {}, v = { DOWNGRADE_BY_WINDVANE: "DOWNGRADE_BY_WINDVANE", DOWNGRADE_BY_IFRAME: "DOWNGRADE_BY_IFRAME" };
    String.prototype.trim || (String.prototype.trim = function() {
      return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
    });
    var w = { useJsonpResultType: false, safariGoLogin: true, useAlipayJSBridge: false }, x = [], y = { ERROR: -1, SUCCESS: 0, TOKEN_EXPIRED: 1, SESSION_EXPIRED: 2 };
    p(), q();
    var z = /[Android|Adr]/.test(a.navigator.userAgent), A = "AP" === w.AliAppName, B = A && o(w.AliAppVersion, "10.1.2") >= 0 || "KB" === w.AliAppName && o(w.AliAppVersion, "7.1.62") >= 0 || z && "AMAP" === w.AliAppName && o(w.AliAppVersion, "1.0.1") >= 0, C = 0, D = "2.7.5";
    r.prototype.use = function(a2) {
      if (!a2) throw new Error("middleware is undefined");
      return this.middlewares.push(a2), this;
    }, r.prototype.__processRequestMethod = function(a2) {
      var b2 = this.params, c2 = this.options;
      "get" === b2.type && "jsonp" === b2.dataType ? c2.getJSONP = true : "get" === b2.type && "originaljsonp" === b2.dataType ? c2.getOriginalJSONP = true : "get" === b2.type && "json" === b2.dataType ? c2.getJSON = true : "post" === b2.type && (c2.postJSON = true), a2();
    }, r.prototype.__processRequestType = function(d2) {
      var e2 = this, f2 = this.params, g3 = this.options;
      if (w.H5Request === true && (g3.H5Request = true), w.WindVaneRequest === true && (g3.WindVaneRequest = true), g3.H5Request === false && g3.WindVaneRequest === true) {
        if (!B && (!b.windvane || parseFloat(g3.WindVaneVersion) < 5.4)) throw new Error("WINDVANE_NOT_FOUND::WindVane");
        if (B && !a.AlipayJSBridge) throw new Error("ALIPAY_NOT_READY:: https://lark.alipay.com/mtbsdkdocs/mtopjssdkdocs/pucq6z");
      } else if (g3.H5Request === true) g3.WindVaneRequest = false;
      else if ("undefined" == typeof g3.WindVaneRequest && "undefined" == typeof g3.H5Request) {
        if (b.windvane && parseFloat(g3.WindVaneVersion) >= 5.4 ? g3.WindVaneRequest = true : (c(v.DOWNGRADE_BY_WINDVANE, "[@ali/lib-mtop] The current page does not have the lib.windvane variable, automatically downgraded to H5 request"), g3.H5Request = true), B) {
          if (g3.WindVaneRequest = g3.H5Request = void 0, a.AlipayJSBridge) if (k(f2.data)) g3.WindVaneRequest = true;
          else try {
            k(JSON.parse(f2.data)) ? g3.WindVaneRequest = true : g3.H5Request = true;
          } catch (h2) {
            g3.H5Request = true;
          }
          else g3.H5Request = true;
          "AMAP" !== w.AliAppName || f2.useNebulaJSbridgeWithAMAP || (g3.WindVaneRequest = g3.H5Request = void 0, g3.H5Request = true);
        }
        window.self !== window.top && (c(v.DOWNGRADE_BY_IFRAME, "[@ali/lib-mtop] The current page is embedded in an iframe, cannot use WindVane request, automatically downgraded to H5 request"), g3.H5Request = true);
      }
      var i2 = a.navigator.userAgent.toLowerCase();
      return i2.indexOf("youku") > -1 && g3.mainDomain.indexOf("youku.com") < 0 && (g3.WindVaneRequest = false, g3.H5Request = true), g3.mainDomain.indexOf("youku.com") > -1 && i2.indexOf("youku") < 0 && (g3.WindVaneRequest = false, g3.H5Request = true), d2 ? d2().then(function() {
        var a2 = g3.retJson.ret;
        if (a2 instanceof Array && (a2 = a2.join(",")), g3.WindVaneRequest === true && B && g3.retJson.error || !a2 || a2.indexOf("PARAM_PARSE_ERROR") > -1 || a2.indexOf("HY_FAILED") > -1 || a2.indexOf("HY_NO_HANDLER") > -1 || a2.indexOf("HY_CLOSED") > -1 || a2.indexOf("HY_EXCEPTION") > -1 || a2.indexOf("HY_NO_PERMISSION") > -1) {
          if (!B || !isNaN(g3.retJson.error) || -1 !== g3.retJson.error.indexOf("FAIL_SYS_ACCESS_DENIED")) return B && k(f2.data) && (f2.data = JSON.stringify(f2.data)), w.H5Request = true, e2.__sequence([e2.__processRequestType, e2.__processToken, e2.__processRequestUrl, e2.middlewares, e2.__processRequest]);
          "undefined" == typeof g3.retJson.api && "undefined" == typeof g3.retJson.v && (g3.retJson.api = f2.api, g3.retJson.v = f2.v, g3.retJson.ret = [g3.retJson.error + "::" + g3.retJson.errorMessage], g3.retJson.data = {});
        }
      }) : void 0;
    };
    var E = "_m_h5_c", F = "_m_h5_tk", G = "_m_h5_tk_enc";
    r.prototype.__getTokenFromAlipay = function() {
      var b2 = d(), c2 = this.options, e2 = !!location.protocol.match(/^https?\:$/);
      return c2.useAlipayJSBridge === true && !e2 && B && a.AlipayJSBridge && a.AlipayJSBridge.call ? a.AlipayJSBridge.call("getMtopToken", function(a2) {
        a2 && a2.token && (c2.token = a2.token), b2.resolve();
      }, function() {
        b2.resolve();
      }) : b2.resolve(), b2.promise;
    }, r.prototype.__getTokenFromCookie = function() {
      var a2 = this.options;
      return a2.CDR && m(E) ? a2.token = m(E).split(";")[0] : a2.token = a2.token || m(F), a2.token && (a2.token = a2.token.split("_")[0]), s.resolve();
    }, r.prototype.__waitWKWebViewCookie = function(b2) {
      var c2 = this.options;
      c2.waitWKWebViewCookieFn && c2.H5Request && a.webkit && a.webkit.messageHandlers ? c2.waitWKWebViewCookieFn(b2) : b2();
    }, r.prototype.__processToken = function(a2) {
      var b2 = this, c2 = this.options;
      this.params;
      return c2.token && delete c2.token, c2.WindVaneRequest !== true ? t.then(function() {
        return b2.__getTokenFromAlipay();
      }).then(function() {
        return b2.__getTokenFromCookie();
      }).then(a2).then(function() {
        var a3 = c2.retJson, d2 = a3.ret;
        if (d2 instanceof Array && (d2 = d2.join(",")), d2.indexOf("TOKEN_EMPTY") > -1 || (c2.CDR === true || c2.syncCookieMode === true) && d2.indexOf("ILLEGAL_ACCESS") > -1 || d2.indexOf("TOKEN_EXOIRED") > -1) {
          if (c2.maxRetryTimes = c2.maxRetryTimes || 5, c2.failTimes = c2.failTimes || 0, c2.H5Request && ++c2.failTimes < c2.maxRetryTimes) {
            var e2 = [b2.__waitWKWebViewCookie, b2.__processToken, b2.__processRequestUrl, b2.middlewares, b2.__processRequest];
            if (c2.syncCookieMode === true && b2.constructor.__cookieProcessorId !== b2.id) if (b2.constructor.__cookieProcessor) {
              var f2 = function(a4) {
                var c3 = function() {
                  b2.constructor.__cookieProcessor = null, b2.constructor.__cookieProcessorId = null, a4();
                };
                b2.constructor.__cookieProcessor ? b2.constructor.__cookieProcessor.then(c3)["catch"](c3) : a4();
              };
              e2 = [f2, b2.__waitWKWebViewCookie, b2.__processToken, b2.__processRequestUrl, b2.middlewares, b2.__processRequest];
            } else b2.constructor.__cookieProcessor = b2.__requestProcessor, b2.constructor.__cookieProcessorId = b2.id;
            return b2.__sequence(e2);
          }
          c2.maxRetryTimes > 0 && (n(E, c2.pageDomain, "*"), n(F, c2.mainDomain, c2.subDomain), n(G, c2.mainDomain, c2.subDomain)), a3.retType = y.TOKEN_EXPIRED;
        }
      }) : void a2();
    }, r.prototype.__processRequestUrl = function(b2) {
      var c2 = this.params, d2 = this.options;
      if (d2.hostSetting && d2.hostSetting[a.location.hostname]) {
        var e2 = d2.hostSetting[a.location.hostname];
        e2.prefix && (d2.prefix = e2.prefix), e2.subDomain && (d2.subDomain = e2.subDomain), e2.mainDomain && (d2.mainDomain = e2.mainDomain);
      }
      if (d2.H5Request === true) {
        var f2 = "//" + (d2.prefix ? d2.prefix + "." : "") + (d2.subDomain ? d2.subDomain + "." : "") + d2.mainDomain + "/h5/" + c2.api.toLowerCase() + "/" + c2.v.toLowerCase() + "/", h2 = c2.appKey || ("waptest" === d2.subDomain ? "4272" : "12574478"), i2 = (/* @__PURE__ */ new Date()).getTime(), k2 = j(d2.token + "&" + i2 + "&" + h2 + "&" + c2.data), l2 = { jsv: D, appKey: h2, t: i2, sign: k2 };
        d2.bxOption && Object.keys(d2.bxOption).forEach(function(a2) {
          l2["_" + a2] = d2.bxOption[a2];
        });
        var m2 = { data: c2.data, ua: c2.ua };
        Object.keys(c2).forEach(function(a2) {
          "undefined" == typeof l2[a2] && "undefined" == typeof m2[a2] && "headers" !== a2 && "ext_headers" !== a2 && "ext_querys" !== a2 && (l2[a2] = c2[a2]);
        }), c2.ext_querys && Object.keys(c2.ext_querys).forEach(function(a2) {
          l2[a2] = c2.ext_querys[a2];
        }), d2.getJSONP ? l2.type = "jsonp" : d2.getOriginalJSONP ? l2.type = "originaljsonp" : (d2.getJSON || d2.postJSON) && (l2.type = "originaljson"), "undefined" != typeof c2.valueType && ("original" === c2.valueType ? d2.getJSONP || d2.getOriginalJSONP ? l2.type = "originaljsonp" : (d2.getJSON || d2.postJSON) && (l2.type = "originaljson") : "string" === c2.valueType && (d2.getJSONP || d2.getOriginalJSONP ? l2.type = "jsonp" : (d2.getJSON || d2.postJSON) && (l2.type = "json"))), d2.useJsonpResultType === true && "originaljson" === l2.type && delete l2.type, d2.dangerouslySetProtocol && (f2 = d2.dangerouslySetProtocol + ":" + f2), "5.0" === c2.SV && (f2 += "5.0/", g2()), d2.querystring = l2, d2.postdata = m2, d2.path = f2;
      }
      b2();
    }, r.prototype.__processUnitPrefix = function(a2) {
      a2();
    };
    var H = 0;
    r.prototype.__requestJSONP = function(a2) {
      function b2(a3) {
        if (k2 && clearTimeout(k2), l2.parentNode && l2.parentNode.removeChild(l2), "TIMEOUT" === a3) window[j2] = function() {
          window[j2] = void 0;
          try {
            delete window[j2];
          } catch (a4) {
          }
        };
        else {
          window[j2] = void 0;
          try {
            delete window[j2];
          } catch (b3) {
          }
        }
      }
      var c2 = d(), e2 = this.params, g3 = this.options, i2 = e2.timeout || 2e4, j2 = "mtopjsonp" + (e2.jsonpIncPrefix || "") + ++H, k2 = setTimeout(function() {
        a2(g3.timeoutErrMsg || "TIMEOUT::"), b2("TIMEOUT");
      }, i2);
      g3.querystring.callback = j2;
      var l2 = document.createElement("script"), m2 = g3.path + "?" + h(g3.querystring) + "&" + h(g3.postdata);
      return "5.0" === e2.SV && window.etSign && (m2 += "&bx_et=" + window.etSign(m2)), l2.src = m2, l2.async = true, l2.onerror = function() {
        b2("ABORT"), a2(g3.abortErrMsg || "ABORT::");
      }, window[j2] = function() {
        g3.results = Array.prototype.slice.call(arguments), b2(), c2.resolve();
      }, f(l2), c2.promise;
    }, r.prototype.__requestJSON = function(b2) {
      function c2(a2) {
        k2 && clearTimeout(k2), "TIMEOUT" === a2 && i2.abort();
      }
      var e2 = d(), f2 = this.params, g3 = this.options, i2 = new a.XMLHttpRequest(), j2 = f2.timeout || 2e4, k2 = setTimeout(function() {
        b2(g3.timeoutErrMsg || "TIMEOUT::"), c2("TIMEOUT");
      }, j2);
      g3.CDR && m(E) && (g3.querystring.c = decodeURIComponent(m(E))), i2.onreadystatechange = function() {
        if (4 == i2.readyState) {
          var a2, d2, f3 = i2.status;
          if (f3 >= 200 && 300 > f3 || 304 == f3) {
            c2(), a2 = i2.responseText, d2 = i2.getAllResponseHeaders() || "";
            try {
              a2 = /^\s*$/.test(a2) ? {} : JSON.parse(a2), a2.responseHeaders = d2, g3.results = [a2], e2.resolve();
            } catch (h2) {
              b2("PARSE_JSON_ERROR::JSON");
            }
          } else c2("ABORT"), b2(g3.abortErrMsg || "ABORT::");
        }
      };
      var l2, n2, o2 = g3.path + "?" + h(g3.querystring);
      g3.getJSON ? (l2 = "GET", o2 += "&" + h(g3.postdata)) : g3.postJSON && (l2 = "POST", n2 = h(g3.postdata)), "5.0" === f2.SV && window.etSign && (o2 += "&bx_et=" + window.etSign(o2)), i2.open(l2, o2, true), i2.withCredentials = true, i2.setRequestHeader("Accept", "application/json"), i2.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      var p2 = f2.ext_headers || f2.headers;
      if (p2) for (var q2 in p2) i2.setRequestHeader(q2, p2[q2]);
      return i2.send(n2), e2.promise;
    }, r.prototype.__requestWindVane = function(a2) {
      function c2(a3) {
        if (g3.results = [a3], a3 && a3.stat && a3.stat.falcoId) {
          var c3 = function() {
          }, d2 = { mtopStart: u2, mtopEnd: Date.now(), falcoId: a3.stat.falcoId };
          b.windvane.call(w2, "falcoExtend", d2, c3, c3);
        }
        e2.resolve();
      }
      var e2 = d(), f2 = this.params, g3 = this.options, h2 = f2.data, i2 = f2.api, j2 = f2.v, k2 = g3.postJSON ? 1 : 0, l2 = g3.getJSON || g3.postJSON || g3.getOriginalJSONP ? "originaljson" : "";
      "undefined" != typeof f2.valueType && ("original" === f2.valueType ? l2 = "originaljson" : "string" === f2.valueType && (l2 = "")), g3.useJsonpResultType === true && (l2 = "");
      var m2, n2, o2 = "https" === location.protocol ? 1 : 0, p2 = f2.isSec || 0, q2 = f2.sessionOption || "AutoLoginOnly", r2 = f2.ecode || 0, s2 = f2.ext_headers || {}, t2 = f2.ext_querys || {};
      n2 = "undefined" != typeof f2.timer ? parseInt(f2.timer) : "undefined" != typeof f2.timeout ? parseInt(f2.timeout) : 2e4, m2 = 2 * n2;
      var u2 = Date.now();
      f2.needLogin === true && "undefined" == typeof f2.sessionOption && (q2 = "AutoLoginAndManualLogin"), "undefined" != typeof f2.secType && "undefined" == typeof f2.isSec && (p2 = f2.secType);
      var v2 = { api: i2, v: j2, post: String(k2), type: l2, isHttps: String(o2), ecode: String(r2), isSec: String(p2), param: JSON.parse(h2), timer: n2, needLogin: !!f2.needLogin, sessionOption: q2, ext_headers: s2, ext_querys: t2 };
      f2.ttid && g3.dangerouslySetWVTtid === true && (v2.ttid = f2.ttid), Object.assign && f2.dangerouslySetWindvaneParams && Object.assign(v2, f2.dangerouslySetWindvaneParams);
      var w2 = "MtopWVPlugin";
      return "string" == typeof f2.customWindVaneClassName && (w2 = f2.customWindVaneClassName), b.windvane.call(w2, "send", v2, c2, c2, m2), e2.promise;
    }, r.prototype.__requestAlipay = function(b2) {
      function c2(a2) {
        g3.results = [a2], e2.resolve();
      }
      var e2 = d(), f2 = this.params, g3 = this.options, h2 = { apiName: f2.api, apiVersion: f2.v, needEcodeSign: "1" === String(f2.ecode), headers: f2.ext_headers || {}, usePost: !!g3.postJSON };
      k(f2.data) || (f2.data = JSON.parse(f2.data)), h2.data = f2.data, f2.ttid && g3.dangerouslySetWVTtid === true && (h2.ttid = f2.ttid), (g3.getJSON || g3.postJSON || g3.getOriginalJSONP) && (h2.type = "originaljson"), "undefined" != typeof f2.valueType && ("original" === f2.valueType ? h2.type = "originaljson" : "string" === f2.valueType && delete h2.type), g3.useJsonpResultType === true && delete h2.type, Object.assign && f2.dangerouslySetAlipayParams && Object.assign(h2, f2.dangerouslySetAlipayParams);
      var i2 = "mtop";
      return "string" == typeof f2.customAlipayJSBridgeApi && (i2 = f2.customAlipayJSBridgeApi), a.AlipayJSBridge.call(i2, h2, c2), e2.promise;
    }, r.prototype.__processRequest = function(a2, b2) {
      var c2 = this;
      return t.then(function() {
        var a3 = c2.options;
        if (a3.H5Request && (a3.getJSONP || a3.getOriginalJSONP)) return c2.__requestJSONP(b2);
        if (a3.H5Request && (a3.getJSON || a3.postJSON)) return c2.__requestJSON(b2);
        if (a3.WindVaneRequest) return B ? c2.__requestAlipay(b2) : c2.__requestWindVane(b2);
        throw new Error("UNEXCEPT_REQUEST::");
      }).then(a2).then(function() {
        var a3 = c2.options, b3 = (c2.params, a3.results[0]), d2 = b3 && b3.ret || [];
        b3.ret = d2, d2 instanceof Array && (d2 = d2.join(","));
        var e2 = b3.c;
        a3.CDR && e2 && l(E, e2, { domain: a3.pageDomain, path: "/", secure: a3.secure, sameSite: a3.sameSite }), d2.indexOf("SUCCESS") > -1 ? b3.retType = y.SUCCESS : b3.retType = y.ERROR, a3.retJson = b3;
      });
    }, r.prototype.__sequence = function(a2) {
      function b2(a3) {
        if (a3 instanceof Array) a3.forEach(b2);
        else {
          var g4, h3 = d(), i2 = d();
          e2.push(function() {
            return h3 = d(), g4 = a3.call(c2, function(a4) {
              return h3.resolve(a4), i2.promise;
            }, function(a4) {
              return h3.reject(a4), i2.promise;
            }), g4 && (g4 = g4["catch"](function(a4) {
              h3.reject(a4);
            })), h3.promise;
          }), f2.push(function(a4) {
            return i2.resolve(a4), g4;
          });
        }
      }
      var c2 = this, e2 = [], f2 = [];
      a2.forEach(b2);
      for (var g3, h2 = t; g3 = e2.shift(); ) h2 = h2.then(g3);
      for (; g3 = f2.pop(); ) h2 = h2.then(g3);
      return h2;
    };
    var I = function(a2) {
      if (!w.EtRequest) return void a2();
      if (window.etSign) return window.__etReady = true, void a2();
      if (window.__etReady) a2();
      else {
        g2();
        var b2, c2, d2 = Number(w.EtLoadTimeout) || 5e3, e2 = false;
        window.etReady = function() {
          window.__etReady = true, e2 || (e2 = true, a2());
        };
        var f2 = function() {
          b2 && clearInterval(b2), c2 && clearTimeout(c2), e2 || (e2 = true, a2());
        };
        b2 = setInterval(function() {
          try {
            window.etSign && (window.__etReady = true, f2()), window.etReady && !window.__etReady && (window.etReady = function() {
              window.__etReady = true, f2();
            });
          } catch (a3) {
            f2();
          }
        }, 100), c2 = setTimeout(function() {
          f2();
        }, d2);
      }
    }, J = function(a2) {
      a2();
    };
    r.prototype.request = function(c2) {
      var d2 = this;
      if (this.options = e(c2 || {}, w), !s) {
        var f2 = "PromisewindowsPromise";
        throw b.mtop = { ERROR: f2 }, new Error(f2);
      }
      var g3 = s.resolve([I, J]).then(function(a2) {
        var b2 = a2[0], c3 = a2[1];
        return d2.__sequence([b2, d2.__processRequestMethod, d2.__processRequestType, d2.__processToken, d2.__processRequestUrl, d2.middlewares, d2.__processRequest, c3]);
      }).then(function() {
        var a2 = d2.options.retJson;
        return a2.retType !== y.SUCCESS ? s.reject(a2) : d2.options.successCallback ? void d2.options.successCallback(a2) : s.resolve(a2);
      })["catch"](function(a2) {
        var c3;
        return a2 instanceof Error ? (console.error(a2.stack), c3 = { ret: [a2.message], stack: [a2.stack], retJson: y.ERROR }) : c3 = "string" == typeof a2 ? { ret: [a2], retJson: y.ERROR } : void 0 !== a2 ? a2 : d2.options.retJson, b.mtop.errorListener && b.mtop.errorListener({ api: d2.params.api, data: d2.params.data, v: d2.params.v, retJson: c3 }), d2.options.failureCallback ? void d2.options.failureCallback(c3) : s.reject(c3);
      });
      return this.__processRequestType(), d2.options.H5Request && (d2.constructor.__firstProcessor || (d2.constructor.__firstProcessor = g3), I = function(a2) {
        d2.constructor.__firstProcessor.then(a2)["catch"](a2);
      }), ("get" === this.params.type && "json" === this.params.dataType || "post" === this.params.type) && (c2.pageDomain = c2.pageDomain || i(a.location.hostname), c2.mainDomain !== c2.pageDomain && (c2.maxRetryTimes = 4, c2.CDR = true)), this.__requestProcessor = g3, g3;
    }, b.mtop = function(a2) {
      return new r(a2);
    }, b.mtop.request = function(a2, b2, c2) {
      var d2 = { H5Request: a2.H5Request, WindVaneRequest: a2.WindVaneRequest, LoginRequest: a2.LoginRequest, AntiCreep: a2.AntiCreep, AntiFlood: a2.AntiFlood, successCallback: b2, failureCallback: c2 || b2 };
      return new r(a2).request(d2);
    }, b.mtop.H5Request = function(a2, b2, c2) {
      var d2 = { H5Request: true, successCallback: b2, failureCallback: c2 || b2 };
      return new r(a2).request(d2);
    }, b.mtop.middlewares = x, b.mtop.config = w, b.mtop.RESPONSE_TYPE = y, b.mtop.CLASS = r;
  }(window, window.lib || (window.lib = {})), function(a, b) {
    function c(a2) {
      return a2.preventDefault(), false;
    }
    function d(a2) {
      var b2 = new RegExp("(?:^|;\\s*)" + a2 + "\\=([^;]+)(?:;\\s*|$)").exec(document.cookie);
      return b2 ? b2[1] : void 0;
    }
    function e(b2, d2, e2) {
      var f2 = navigator.userAgent.match(/.*(iPhone|iPad|Android|ios|SymbianOS|Windows Phone).*/i), g3 = f2 && d2.h5url ? d2.h5url : d2.url, h2 = d2.dialogSize;
      e2 = e2 || d2.attributes;
      var i2 = this, j2 = a.dpr || 1, k2 = document.createElement("div"), l2 = document.documentElement.getBoundingClientRect(), m = Math.max(l2.width, window.innerWidth) / j2, n = window.innerHeight / j2;
      k2.style.cssText = ["-webkit-transform:scale(" + j2 + ") translateZ(0)", "-ms-transform:scale(" + j2 + ") translateZ(0)", "transform:scale(" + j2 + ") translateZ(0)", "-webkit-transform-origin:0 0", "-ms-transform-origin:0 0", "transform-origin:0 0", "width:" + m + "px", "height:" + n + "px", "z-index:2147483647", "position: fixed", "left:0", "top:0px", "background:" + (m > 800 ? "rgba(0,0,0,.5)" : "#FFF"), "display:none"].join(";");
      var o = document.createElement("div");
      o.style.cssText = ["width:100%", "height:52px", "background:transparent", "line-height:52px", "text-align:left", "box-sizing:border-box", "padding-left:20px", "position:absolute", "left:0", "top:0", "font-size:16px", "font-weight:bold", "color:#333"].join(";"), o.innerText = b2;
      var p = document.createElement("img");
      p.style.cssText = ["display:block", "position:absolute", "margin-top:15px", "right:0", "top:0", "height:15px", "line-height:52px", "padding:0 20px", "color:#999"].join(";"), p.src = "https://gw.alicdn.com/tfs/TB1QZN.CYj1gK0jSZFuXXcrHpXa-200-200.png";
      var q = document.createElement("iframe");
      if (q.style.cssText = ["width:100%", "height:100%", "border:0", "overflow:hidden"].join(";"), f2) o.appendChild(p), k2.appendChild(o);
      else {
        var r = h2 && h2.width || "420px", s = h2 && h2.height || "320px", t = 50, u = 50, v = 24, w = -39;
        s.indexOf("px") > -1 ? v -= Number(s.replace("px", "")) / 2 : s.indexOf("%") > -1 && (t -= Number(s.replace("%", "")) / 2), r.indexOf("px") > -1 ? w += Number(r.replace("px", "")) / 2 : r.indexOf("%") > -1 && (u += Number(r.replace("%", "")) / 2), p.style.cssText = ["position:absolute", "width:15px", "height:15px", "top:" + t + "%", "left:" + u + "%", "cursor: pointer", "border:0", "z-index:1", "overflow:hidden", "margin-top:" + v + "px", "margin-left:" + w + "px"].join(";"), k2.appendChild(p), q.style.cssText = ["position:absolute", "top:0px", "left:0px", "bottom:0px", "right:0px", "margin:auto", "width:" + r, "height:" + s, "border:0", "background:#FFF", "overflow:hidden", "border-radius:18px"].join(";"), e2 && e2.style && (q.style.cssText += e2.style, delete e2.style);
      }
      if (e2) try {
        e2.style && delete e2.style, Object.keys(e2).forEach(function(a2) {
          q.setAttribute(a2, e2[a2]);
        });
      } catch (x) {
      }
      k2.appendChild(q), k2.className = "J_MIDDLEWARE_FRAME_WIDGET", document.body.appendChild(k2), q.src = g3, p.addEventListener("click", function() {
        i2.hide();
        var a2 = document.createEvent("HTMLEvents");
        a2.initEvent("close", false, false), k2.dispatchEvent(a2);
      }, false), this.addEventListener = function() {
        k2.addEventListener.apply(k2, arguments);
      }, this.removeEventListener = function() {
        k2.removeEventListener.apply(k2, arguments);
      }, this.show = function() {
        document.addEventListener("touchmove", c, false), k2.style.display = "block", window.scrollTo(0, 0);
      }, this.hide = function() {
        document.removeEventListener("touchmove", c), window.scrollTo(0, -l2.top), k2.parentNode && k2.parentNode.removeChild(k2);
      };
    }
    function f(a2) {
      var c2 = this, d2 = this.options, e2 = this.params;
      return a2().then(function() {
        var a3 = d2.retJson, f2 = a3.ret, g3 = navigator.userAgent.toLowerCase(), h2 = g3.indexOf("safari") > -1 && g3.indexOf("chrome") < 0 && g3.indexOf("qqbrowser") < 0;
        if (f2 instanceof Array && (f2 = f2.join(",")), (f2.indexOf("SESSION_EXPIRED") > -1 || f2.indexOf("SID_INVALID") > -1 || f2.indexOf("AUTH_REJECT") > -1 || f2.indexOf("NEED_LOGIN") > -1) && (a3.retType = l.SESSION_EXPIRED, !d2.WindVaneRequest && (k.LoginRequest === true || d2.LoginRequest === true || e2.needLogin === true))) {
          if (!b.login) throw new Error("LOGIN_NOT_FOUND::lib.login");
          var i2 = { apiReferer: e2.api + ":" + e2.v };
          if (d2.safariGoLogin !== true || !h2 || "taobao.com" === d2.pageDomain) return b.login.goLoginAsync(i2).then(function(a4) {
            return c2.__sequence([c2.__processToken, c2.__processRequestUrl, c2.__processUnitPrefix, c2.middlewares, c2.__processRequest]);
          })["catch"](function(a4) {
            throw "CANCEL" === a4 ? new Error("LOGIN_CANCEL::") : new Error("LOGIN_FAILURE::");
          });
          b.login.goLogin(i2);
        }
      });
    }
    function g2(a2) {
      var b2 = this.options;
      this.params;
      return b2.H5Request !== true || k.AntiFlood !== true && b2.AntiFlood !== true ? void a2() : a2().then(function() {
        var a3 = b2.retJson, c2 = a3.ret;
        c2 instanceof Array && (c2 = c2.join(",")), c2.indexOf("FAIL_SYS_USER_VALIDATE") > -1 && a3.data.url && (b2.AntiFloodReferer ? location.href = a3.data.url.replace(/(http_referer=).+/, "$1" + b2.AntiFloodReferer) : location.href = a3.data.url);
      });
    }
    function h(b2) {
      var c2 = this, f2 = this.options, g3 = this.params;
      return f2.AntiCreep !== false && (f2.AntiCreep = true), g3.forceAntiCreep !== true && f2.H5Request !== true || k.AntiCreep !== true && f2.AntiCreep !== true ? void b2() : b2().then(function() {
        var b3 = f2.retJson, h2 = b3.ret;
        if (h2 instanceof Array && (h2 = h2.join(",")), h2.indexOf("CHECKJS_FLAG") > -1 && b3.uuid && b3.serid) {
          try {
            var j2 = !!window.document._sufei_data2, k2 = new Image(), l2 = "https://fourier.taobao.com/ts?ext=200&uuid=" + b3.uuid + "&serid=" + b3.serid + "&sufei=" + j2;
            window.location && location.href && (l2 += "&href==" + location.href.substr(0, 128)), window.__fyModule && (l2 += "&fyModuleLoad=" + window.__fyModule.load + "&fyModuleInit=" + window.__fyModule.init), window.__umModule && (l2 += "&umModuleLoad=" + window.__umModule.load + "&umModuleInit=" + window.__umModule.init), window.__uabModule && (l2 += "&uabModuleLoad=" + window.__uabModule.load + "&uabModuleInit=" + window.__uabModule.init), window.__ncModule && (l2 += "&ncModuleLoad=" + window.__ncModule.load + "&ncModuleInit=" + window.__ncModule.init), window.__nsModule && (l2 += "&nsModuleLoad=" + window.__nsModule.load + "&nsModuleInit=" + window.__nsModule.init), window.__etModule && (l2 += "&etModuleLoad=" + window.__etModule.load + "&etModuleInit=" + window.__etModule.init), k2.src = l2, document.body.appendChild(k2);
          } catch (m) {
            console.log(m, "");
          }
          return c2.__sequence([c2.__processToken, c2.__processRequestUrl, c2.__processUnitPrefix, c2.middlewares, c2.__processRequest]);
        }
        if (h2.indexOf("RGV587_RUN_SCRIPT::SM") > -1) return new i(function(a2, d2) {
          try {
            var e2 = c2;
            e2.resend = function() {
              c2.__sequence([c2.__processToken, c2.__processRequestUrl, c2.__processUnitPrefix, c2.middlewares, c2.__processRequest]).then(a2);
            }, e2.resolve = a2, e2.reject = d2, e2.timer = setTimeout(function() {
              clearTimeout(e2.timer), e2.timer = null, e2.resend();
            }, 2e3);
            var f3 = document.createElement("script");
            f3.src = b3.data.url, f3.crossOrigin = true, f3.async = true, f3.onerror = function() {
              e2.resend();
            };
            var g4 = false;
            f3.onload = f3.onreadystatechange = function() {
              g4 || f3.readyState && !/loaded|complete/.test(f3.readyState) || (f3.onload = f3.onreadystatechange = null, g4 = true, window._bxPunishFun && "function" == typeof window._bxPunishFun && window._bxPunishFun(e2), b3.data.async || (clearTimeout(e2.timer), e2.timer = null, e2.resend()));
            };
            var h3 = document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0] || document.firstElementChild || document;
            h3.appendChild(f3);
          } catch (i2) {
            d2("SCRIPT_RUN_ERROR::");
          }
        });
        if ((h2.indexOf("RGV587_ERROR::SM") > -1 || h2.indexOf("ASSIST_FLAG") > -1) && b3.data.url) {
          if ("object" == typeof f2.bxOption && "new" === f2.bxOption["bx-" + b3.action]) {
            var n = b3.data.url + "&x5referer=" + encodeURIComponent(location.href);
            return location.href = n, new i(function() {
            });
          }
          var o = "_m_h5_smt", p = d(o), q = false;
          if (f2.saveAntiCreepToken === true && p) {
            p = JSON.parse(p);
            for (var r in p) g3[r] && (q = true);
          }
          if (f2.saveAntiCreepToken === true && p && !q) {
            for (var r in p) g3[r] = p[r];
            return c2.__sequence([c2.__processToken, c2.__processRequestUrl, c2.__processUnitPrefix, c2.middlewares, c2.__processRequest]);
          }
          return new i(function(d2, h3) {
            function i2() {
              k3.removeEventListener("close", i2), a.removeEventListener("message", j3), h3("USER_INPUT_CANCEL::");
            }
            function j3(b4) {
              var e2;
              try {
                e2 = JSON.parse(b4.data) || {};
              } catch (l3) {
              }
              if (e2 && "child" === e2.type) {
                k3.removeEventListener("close", i2), a.removeEventListener("message", j3), k3.hide();
                var m;
                try {
                  m = JSON.parse(decodeURIComponent(e2.content)), "string" == typeof m && (m = JSON.parse(m));
                  for (var n2 in m) g3[n2] = m[n2];
                  f2.saveAntiCreepToken === true ? (document.cookie = o + "=" + JSON.stringify(m) + ";", a.location.reload()) : c2.__sequence([c2.__processToken, c2.__processRequestUrl, c2.__processUnitPrefix, c2.middlewares, c2.__processRequest]).then(d2);
                } catch (l3) {
                  h3("USER_INPUT_FAILURE::");
                }
              }
            }
            var k3 = new e("", b3.data, b3.attributes);
            k3.addEventListener("close", i2, false), a.addEventListener("message", j3, false), b3.data.dialogHide || k3.show();
          });
        }
      });
    }
    if (!b || !b.mtop || b.mtop.ERROR) throw new Error("Mtop ");
    var i = a.Promise, j = b.mtop.CLASS, k = b.mtop.config, l = b.mtop.RESPONSE_TYPE;
    b.mtop.middlewares.push(f), b.mtop.loginRequest = function(a2, b2, c2) {
      var d2 = { LoginRequest: true, H5Request: true, successCallback: b2, failureCallback: c2 || b2 };
      return new j(a2).request(d2);
    }, b.mtop.antiFloodRequest = function(a2, b2, c2) {
      var d2 = { AntiFlood: true, successCallback: b2, failureCallback: c2 || b2 };
      return new j(a2).request(d2);
    }, b.mtop.middlewares.push(g2), b.mtop.antiCreepRequest = function(a2, b2, c2) {
      var d2 = { AntiCreep: true, successCallback: b2, failureCallback: c2 || b2 };
      return new j(a2).request(d2);
    }, b.mtop.middlewares.push(h);
  }(window, window.lib || (window.lib = {}));
  var mtop_common = window.lib["mtop"];
  function getFromCookie() {
    var loginId = "";
    var accountId = "";
    var aliId = "";
    var language = "";
    var country = "";
    var locale2 = "";
    var localCookie = document.cookie;
    var _cookie = parse_1(localCookie);
    var cna = _cookie.cna, sc_g_cfg_f = _cookie.sc_g_cfg_f, intl_locale = _cookie.intl_locale, xman_us_f = _cookie.xman_us_f, xman_us_t = _cookie.xman_us_t, xman_i = _cookie.xman_i, ali_apache_track = _cookie.ali_apache_track;
    if (ali_apache_track) {
      var _querystring$parse = parse$1(ali_apache_track.replace(/\|/g, "&")), _querystring$parse$mi = _querystring$parse.mid, mid = _querystring$parse$mi === void 0 ? "" : _querystring$parse$mi;
      loginId = mid;
    } else if (xman_us_t) {
      var _querystring$parse2 = parse$1(xman_us_t), _querystring$parse2$x = _querystring$parse2.x_lid, x_lid = _querystring$parse2$x === void 0 ? "" : _querystring$parse2$x;
      loginId = x_lid;
    }
    if (xman_i) {
      var _querystring$parse3 = parse$1(xman_i), _querystring$parse3$a = _querystring$parse3.aid, aid = _querystring$parse3$a === void 0 ? "" : _querystring$parse3$a;
      aliId = aid;
    }
    if (sc_g_cfg_f) {
      var _querystring$parse4 = parse$1(sc_g_cfg_f), _querystring$parse4$s = _querystring$parse4.sc_b_locale, sc_b_locale = _querystring$parse4$s === void 0 ? "" : _querystring$parse4$s;
      locale2 = sc_b_locale;
    } else if (intl_locale) {
      locale2 = intl_locale;
    }
    if (xman_us_f) {
      var _querystring$parse5 = parse$1(xman_us_f), _querystring$parse5$x = _querystring$parse5.x_user, x_user = _querystring$parse5$x === void 0 ? "" : _querystring$parse5$x, _querystring$parse5$x2 = _querystring$parse5.x_locale, x_locale = _querystring$parse5$x2 === void 0 ? "" : _querystring$parse5$x2;
      if (x_user) {
        var userItems = x_user.split("|");
        accountId = userItems[userItems.length - 1] || "";
        country = userItems[0] || "";
      }
      if (!locale2) {
        locale2 = x_locale;
      }
    }
    if (locale2) {
      var localeItems = locale2.split("_");
      language = localeItems[0] || "";
      if (/^zh/.test(locale2)) {
        language = "zh-Hans";
        if (/(hk|tw)$/gi.test(locale2)) {
          language = "zh-Hant";
        }
      }
      if (/^iw/.test(locale2)) {
        language = "he";
      }
    }
    return {
      cna,
      // cna
      loginId,
      accountId,
      aliId,
      language,
      // 
      country,
      // 
      platform: "web",
      // 
      channel: "",
      // 
      version: ""
      // web
    };
  }
  function getAliId(aliId) {
    return new Promise(function(resolve) {
      if (!aliId) return resolve(aliId);
      return mtop_common.request({
        api: "mtop.alibaba.uicservice.queryIdMsg",
        v: "1.0",
        appKey: "24889839",
        // h5
        data: {
          hid: aliId
        },
        dataType: "json"
      }).then(function(res) {
        var _ref = res.data || {}, aliMemberHid = _ref.aliMemberHid;
        resolve(aliMemberHid || aliId);
      }, function() {
        resolve(aliId);
      });
    });
  }
  const RESULT_TYPE = {
    // 
    SUCCESS: {
      code: 0,
      message: "success"
    },
    // 
    ILLEGAL_ARGUMENT: {
      code: 1
    },
    // client
    XS_SDK_ERROR: {
      code: 3
    }
  };
  function _inheritsLoose(subClass, superClass) {
    subClass.prototype = Object.create(superClass.prototype);
    subClass.prototype.constructor = subClass;
    _setPrototypeOf(subClass, superClass);
  }
  function _wrapNativeSuper(Class) {
    var _cache = typeof Map === "function" ? /* @__PURE__ */ new Map() : void 0;
    _wrapNativeSuper = function _wrapNativeSuper2(Class2) {
      if (Class2 === null || !_isNativeFunction(Class2)) return Class2;
      if (typeof Class2 !== "function") {
        throw new TypeError("Super expression must either be null or a function");
      }
      if (typeof _cache !== "undefined") {
        if (_cache.has(Class2)) return _cache.get(Class2);
        _cache.set(Class2, Wrapper);
      }
      function Wrapper() {
        return _construct(Class2, arguments, _getPrototypeOf(this).constructor);
      }
      Wrapper.prototype = Object.create(Class2.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } });
      return _setPrototypeOf(Wrapper, Class2);
    };
    return _wrapNativeSuper(Class);
  }
  function _construct() {
    if (_isNativeReflectConstruct()) {
      _construct = Reflect.construct.bind();
    } else {
      _construct = function _construct2(Parent, args, Class) {
        var a = [null];
        a.push.apply(a, args);
        var Constructor = Function.bind.apply(Parent, a);
        var instance = new Constructor();
        if (Class) _setPrototypeOf(instance, Class.prototype);
        return instance;
      };
    }
    return _construct.apply(null, arguments);
  }
  function _isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;
    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      }));
      return true;
    } catch (e) {
      return false;
    }
  }
  function _isNativeFunction(fn) {
    return Function.toString.call(fn).indexOf("[native code]") !== -1;
  }
  function _setPrototypeOf(o, p) {
    _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(o2, p2) {
      o2.__proto__ = p2;
      return o2;
    };
    return _setPrototypeOf(o, p);
  }
  function _getPrototypeOf(o) {
    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(o2) {
      return o2.__proto__ || Object.getPrototypeOf(o2);
    };
    return _getPrototypeOf(o);
  }
  var ValidateError = /* @__PURE__ */ function(_Error) {
    _inheritsLoose(ValidateError2, _Error);
    function ValidateError2(message, code) {
      var _this = _Error.call(this, message) || this;
      _this.code = void 0;
      _this.code = code || RESULT_TYPE.ILLEGAL_ARGUMENT.code;
      return _this;
    }
    return ValidateError2;
  }(/* @__PURE__ */ _wrapNativeSuper(Error));
  var wpkReporter$1 = { exports: {} };
  (function(module2, exports3) {
    !function(e, t) {
      module2.exports = t();
    }(commonjsGlobal, function() {
      return function(e) {
        var t = {};
        function n(r) {
          if (t[r]) return t[r].exports;
          var o = t[r] = { i: r, l: false, exports: {} };
          return e[r].call(o.exports, o, o.exports, n), o.l = true, o.exports;
        }
        return n.m = e, n.c = t, n.d = function(e2, t2, r) {
          n.o(e2, t2) || Object.defineProperty(e2, t2, { enumerable: true, get: r });
        }, n.r = function(e2) {
          "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e2, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e2, "__esModule", { value: true });
        }, n.t = function(e2, t2) {
          if (1 & t2 && (e2 = n(e2)), 8 & t2) return e2;
          if (4 & t2 && "object" == typeof e2 && e2 && e2.__esModule) return e2;
          var r = /* @__PURE__ */ Object.create(null);
          if (n.r(r), Object.defineProperty(r, "default", { enumerable: true, value: e2 }), 2 & t2 && "string" != typeof e2) for (var o in e2) n.d(r, o, function(t3) {
            return e2[t3];
          }.bind(null, o));
          return r;
        }, n.n = function(e2) {
          var t2 = e2 && e2.__esModule ? function() {
            return e2.default;
          } : function() {
            return e2;
          };
          return n.d(t2, "a", t2), t2;
        }, n.o = function(e2, t2) {
          return Object.prototype.hasOwnProperty.call(e2, t2);
        }, n.p = "", n(n.s = 3);
      }([function(e, t) {
        e.exports = { sdk: { BID: "wpkreporter", CID: "jssdk", WID_KEY: "__wpkreporterwid_", WID_KEY2: "__itrace_wid" }, env: { BROWSER: "browser", NODEJS: "nodejs", WEEX: "weex" }, px: { signKey: "Uvn#08uefVdwe&c4", addr: { cn: "http://px.effirst.com/api/v1/jssdk/upload", cn_https: "https://px.effirst.com/api/v1/jssdk/upload", quark: "http://px.wpk.quark.cn/api/v1/jssdk/upload", quark_https: "https://px.wpk.quark.cn/api/v1/jssdk/upload", intl: "http://px-intl.ucweb.com/api/v1/jssdk/upload", intl_https: "https://px-intl.ucweb.com/api/v1/jssdk/upload", qg: "http://px-itrace.xuexi.cn/api/v1/jssdk/upload", qg_https: "https://px-itrace.xuexi.cn/api/v1/jssdk/upload" }, confAddr: { cn: "http://px.effirst.com/api/v1/jconfig", cn_https: "https://px.effirst.com/api/v1/jconfig", intl: "http://px-intl.ucweb.com/api/v1/jconfig", intl_https: "https://px-intl.ucweb.com/api/v1/jconfig", qg: "http://px-itrace.xuexi.cn/api/v1/jconfig", qg_https: "https://px-itrace.xuexi.cn/api/v1/jconfig", quark: "http://px.wpk.quark.cn/api/v1/jconfig", quark_https: "https://px.wpk.quark.cn/api/v1/jconfig" } }, http: { methods: { GET: "GET", PUT: "PUT", POST: "POST", HEAD: "HEAD", DELETE: "DELETE", OPTIONS: "OPTIONS", CONNECT: "OPTIONS", TRACE: "OPTIONS", PATCH: "OPTIONS" }, protocols: { HTTP: "http:", HTTPS: "https:" } }, category: { JSERR: 1, API: 2, JSFSPERF: 3, RESLOADFAIL: 4, FLOW: 5, BKPG: 6, HARLOG: 7, PERFNEXT: 1e3, MAINDOC: 1e5, RESTIMING: 100001 }, navConn: { types: { BLUETOOTH: "bluetooth", CELLULAR: "cellular", ETHERNET: "ethernet", MIXED: "mixed", NONE: "none", OTHER: "other", UNKNOWN: "unknown", WIFI: "wifi", WIMAX: "wimax" }, effectiveTypes: { "2G": "2g", "3G": "3g", "4G": "4g", SLOW2G: "slow-2g" } } };
      }, function(e, t, n) {
        var r = n(6), o = n(0), i = o.px, a = o.category;
        function s(e2) {
          if (!(this instanceof s)) return new s(e2);
          e2 = e2 || {}, this._init = false, this.toolKit = r(e2), this.logger = this.toolKit.logger, this.debug = e2.debug || false, true === e2.debug && this.logger.warn("[wpk] now in debug mode, you can see log details"), this._plugins = e2.plugins || [], this.bid = e2.bid, this.utdid = e2.utdid, this.cid = e2.cid, this.uid = e2.uid, this.rel = e2.rel, this.spa = e2.spa || false, this.delay = false !== e2.delay, this.sampleRate = e2.sampleRate, this.ignoreScriptError = false !== e2.ignoreScriptError, this.onlyCustom = e2.onlyCustomInUCCore || e2.onlyCustom || false, this.ignoreU4HA = true === e2.ignoreU4HA, this.beforeSend = e2.beforeSend || null, this.checkHidden = false !== e2.checkHidden, this.enableMtop = e2.enableMtop || false, this.prerender = true === e2.prerender, this.disableCookie = true === e2.disableCookie, this.supportBeaconBody = false !== e2.supportBeaconBody, this.blockAlipayMiniAppWebview = e2.blockAlipayMiniAppWebview || false, this.maxSessDuration = e2.maxSessDuration || 288e5, this._waitingQueue = [], this.useNativeCH = false !== e2.useNativeCH, !e2.cluster && this.toolKit.isQuark() ? this.cluster = "quark" : this.cluster = e2.cluster || "cn";
        }
        function c(e2) {
          if (e2.toolKit.inAlipayMiniAppWebview() && true === e2.blockAlipayMiniAppWebview) e2.logger.warn("current runtime is alipay miniapp webview, this request will be blocked.");
          else {
            var t2 = i.confAddr[e2.cluster + (e2.isHttps ? "_https" : "")], n2 = i.signKey;
            e2._startTime = Date.now(), e2._dying = true, e2.toolKit.dynamicConf(e2.bid, e2.VERSION, t2, n2, function(t3) {
              e2._dying = false, e2._dyConf = t3, e2.logger.warn("jconfig come back");
            });
          }
        }
        s.prototype = { VERSION: "1.2.9", initialize: function(e2) {
          this.env = e2.env, e2.root.location && -1 !== e2.root.location.search.indexOf("wpkReporterDebug=true") && (this.debug = true), this.send = e2.send, this.getWid = e2.getWid, this.isHttps = e2.isHttps, e2.bindUnloadEvent(this);
        }, ready: function() {
          return this._init;
        }, setConfig: function(e2) {
          return this.toolKit.isObject(e2) && this.toolKit.extend(this, e2), this;
        }, report: function(e2) {
          "string" == typeof e2 && (e2 = { category: a.JSERR, msg: e2 });
          var t2 = e2.sampleRate || this.sampleRate;
          if (t2 || 0 === t2 || (t2 = 1), this.toolKit.canReport(t2)) {
            if (this._cleanData(e2), this.ready()) {
              var n2;
              if ("function" == typeof this.beforeSend) {
                try {
                  n2 = this.beforeSend(e2);
                } catch (e3) {
                  this.logger.error("exec beforeSend failed for:", e3);
                }
                if (false === n2) return void this.logger.warn("beforeSend func return false");
                "object" == typeof n2 && (e2 = n2);
              }
              var r2 = this.toolKit.getMetas(), o2 = e2.bid || this.bid || r2.wpkBid, s2 = e2.cid || this.cid || r2.wpkCid, u = e2.rel || this.rel || r2.wpkRel;
              this.toolKit.isFunction(u) && (u = u());
              var l = e2.uid || this.uid;
              if (this.toolKit.isFunction(l) && (l = l()), l || (l = this.getWid()), Date.now() - this._begin >= this.maxSessDuration && (this._begin = Date.now(), this._sid = this.toolKit.getSessionId()), this.toolKit.extend(e2, { w_bid: o2, w_cid: s2, w_rel: u, w_spa: this.spa, w_tm: this.toolKit.timestamp(), w_cnt: 1, uid: l, utdid: this.utdid, type: this.toolKit.categoryToType(e2.category), sdk_ver: this.VERSION, log_src: "jssdk", uc_param: this.uc_param || "", wid: this.wid }), this._dyConf && Date.now() < this._dyConf.expireAt) {
                var p = void 0 !== this._dyConf[e2.type + "@" + e2.category] ? this._dyConf[e2.type + "@" + e2.category] : this._dyConf[e2.type];
                if (void 0 !== (p = void 0 !== p ? p : this._dyConf.all) && !this.toolKit.canReport(p)) return void this.logger.warn(": ", e2.type, e2.category, " : ", p);
              } else !this._dying && Date.now() - this._startTime >= 18e5 && (this.logger.warn("syncing dynamic config"), c(this));
              var d = { app: o2, cp: "none", de: 4, seq: this.toolKit.generateSeq(), tm: this.toolKit.timestamp(true), ud: encodeURIComponent(e2.uid), ver: e2.w_rel, type: e2.type, sver: e2.sdk_ver, sign: "9bf8a190ef82c5049df7b199c599c45b" }, f = i.addr[this.cluster + (this.isHttps ? "_https" : "")], g2 = this.toolKit.objToQueryString(d);
              this.toolKit.cutStr(e2, ["c1", "c2", "c3", "c4", "c5"], 128), this.send(f, g2, e2);
            } else this._waitingQueue.push(e2), this.logger.warn("sdk");
            return this;
          }
          this.logger.warn(": ", t2);
        }, _cleanData: function(e2) {
          for (var t2, n2 = 1; n2 <= 10; n2++) t2 = "bl" + n2, e2.hasOwnProperty(t2) && (e2["w_" + t2] = e2[t2], delete e2[t2]);
          t2 = null;
        }, reportFlow: function(e2) {
          return e2 = e2 || {}, this.report(this.toolKit.extend(e2 || {}, { category: a.FLOW, sampleRate: 1 })), this;
        }, reportError: function(e2, t2) {
          return this.toolKit.isError(e2) ? ((t2 = t2 || {}).category = a.JSERR, t2.w_msg = e2.toString(), t2.stack = this.toolKit.parseErrorStack(e2), t2.w_file = e2.filename || "", t2.w_line = e2.lineno || "", t2.w_col = e2.colno || "", this.report(t2), this) : this.report(e2, t2);
        }, reportApi: function(e2, t2) {
          this.reportApiError(e2, t2);
        }, reportApiError: function(e2, t2) {
          return e2 && (this.toolKit.isObject(e2.queryString) && (e2.queryString = this.toolKit.objToQueryString(e2.queryString)), this.report(this.toolKit.extend(t2 || {}, { msg: e2.msg || "", w_res: e2.url, w_method: e2.method, w_param: e2.queryString, w_body: JSON.stringify(e2.body), w_resp: e2.response, w_rc: e2.status, w_rt: e2.spent || 0, c1: e2.c1, c2: e2.c2, c3: e2.c3, c4: e2.c4, c5: e2.c5 }, { category: a.API, w_type: 16 }))), this;
        }, reportBlankPage: function(e2) {
          return (e2 = e2 || {}).hasOwnProperty("w_fp") || this.toolKit.extend(e2, { w_fp: 999 }), this.report(this.toolKit.extend(e2 || {}, { category: a.BKPG })), this;
        }, diagnose: function() {
          this.ready() ? this.bid ? (this.sampleRate || this.logger.warn("sampleRate"), this.report({ _diagnose: true })) : this.logger.warn("bid,") : this.logger.warn("wpkReporter install ");
        }, addPlugin: function(e2, t2) {
          return this._plugins.push([e2, t2]), "function" == typeof e2 && this._init && e2.apply(this, [this, t2]), this;
        }, install: function() {
          var e2;
          c(this), this.toolKit.isCompassPrerender() && ((e2 = this).toolKit.onListen(document, "prerendercommit", function() {
            e2.prerenderCommit();
          }, true), e2.toolKit.onListen(document, "touchstart", function() {
            e2.prerenderCommit();
          }, true), this.prerender = true);
          for (var t2 = n(2), r2 = this._plugins.length, o2 = false, i2 = 0; i2 < r2; i2++) {
            var a2 = this._plugins[i2], s2 = a2[0], u = a2[1];
            s2.prototype.pluginId === t2.prototype.pluginId && (o2 = true), s2.apply(this, [this, u]);
          }
          return this.wid = this.getWid(), this._begin = Date.now(), this._sid = this.toolKit.getSessionId(), this._init = true, 0 !== r2 && o2 || (this.toolKit.logger.info("Flow"), this.addPlugin(t2)), this.prerender && this.toolKit.logger.warn(", "), this;
        }, installAll: function() {
          var e2 = [[n(8), { resErr: true }], [n(9)], [n(10)], [n(2)], [n(11), { params: "prveosfrnwutsv" }]], t2 = this._plugins.length;
          if (0 === t2) this._plugins = e2;
          else {
            for (var r2 = [], o2 = e2.length, i2 = 0; i2 < o2; i2++) {
              for (var a2 = e2[i2], s2 = 0; s2 < t2; s2++) if (a2[0].prototype.pluginId === this._plugins[s2][0].prototype.pluginId) {
                a2 = this._plugins[s2];
                break;
              }
              r2.push(a2);
            }
            this._plugins = r2;
          }
          return this.install();
        }, uninstall: function() {
          return this._plugins = [], this._init = false, this;
        }, prerenderCommit: function() {
          if (this.__isPrerenderCommited) this.logger.warn("prerenderCommit can only call once.");
          else {
            this.__isPrerenderCommited = true, this.logger.info("prerender commit event");
            var e2 = new Event("wpkpageforeground");
            window.dispatchEvent(e2);
          }
        } }, e.exports = s;
      }, function(e, t, n) {
        var r = n(0).env, o = function(e2) {
          var t2;
          return (e2 ? (t2 = e2.replace(/^#\/?/, "")) && "string" == typeof t2 ? t2.replace(/^(https?:)?\/\//, "").replace(/\?.*$/, "") : "" : "") || "[index]";
        }, i = function(e2, t2) {
          if (t2 = t2 || {}, e2.env === r.BROWSER && window) if (e2.toolKit.extend({ enable: true }, t2).enable) {
            e2.logger.info("wpkflowPlugin");
            var i2, a, s = function() {
              e2.reportFlow();
            };
            e2.toolKit.isPageReady(e2.prerender) ? setTimeout(s, 0) : e2.toolKit.onPageReady(s, true, e2.prerender), e2.spa && (n(7)(), i2 = function(t3) {
              o(location.hash) && (e2._begin = Date.now(), e2._sid = e2.toolKit.getSessionId(), e2.reportFlow());
            }, a = function(t3) {
              o(t3.detail) && (e2._begin = Date.now(), e2._sid = e2.toolKit.getSessionId(), e2.reportFlow());
            }, e2.toolKit.onListen(window, "hashchange", i2), e2.toolKit.onListen(window, "historystatechange", a)), e2.toolKit.onListen(window, "beforeunload", function() {
              e2.toolKit.offListen(window, "load"), e2.toolKit.offListen(window, "hashchange"), e2.toolKit.offListen(window, "historystatechange"), s = i2 = a = null;
            });
          } else e2.logger.info("wpkflowPlugin");
        };
        i.prototype.pluginId = "flow", e.exports = i;
      }, function(e, t, n) {
        (function(t2) {
          var r = "object" == typeof t2 && t2 + "" == "[object process]", o = "function" == typeof callNative || "function" == typeof nativeLog;
          e.exports = n(o ? 5 : r ? 13 : 16);
        }).call(this, n(4));
      }, function(e, t) {
        var n, r, o = e.exports = {};
        function i() {
          throw new Error("setTimeout has not been defined");
        }
        function a() {
          throw new Error("clearTimeout has not been defined");
        }
        function s(e2) {
          if (n === setTimeout) return setTimeout(e2, 0);
          if ((n === i || !n) && setTimeout) return n = setTimeout, setTimeout(e2, 0);
          try {
            return n(e2, 0);
          } catch (t2) {
            try {
              return n.call(null, e2, 0);
            } catch (t3) {
              return n.call(this, e2, 0);
            }
          }
        }
        !function() {
          try {
            n = "function" == typeof setTimeout ? setTimeout : i;
          } catch (e2) {
            n = i;
          }
          try {
            r = "function" == typeof clearTimeout ? clearTimeout : a;
          } catch (e2) {
            r = a;
          }
        }();
        var c, u = [], l = false, p = -1;
        function d() {
          l && c && (l = false, c.length ? u = c.concat(u) : p = -1, u.length && f());
        }
        function f() {
          if (!l) {
            var e2 = s(d);
            l = true;
            for (var t2 = u.length; t2; ) {
              for (c = u, u = []; ++p < t2; ) c && c[p].run();
              p = -1, t2 = u.length;
            }
            c = null, l = false, function(e3) {
              if (r === clearTimeout) return clearTimeout(e3);
              if ((r === a || !r) && clearTimeout) return r = clearTimeout, clearTimeout(e3);
              try {
                r(e3);
              } catch (t3) {
                try {
                  return r.call(null, e3);
                } catch (t4) {
                  return r.call(this, e3);
                }
              }
            }(e2);
          }
        }
        function g2(e2, t2) {
          this.fun = e2, this.array = t2;
        }
        function w() {
        }
        o.nextTick = function(e2) {
          var t2 = new Array(arguments.length - 1);
          if (arguments.length > 1) for (var n2 = 1; n2 < arguments.length; n2++) t2[n2 - 1] = arguments[n2];
          u.push(new g2(e2, t2)), 1 !== u.length || l || s(f);
        }, g2.prototype.run = function() {
          this.fun.apply(null, this.array);
        }, o.title = "browser", o.browser = true, o.env = {}, o.argv = [], o.version = "", o.versions = {}, o.on = w, o.addListener = w, o.once = w, o.off = w, o.removeListener = w, o.removeAllListeners = w, o.emit = w, o.prependListener = w, o.prependOnceListener = w, o.listeners = function(e2) {
          return [];
        }, o.binding = function(e2) {
          throw new Error("process.binding is not supported");
        }, o.cwd = function() {
          return "/";
        }, o.chdir = function(e2) {
          throw new Error("process.chdir is not supported");
        }, o.umask = function() {
          return 0;
        };
      }, function(e, t, n) {
        var r = n(1), o = n(12);
        e.exports = function(e2) {
          var t2 = new r(e2);
          return t2.initialize(o), t2;
        };
      }, function(e, t) {
        var n = function(e2) {
          return e2 || "";
        }, r = function(e2) {
          var t2 = Date.now();
          "undefined" != typeof window && window.performance && "function" == typeof window.performance.now && (t2 += performance.now());
          var n2 = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(e3) {
            var n3 = (t2 + 16 * Math.random()) % 16 | 0;
            return t2 = Math.floor(t2 / 16), ("x" === e3 ? n3 : 11 & n3).toString(16);
          });
          return false === e2 ? n2.replace(/-/g, "") : n2;
        }, o = function(e2) {
          return "object" == typeof e2;
        }, i = function(e2) {
          var t2 = {}.toString.call(e2);
          return o(e2) && ("[object Error]" === t2 || "[object Exception]" === t2 || t2 instanceof Error);
        }, a = function(e2) {
          return "[object Array]" === {}.toString.call(e2);
        }, s = function(e2) {
          return "function" == typeof e2;
        }, c = function(e2) {
          return "string" == typeof e2;
        }, u = function(e2) {
          var t2 = +/* @__PURE__ */ new Date();
          return true === e2 && (t2 = Math.floor(t2 / 1e3)), t2;
        }, l = function(e2) {
          if (e2.stack) {
            var t2 = e2.stack.split("\n");
            return t2.shift(), t2.join("\n");
          }
          return "";
        }, p = function(e2) {
          var t2;
          switch (e2) {
            case 1:
              t2 = "jserr";
              break;
            case 2:
              t2 = "api";
              break;
            case 3:
              t2 = "jsfsperf";
              break;
            case 4:
              t2 = "resloadfail";
              break;
            case 5:
              t2 = "flow";
              break;
            case 6:
              t2 = "bkpg";
              break;
            case 7:
              t2 = "harlog";
              break;
            default:
              t2 = "jssdkidx";
          }
          return t2;
        }, d = function() {
          return Math.floor(+/* @__PURE__ */ new Date() / 1e3) + "" + Math.floor(1e4 * Math.random());
        }, f = function(e2) {
          var t2 = [];
          for (var n2 in e2) t2.push(n2 + "=" + e2[n2]);
          return t2.join("&");
        }, g2 = function(e2) {
          return JSON ? JSON.stringify(e2) : e2.toString();
        }, w = function() {
          if ("undefined" != typeof document && document.getElementsByTagName) for (var e2, t2, n2, r2, o2 = document.getElementsByTagName("meta"), i2 = o2.length, a2 = 0; a2 < i2; a2++) "wpk-bid" === (r2 = o2[a2]).name ? e2 = r2.content : "wpk-cid" === r2.name ? t2 = r2.content : "wpk-rel" === r2.name && (n2 = r2.content);
          return { wpkBid: e2 || null, wpkCid: t2 || null, wpkRel: n2 || null };
        }, h = function(e2) {
          return e2 && H() ? o(window) && window.prerenderCommitEvent && o(window.prerenderCommitEvent) && "prerendercommit" === window.prerenderCommitEvent.type : "complete" === document.readyState;
        }, v = function(e2, t2, n2) {
          m(window, n2 ? "wpkpageforeground" : "load", function(r2) {
            n2 && "complete" !== document.readyState ? m(window, "load", e2, t2) : e2.call(this, r2);
          }, t2);
        }, m = function(e2, t2, n2, r2) {
          return e2.addEventListener ? e2.addEventListener(t2, function o2(i2) {
            r2 && e2.removeEventListener(t2, o2, false), n2.call(this, i2);
          }, false) : e2.attachEvent && e2.attachEvent("on" + t2, function o2(i2) {
            r2 && e2.detachEvent("on" + t2, o2), n2.call(this, i2);
          }), this;
        }, y = function(e2, t2, n2) {
          return n2 ? (e2.removeEventListener ? e2.removeEventListener(t2, n2) : e2.detachEvent && e2.detachEvent(t2, n2), this) : this;
        }, _ = function(e2) {
          return !!e2 && (0 !== e2 && (e2 >= 1 || "100%" === e2 || (/^\d+(\.\d+)?%$/.test(e2) ? Math.random() < parseFloat(e2) / 100 : e2 > 0 && e2 < 1 && Math.random() < e2)));
        }, b = "wpk-reporter", x = function(e2, t2) {
          var n2 = [].slice.call(t2);
          e2.apply(this, [b].concat(n2));
        }, E = function(e2) {
          var t2 = "";
          switch (e2.category) {
            case 1:
              t2 = [e2.category, e2.uid, e2.w_url, e2.w_ref, e2.w_msg || "", e2.w_line || "", e2.w_col || ""].join("");
              break;
            case 2:
              t2 = [e2.category, e2.uid, e2.w_res, e2.w_method, e2.w_rc].join("");
              break;
            case 4:
              t2 = [e2.category, e2.uid, e2.w_url, e2.w_ref, e2.w_res, e2.w_type].join("");
          }
          return t2;
        }, S = function(e2, t2) {
          e2 = e2 || false;
          try {
            if ("undefined" != typeof window && window.ucweb && window.ucweb.window || t2) {
              for (var n2 = (t2 || navigator.userAgent).split(" "), r2 = n2.length, o2 = false, i2 = false, a2 = 0; a2 < r2; a2++) if (-1 !== n2[a2].indexOf("UWS/")) {
                var s2 = n2[a2].split("/");
                i2 = k(s2[1], "2.13.2.37");
              } else -1 !== n2[a2].indexOf("AliApp(DingTalk/") && (o2 = true);
              return o2 ? i2 : e2;
            }
          } catch (e3) {
          }
          return false;
        }, k = function(e2, t2) {
          try {
            for (var n2, r2, o2 = e2.split("."), i2 = t2.split("."), a2 = o2.length, s2 = 0; s2 < a2; s2++) if ((n2 = parseInt(o2[s2])) !== (r2 = parseInt(i2[s2]))) return n2 > r2;
            return true;
          } catch (e3) {
          }
          return false;
        }, R = function(e2) {
          try {
            const t2 = "__wpktestingls__";
            return e2().setItem(t2, t2), e2().removeItem(t2), true;
          } catch (e3) {
            return false;
          }
        };
        function T() {
          return localStorage;
        }
        var O = { get: function(e2) {
          if (R(T)) {
            var t2 = T().getItem(e2);
            if (t2) {
              if (t2 = JSON.parse(t2), Date.now() < t2.expireAt) return t2;
              this.rm(e2);
            }
          }
          return null;
        }, set: function(e2, t2) {
          R(T) && e2 && t2 && (t2.expireAt = Date.now() + 18e5, T().setItem(e2, JSON.stringify(t2)));
        }, rm: function(e2) {
          R(T) && T().removeItem(e2);
        } };
        function C() {
          return sessionStorage;
        }
        var K = function() {
          var e2 = r();
          return R(C) && C().setItem("wpkreporter:frmid", e2), e2;
        }, I = function(e2, t2) {
          if (t2) {
            if (1 === t2.length) return e2 === t2[0];
            if (2 === t2.length) {
              var n2 = t2[0], r2 = t2[1];
              return n2 && !r2 ? o2(e2, n2) : n2 && r2 ? o2(e2, n2) && o2(r2, e2) : o2(r2, e2);
            }
            return false;
          }
          return true;
          function o2(e3, t3) {
            var n3 = e3.split("."), r3 = t3.split(".");
            return !(parseInt(n3[0]) < parseInt(r3[0])) && (parseInt(n3[0]) > parseInt(r3[0]) || !(parseInt(n3[1]) < parseInt(r3[1])) && (parseInt(n3[1]) > parseInt(r3[1]) || parseInt(n3[2]) >= parseInt(r3[2])));
          }
        }, j = function(e2, t2, n2, o2, i2) {
          var a2 = "wpkreporter:dynamicConf:" + e2, c2 = O.get(a2);
          if (c2) s(i2) && i2(c2);
          else {
            var l2 = { app: e2, tm: u(true), ud: r(), sver: t2, sign: "c41e43c828c16c16a6eb1c9c1e68e8ce" }, p2 = f(l2);
            !function(e3, t3) {
              if ("undefined" == typeof XMLHttpRequest) t3();
              else {
                var n3 = new XMLHttpRequest();
                n3.onreadystatechange = function() {
                  if (4 === n3.readyState) {
                    var e4;
                    if (200 === n3.status && n3.response) try {
                      var r2 = JSON.parse(n3.response);
                      0 === r2.code && (e4 = r2.config || []);
                    } catch (e5) {
                    }
                    t3(e4);
                  }
                };
                try {
                  n3.open("GET", e3, true), n3.timeout = 3e3, n3.send();
                } catch (e4) {
                }
              }
            }(n2 + "?wpk-header=" + encodeURIComponent(p2), function(e3) {
              if (c2 = {}, void 0 !== e3) {
                for (var n3 = e3.length, r2 = 0; r2 < n3; r2++) {
                  var o3 = e3[r2], u2 = o3.sdkver;
                  if (I(t2, u2)) {
                    if (o3.common && void 0 !== o3.common.sampleRate && (c2.all = o3.common.sampleRate), o3.config) {
                      for (var l3, p3 = o3.config.length, d2 = 0; d2 < p3; d2++) if ((l3 = o3.config[d2]).type) {
                        if (l3.category_rate) for (var f2 in l3.category_rate) c2[l3.type + "@" + f2] = l3.category_rate[f2];
                        l3.sampleRate && (c2[l3.type] = l3.sampleRate);
                      }
                    }
                    break;
                  }
                }
                O.set(a2, c2);
              }
              s(i2) && i2(c2);
            });
          }
        }, A = function(e2, t2, n2) {
          for (var r2, o2 = t2.length, i2 = 0; i2 < o2; i2++) "string" == typeof (r2 = e2[t2[i2]]) ? e2[t2[i2]] = r2.substring(0, n2) : "object" == typeof r2 && (e2[t2[i2]] = String(r2));
        }, L = "undefined" != typeof navigator ? (navigator.userAgent || "").toLowerCase() : "", P = function() {
          return L.indexOf("ucbrowser/") > -1;
        }, q = function() {
          return L.indexOf("quark/") > -1;
        }, N = function() {
          var e2 = false;
          try {
            if ("undefined" != typeof navigator) {
              var t2 = -1 !== navigator.userAgent.indexOf("Alipay"), n2 = -1 !== navigator.userAgent.indexOf("MiniProgram"), r2 = -1 !== navigator.userAgent.indexOf("APXWebView");
              e2 = t2 && (n2 || r2);
            }
          } catch (e3) {
          }
          return e2;
        }, H = function() {
          if ("undefined" != typeof window && null !== window) {
            if (window.ucweb && window.ucweb.window && window.ucweb.window.performance && 3 === window.ucweb.window.performance.pt) return true;
            if (window.compass && window.compass.env && o(window.compass.env)) return window.compass.env.isPrerender;
          }
          return false;
        }, D = function(e2) {
          if (!e2) return 0;
          try {
            return "function" == typeof TextEncoder ? new TextEncoder().encode(e2).length : function(e3) {
              for (var t2 = 0, n2 = 0, r2 = e3.length; n2 < r2; n2++) {
                const r3 = e3.charCodeAt(n2);
                t2 += r3 < 128 ? 1 : r3 < 2048 ? 2 : r3 < 55296 ? 3 : r3 < 56320 ? 4 : 3;
              }
              return t2;
            }(e2);
          } catch (t2) {
            return e2.length;
          }
        };
        e.exports = function(e2) {
          return { noop: n, uuid: r, isError: i, isArray: a, isObject: o, isFunction: s, isString: c, cacheStore: O, getSessionId: K, logger: "undefined" != typeof console && o(console) && e2.debug ? { trace: function() {
            x(console.trace, arguments);
          }, debug: function() {
            x(console.debug, arguments);
          }, log: function() {
            x(console.log, arguments);
          }, info: function() {
            x(console.info, arguments);
          }, warn: function() {
            x(console.warn, arguments);
          }, error: function() {
            x(console.error, arguments);
          } } : { trace: n, debug: n, log: n, info: n, warn: n, error: n }, extend: function(e3) {
            for (var t2 = 1, n2 = arguments.length; t2 < n2; t2++) {
              var r2 = arguments[t2];
              for (var o2 in r2) Object.prototype.hasOwnProperty.call(r2, o2) && (e3[o2] = r2[o2]);
            }
            return e3;
          }, some: function(e3, t2) {
            if (!this.isArray(e3) || !this.isFunction(t2)) return false;
            for (var n2, r2 = e3.length, o2 = 0; o2 < r2; o2++) if (n2 = e3[o2], t2.call(this, n2)) return true;
            return false;
          }, filter: function(e3, t2) {
            var n2 = [];
            try {
              for (var r2 = 0, o2 = e3.length; r2 < o2; r2++) t2.call(this, e3[r2], r2, e3) && n2.push(e3[r2]);
              return n2;
            } catch (e4) {
            }
            return e3;
          }, forEach: function(e3, t2) {
            if (this.isArray(e3) && this.isFunction(t2)) for (var n2, r2 = e3.length, o2 = 0; o2 < r2; o2++) n2 = e3[o2], t2.call(this, n2, o2, e3);
          }, trim: function(e3) {
            if (this.isString(e3)) return e3.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
          }, canReport: _, onListen: m, offListen: y, getMetas: w, timestamp: u, generateSeq: d, categoryToType: p, parseErrorStack: l, objToJsonString: g2, objToQueryString: f, genContentHash: E, isU4HA: S, isUC: P, isQuark: q, cutStr: A, dynamicConf: j, inAlipayMiniAppWebview: N, isCompassPrerender: H, isPageReady: h, onPageReady: v, byteLength: D };
        };
      }, function(e, t) {
        var n = window.history || {}, r = window.document, o = function(e2, t2) {
          var n2;
          window.CustomEvent ? n2 = new CustomEvent(e2, { detail: t2 }) : ((n2 = r.createEvent("HTMLEvents")).initEvent(e2, false, true), n2.detail = t2), window.dispatchEvent(n2);
        }, i = function(e2) {
          return e2 && "string" == typeof e2 ? e2.replace(/^(https?:)?\/\//, "").replace(/\?.*$/, "") : "";
        }, a = function(e2) {
          var t2 = n[e2];
          "function" == typeof t2 && (n[e2] = function(e3, r2, a2) {
            var s = location.href, c = t2.call(n, e3, r2, a2);
            if (!a2 || "string" != typeof a2) return c;
            if (a2 === s) return c;
            try {
              var u = s.split("#"), l = a2.split("#"), p = i(u[0]), d = i(l[0]), f = u[1] && u[1].replace(/^\/?(.*)/, "$1"), g2 = l[1] && l[1].replace(/^\/?(.*)/, "$1");
              p !== d ? o("historystatechange", d) : f !== g2 && o("historystatechange", g2);
            } catch (e4) {
            }
            return c;
          }, n[e2].toString = e2 + "() { [native code] }");
        };
        e.exports = function() {
          a("pushState"), a("replaceState");
        };
      }, function(e, t, n) {
        var r, o, i = n(0), a = i.env, s = i.category, c = function(e2) {
          return "function" == typeof e2;
        }, u = {}, l = function(e2, t2, n2, r2) {
          e2.addEventListener ? e2.addEventListener(t2, n2, r2 || false) : (u["on" + t2] = function() {
            return n2.call(e2, window.event);
          }, e2.attachEvent("on" + t2, u["on" + t2]));
        }, p = function(e2, t2) {
          var n2 = e2.id ? "#" + e2.id : "", r2 = "";
          e2.className && "string" == typeof e2.className && (r2 = "." + e2.className.split(" ").join("."));
          var o2 = e2.tagName.toLowerCase();
          return e2.parentNode && e2.parentNode.tagName && t2 - 1 != 0 ? p(e2.parentNode, t2 - 1) + " > " + o2.toLowerCase() + n2 + r2 : o2 + n2 + r2;
        }, d = function(e2, t2, n2, i2, a2, u2) {
          if (r) try {
            r.call(this, t2, n2, i2, a2, u2);
          } catch (u3) {
          }
          if ("script error." === (t2 || "").toLowerCase()) {
            if (e2.ignoreScriptError || o.ignoreScriptError) return void e2.logger.warn("ignoreScriptError");
            t2 = "Script error", u2 = u2 || {};
          }
          if (!c(o.jsErrFilter) || o.jsErrFilter.call(this, event)) {
            if (null != u2) {
              var l2 = (u2.stack || "").split("\n");
              l2.shift();
              var p2 = { w_msg: t2, w_file: n2 || "", w_line: i2 || "", w_col: a2 || "", stack: l2.join("\n"), category: s.JSERR, sampleRate: o.jsErrSampleRate };
              e2.report(p2);
            }
          } else e2.logger.warn("jserrFilter false, event: ", event);
        }, f = function(e2, t2) {
          var n2 = window;
          n2 && e2.env === a.BROWSER ? (e2.logger.info("wpkglobalerrorPlugin"), false !== (o = e2.toolKit.extend({ jsErrSampleRate: 1, resErrSampleRate: 1 }, t2)).jsErr ? (r = n2.onerror, n2.onerror = function(t3, n3, r2, o2, i2) {
            d(e2, t3, n3, r2, o2, i2);
          }, l(n2, "unhandledrejection", function(t3) {
            var n3 = t3.type;
            "string" == typeof t3.reason ? n3 = t3.reason : t3.reason && "object" == typeof t3.reason && t3.reason.message && (n3 = t3.reason.message), d(e2, n3, null, null, null, t3.reason || t3.type);
          })) : e2.logger.warn("js"), o.resErr ? l(n2, "error", function(t3) {
            !function(e3, t4) {
              if (!t4.target.tagName || t4.message || t4.filename || t4.lineno || t4.colno) e3.logger.warn(", event: ", t4);
              else if (!c(o.resErrFilter) || o.resErrFilter.call(this, t4)) {
                var n3 = t4.target.src || t4.target.href;
                n3 === window.location.href && (n3 = "EMPTY_SRC");
                var r2, i2 = function(e4) {
                  var t5 = -1;
                  switch (e4.tagName.toLowerCase()) {
                    case "img":
                      t5 = 1;
                      break;
                    case "link":
                      e4.rel && "stylesheet" === e4.rel.toLowerCase() && (t5 = 2);
                      break;
                    case "script":
                      t5 = 3;
                      break;
                    case "video":
                      t5 = 11;
                  }
                  return t5;
                }(t4.target);
                11 === i2 && t4.target.error && (r2 = t4.target.error.code), e3.report({ category: s.RESLOADFAIL, sampleRate: o.resErrSampleRate, msg: n3 + " ", w_res: n3, w_type: i2, w_err: r2, w_xpath: p(t4.target, 5) });
              } else e3.logger.warn("reserrFilter false, event: ", t4);
            }(e2, t3);
          }, true) : e2.logger.warn("")) : e2.logger.warn("");
        };
        f.prototype.pluginId = "gerror", e.exports = f;
      }, function(e, t, n) {
        var r = n(0), o = r.sdk, i = r.http.methods, a = r.category, s = function(e2) {
          return e2 >= 200 && e2 <= 299;
        }, c = function(e2) {
          return -1 === e2.indexOf("//arms-retcode") && -1 === e2.indexOf("//retcode.taobao.com") && -1 === e2.indexOf("aliyuncs.com/r.png") && -1 === e2.indexOf("//mdap.alipay.com/loggw") && -1 === e2.indexOf("//wpk-gateway") && -1 === e2.indexOf("//px.wpk.quark.cn") && -1 === e2.indexOf("//px.ucweb.com") && -1 === e2.indexOf("//px.effirst.com") && -1 === e2.indexOf("//px-intl.ucweb.com") && -1 === e2.indexOf("//gm.mmstat.com/arms.1.1") && -1 === e2.indexOf("//gm.mmstat.com/arms.1.2") && -1 === e2.indexOf("//g.alicdn.com/alilog") && -1 === e2.indexOf("//log.m.sm.cn/0.gif");
        }, u = function(e2, t2) {
          if (e2.hasOwnProperty(t2)) return e2[t2];
        }, l = function(e2, t2, n2) {
          e2.toolKit.isObject(n2) && e2.toolKit.extend(t2, { c1: u(n2, "c1"), c2: u(n2, "c2"), c3: u(n2, "c3"), c4: u(n2, "c4"), c5: u(n2, "c5"), bl1: u(n2, "bl1"), bl2: u(n2, "bl2"), bl3: u(n2, "bl3"), bl4: u(n2, "bl4"), bl5: u(n2, "bl5") }), e2.report(t2);
        }, p = location.origin, d = function(e2) {
          return !e2 || (0 === e2.indexOf(p) || !/^(\/\/|http:|https:).*/.test(e2));
        };
        function f(e2, t2) {
          var n2 = null;
          try {
            var r2, o2, i2, a2 = e2.toolKit.trim(t2 || "").split(/[\r\n]+/);
            if (a2.length > 0) n2 = {}, e2.toolKit.forEach(a2, function(e3) {
              r2 = e3.split(": "), o2 = r2.shift(), i2 = r2.join(": "), n2[o2] = i2;
            });
          } catch (e3) {
          }
          return n2;
        }
        function g2(e2) {
          try {
            if (!e2) return {};
            var t2 = {};
            return e2.forEach(function(e3, n2) {
              t2[n2] = e3;
            }), t2;
          } catch (e3) {
            return {};
          }
        }
        var w = function(e2, t2) {
          if (e2.env === r.env.BROWSER && window) {
            var n2 = { enable: true, sampleRate: 1, enableTrace: false, enableCorsTrace: function(e3) {
              return false;
            }, requestHeaders: { "x-wpk-reqid": function() {
              return e2.toolKit.uuid(false);
            }, "x-wpk-bid": function() {
              return e2.bid;
            } }, responseHeaders: ["x-eagleeye-id", "x-wpk-serverid"] }, u2 = e2.toolKit.extend(n2, t2);
            u2.enable ? (e2.logger.info("wpkinterfacePlugin"), "XMLHttpRequest" in window && function(e3, t3) {
              var n3 = window.XMLHttpRequest.prototype, r2 = n3.open;
              n3.open = function(n4, o2) {
                this.__reqCtx__ = { method: n4, url: o2 || "", start: Date.now() };
                var i2 = [].slice.call(arguments);
                r2.apply(this, i2);
                var a2 = this;
                t3.enableTrace && (d(o2) || t3.enableCorsTrace(o2)) && e3.toolKit.forEach(Object.getOwnPropertyNames(t3.requestHeaders), function(e4) {
                  var n5 = t3.requestHeaders[e4]();
                  a2.setRequestHeader(e4, n5);
                });
              };
              var u3 = n3.setRequestHeader;
              n3.setRequestHeader = function(e4, t4) {
                var n4 = [].slice.call(arguments);
                u3.apply(this, n4), this.__reqCtx__ && (this.__reqCtx__.headers || (this.__reqCtx__.headers = {}), this.__reqCtx__.headers[e4] = t4);
              };
              var p2 = n3.send;
              n3.send = function(n4) {
                var r3 = this;
                function u4() {
                  if (r3.__reqCtx__ && 4 === r3.readyState) try {
                    var u5 = Date.now(), p3 = (r3.responseURL || r3.__reqCtx__.url).split("?"), d3 = p3[0], g4 = p3[1] || "", w2 = "", h = r3.__reqCtx__.headers || {};
                    r3.__reqCtx__.method.toUpperCase() !== i.GET && n4 && (w2 = JSON.stringify(n4));
                    var v = f(e3, r3.getAllResponseHeaders()), m = String(r3.response), y = true, _ = {};
                    "function" == typeof t3.errorFilter && (y = !!(_ = t3.errorFilter.call(this, { url: d3, status: r3.status, response: m, body: w2, queryString: g4, reqHeaders: h, resHeaders: v })), e3.logger.warn("api errorFilter", _)), m.length > 2048 && (m = "[response content too large]");
                    var b = u5 - r3.__reqCtx__.start;
                    if (y && b < 121e3 && c(d3)) {
                      var x = _.bizCode || r3.status, E = _.reqHeaders || h, S = _.resHeaders || v, k = { category: a.API, sampleRate: t3.sampleRate, w_res: d3, w_param: g4, w_body: s(x) || !t3.withBody ? "" : w2, w_method: r3.__reqCtx__.method, w_rc: x, w_rt: b, w_resp: s(x) || !t3.withResp ? "" : _.resp || m, w_hd: JSON.stringify(E), w_trace_reqid: E && E["x-wpk-reqid"] || void 0, w_rshd: JSON.stringify(S), w_trace_serverid: S && S["x-wpk-serverid"] || void 0, msg: _.msg || "", w_type: 16 };
                      l(e3, k, _);
                    }
                  } catch (t4) {
                    e3.reportError(t4, { bid: o.BID, cid: o.CID, category: a.JSERR, sampleRate: 1 });
                  }
                }
                if ("onreadystatechange" in r3 && "function" == typeof r3.onreadystatechange) {
                  var d2 = r3.onreadystatechange;
                  r3.onreadystatechange = function() {
                    var e4 = [].slice.call(arguments);
                    u4.apply(this, e4), d2.apply(this, e4);
                  };
                } else r3.onreadystatechange = u4;
                var g3 = [].slice.call(arguments);
                return p2.apply(this, g3);
              };
            }(e2, u2), "fetch" in window && function(e3, t3) {
              var n3 = function(e4) {
                var t4 = (e4 || "").split("?");
                return { apiAddr: t4[0], queryString: t4.length > 1 && t4[1] || "" };
              }, r2 = function(n4, r3, o2, i2, c2, u4, l2, p3, d2, f2, g3) {
                var w2 = e3.toolKit.isObject(p3) ? p3 : {}, h = w2.reqHeaders || u4, v = w2.resHeaders || l2;
                return { w_res: n4, w_param: r3, w_method: o2, w_rc: c2, w_rt: i2, w_hd: JSON.stringify(h), w_trace_reqid: h && h["x-wpk-reqid"] || void 0, w_rshd: JSON.stringify(v), w_trace_serverid: v && v["x-wpk-serverid"] || void 0, msg: w2.msg || d2 || "", w_body: s(c2) || !t3.withBody ? "" : f2, w_resp: s(c2) || !t3.withResp ? "" : w2.resp || g3 || "", category: a.API, sampleRate: t3.sampleRate, w_type: 17 };
              }, u3 = function(n4, r3, o2, i2, a2, s2, c2) {
                var u4 = {};
                return "function" == typeof t3.errorFilter && (u4 = t3.errorFilter.call(this, { url: n4, queryString: r3, status: o2, body: i2, response: a2, reqHeaders: s2, resHeaders: c2 }), e3.logger.warn("api errorFilter", u4)), u4;
              }, p2 = window.fetch;
              window.fetch = function() {
                var s2 = [].slice.call(arguments), f2 = i.GET;
                s2[1] && s2[1].method && (f2 = s2[1].method.toUpperCase());
                var w2, h = s2[0];
                w2 = "string" == typeof h ? h : h instanceof URL ? h.toString() : h.url || "", t3.enableTrace && (d(w2) || t3.enableCorsTrace(w2)) && (s2[1] ? void 0 === s2[1].headers && (s2[1].headers = {}) : s2[1] = { headers: {} }, e3.toolKit.forEach(Object.getOwnPropertyNames(t3.requestHeaders), function(e4) {
                  s2[1].headers[e4] = t3.requestHeaders[e4]();
                }));
                var v = Date.now(), m = "", y = null;
                return s2[1] && (y = s2[1].headers), f2 !== i.GET && s2[1] && s2[1].body && (m = JSON.stringify(s2[1].body)), p2.apply(this, s2).then(function(t4) {
                  try {
                    var i2 = Date.now(), p3 = n3(t4.url || s2[0]), d2 = p3.apiAddr, w3 = p3.queryString, h2 = t4.clone(), _ = g2(h2.headers);
                    h2.text().then(function(n4) {
                      n4 = n4 || "";
                      var o2 = u3.call(this, d2, w3, t4.status, m, n4, y, _), a2 = !!o2;
                      n4 = n4.length > 2048 ? "[response content too large]" : n4;
                      var s3 = i2 - v;
                      if (a2 && s3 < 121e3 && c(d2)) {
                        var p4 = o2.bizCode || t4.status, g3 = r2(d2, w3, f2, s3, p4, y, _, o2, void 0, m, n4);
                        l(e3, g3, o2);
                      }
                    });
                  } catch (t5) {
                    e3.reportError(t5, { bid: o.BID, cid: o.CID, category: a.JSERR, sampleRate: 1 });
                  }
                  return t4;
                }).catch(function(t4) {
                  var o2 = n3(s2[0]), i2 = o2.apiAddr, a2 = o2.queryString, p3 = u3.call(this, i2, a2, -1, m, "", y, {}), d2 = !!p3, g3 = Date.now() - v;
                  if (d2 && g3 < 121e3 && c(i2)) {
                    var w3 = p3.bizCode || -1, h2 = r2(i2, a2, f2, g3, w3, y, {}, p3, t4.message, m, void 0);
                    l(e3, h2, p3);
                  }
                  throw t4;
                });
              };
            }(e2, u2), (e2.enableMtop || u2.enableMtop) && (e2.logger.info("use mtop"), function(e3, t3) {
              window && window.lib.mtop && window.lib.mtop.middlewares && window.lib.mtop.middlewares.push(function(n3) {
                var r2 = this.params, i2 = this.options, u3 = Date.now();
                return n3().then(function() {
                  try {
                    if (i2.H5Request && (i2.getJSON || i2.postJSON)) return void e3.logger.debug("xhr, apixhr");
                    var n4, p2 = i2.retJson || {}, d2 = Date.now() - u3, f2 = p2.code || 200, g3 = r2.type, w2 = r2.api, h = e3.toolKit.objToQueryString(i2.querystring), v = i2.postdata && i2.postdata.data ? e3.toolKit.objToJsonString(i2.postdata.data) : null, m = e3.toolKit.objToJsonString(p2.data || {}), y = p2.ret;
                    y instanceof Array && (y = y.join(",")), -1 === y.indexOf("SUCCESS") && (n4 = y);
                    var _ = true, b = {};
                    if ("function" == typeof t3.errorFilter && (_ = !!(b = t3.errorFilter.call(this, { url: w2, status: f2, response: m, body: v, queryString: h, msg: n4 })), e3.logger.warn("api errorFilter", b)), _ && d2 < 121e3 && c(w2)) {
                      var x = b.bizCode || f2, E = { category: a.API, sampleRate: t3.sampleRate, w_res: w2, w_param: h, w_body: s(x) || !t3.withBody ? "" : v, w_method: g3, w_rc: x, w_rt: d2, w_resp: s(x) || !t3.withResp ? "" : b.resp || m, msg: b.msg || n4 || "", w_type: 100 };
                      l(e3, E, b);
                    }
                  } catch (t4) {
                    e3.reportError(t4, { bid: o.BID, cid: o.CID, category: a.JSERR, sampleRate: 1 });
                  }
                });
              });
            }(e2, u2))) : e2.logger.info("wpkinterfacePlugin");
          }
        };
        w.prototype.pluginId = "api", e.exports = w;
      }, function(e, t, n) {
        var r, o = n(0).env, i = n(0).category, a = ["navigationStart", "unloadEventStart", "unloadEventEnd", "redirectStart", "redirectEnd", "fetchStart", "domainLookupStart", "domainLookupEnd", "connectStart", "secureConnectionStart", "connectEnd", "requestStart", "responseStart", "responseEnd", "domLoading", "domInteractive", "domContentLoadedEventStart", "domContentLoadedEventEnd", "domComplete", "loadEventStart", "loadEventEnd", "msFirstPaint"], s = ["navigate", "reload", "back_forward"], c = function(e2) {
          var t2, n2;
          if (r && r.getEntriesByType) try {
            for (var o2 = r.getEntriesByType("paint"), i2 = 0; i2 < o2.length; i2++) {
              var s2 = o2[i2];
              "first-paint" === s2.name ? t2 = parseFloat(s2.startTime.toFixed(2)) : "first-contentful-paint" === s2.name && (n2 = parseFloat(s2.startTime.toFixed(2)));
            }
          } catch (e3) {
            console.error(e3);
          }
          var c2 = e2[a[13]] - e2[a[5]];
          return { w_n_rve: c2 ? parseFloat(c2.toFixed(2)) : c2, fpt: t2, fcp: n2 };
        }, u = function(e2, t2) {
          var n2, r2, o2, i2 = {}, s2 = e2._ver || 1;
          for (var c2 in t2) {
            o2 = 0, n2 = e2[a[t2[c2][0]]], r2 = e2[a[t2[c2][1]]], (2 === s2 ? n2 >= 0 : n2 > 0) && r2 > 0 && (o2 = parseFloat((r2 - n2).toFixed(2))), i2[c2] = o2;
          }
          return i2;
        }, l = function(e2, t2) {
          var n2 = window;
          if (r = n2.performance || n2.webkitPerformance || n2.msPerformance || n2.mozPerformance, e2.env === o.BROWSER && r && r.timing) {
            t2 = t2 || {};
            var a2 = e2.toolKit.extend({ enable: true, sampleRate: 1, collectResTiming: false, minLoadTiming: 3e3, maxLoadTiming: 8e3, minLoadSpr: 0.05, maxLoadSpr: 1 }, t2);
            if (a2.enable) {
              e2.logger.info("wpkperformancePlugin");
              var l2 = r.timing || {}, p = 1;
              if ("function" == typeof n2.PerformanceNavigationTiming) try {
                var d = r.getEntriesByType("navigation")[0];
                d && (l2 = d, p = 2);
              } catch (e3) {
              }
              l2._ver = p;
              var f = function() {
                /loaded|complete/.test(document.readyState) && setTimeout(function() {
                  var t3 = e2.toolKit.extend(function(e3) {
                    return u(e3, { w_unload: [1, 2], w_redirect: [3, 4], w_appcache: [5, 6], w_dns: [6, 7], w_tcp: [8, 10], w_ssl: [9, 10], w_ttfb: [11, 12], w_contentdownload: [12, 13], w_domparsing: [13, 15], w_res: [17, 19] });
                  }(l2), function(e3) {
                    var t4 = u(e3, { w_firstbyte: [5, 12], w_tti: [5, 15], w_domready: [5, 17], w_load: [5, 19], w_total: [5, 20] }), n4 = c(e3);
                    return t4.w_n_rve = n4.w_n_rve, t4.wl_fcp = n4.fcp, t4.wl_fp = n4.fpt, t4;
                  }(l2));
                  for (var n3 in t3) if (t3[n3] < 0 || t3[n3] > 6e4) return void e2.logger.warn("", n3, t3[n3]);
                  var o2 = e2.toolKit.extend(t3, function(e3) {
                    var t4, n4 = r.navigation || {}, o3 = -1, i2 = -1, a3 = -1;
                    return 1 === e3._ver ? t4 = s[n4.type] || "other" : 2 === e3._ver && (o3 = e3.encodedBodySize, i2 = e3.decodedBodySize, a3 = e3.transferSize, t4 = e3.type), { w_enbdsize: o3, w_debdsize: i2, w_transize: a3, w_navtype: t4 };
                  }(l2), a2, { category: i.JSFSPERF });
                  if (e2.report(o2), (a2.collectResTiming || e2.toolKit.isQuark() || e2.toolKit.isUC()) && !e2._hasCollectResTiming) {
                    e2.logger.info("resource");
                    var p2 = 0;
                    t3.w_load >= a2.minLoadTiming && t3.w_load <= a2.maxLoadTiming ? p2 = a2.minLoadSpr : t3.w_load > a2.maxLoadTiming && (p2 = a2.maxLoadSpr), p2 && r && "function" == typeof r.getEntriesByType && (e2.report({ category: i.RESTIMING, sampleRate: p2, bl1: JSON.stringify(r.getEntriesByType("resource")), bl2: r.timeOrigin || r.timing.fetchStart, _forcePost: true }), e2._hasCollectResTiming = true);
                  }
                });
              };
              e2.toolKit.isPageReady(e2.prerender) ? f() : e2.toolKit.onPageReady(f, true, e2.prerender);
            } else e2.logger.info("wpkperformancePlugin");
          } else e2.logger.warn("");
        };
        l.prototype.pluginId = "perf", e.exports = l;
      }, function(e, t, n) {
        var r = n(0).env, o = function(e2, t2) {
          if (t2 = t2 || {}, -1 !== [r.BROWSER, r.WEEX].indexOf(e2.env) && t2.params && "string" == typeof t2.params) {
            e2.logger.info("wpkucparamPlugin");
            for (var n2 = t2.params, o2 = ["pr", "ve", "os", "fr", "nw", "ut", "sv"], i = 0; i < 5; i++) {
              var a = o2[i];
              -1 === n2.indexOf(a) && (n2 += a);
            }
            try {
              "undefined" != typeof ucapi && "function" == typeof ucapi.invoke && (e2.uc_param_str = n2, ucapi.invoke("biz.ucparams", { params: n2, success: function(t3) {
                e2.uc_param = t3 || "", e2.uc_param_str = "";
              }, fail: function(t3) {
                e2.logger.error("get uc_param_str error: ", t3);
              } }));
            } catch (t3) {
              e2.logger.error("get uc_param_str error: ", t3), e2.uc_param_str = n2;
            }
          }
        };
        o.prototype.pluginId = "ucparam", e.exports = o;
      }, function(e, t, n) {
        var r = n(0), o = "undefined" != typeof weex ? weex : {}, i = function() {
          var e2 = { wx_pf: WXEnvironment.platform, wx_ver: WXEnvironment.weexVersion, wx_app: WXEnvironment.appName, wx_app_ver: WXEnvironment.appVersion, wx_os: WXEnvironment.osName, wx_os_ver: WXEnvironment.osVersion, wx_dev_md: WXEnvironment.deviceModel, dsp_w: WXEnvironment.deviceWidth, dsp_h: WXEnvironment.deviceHeight };
          if (void 0 !== weex.config.uc) try {
            var t2 = JSON.parse(weex.config.uc.ucParams);
            e2.net = t2.nw, e2.wx_app = t2.pr, e2.wx_app_ver = t2.ve;
          } catch (e3) {
          }
          return "undefined" != typeof weex && weex.config && weex.config.bundleType && "Vue" !== weex.config.bundleType && "vue" !== weex.config.bundleType ? ("undefined" != typeof location ? e2.wx_bdl_url = location.href : e2.wx_bdl_url = "undefined" != typeof weex && weex.config ? weex.config.bundleUrl : "unknow", e2.wx_bdl_type = "Rax") : (e2.wx_bdl_url = weex.config.bundleUrl, e2.wx_bdl_type = "Vue"), e2.wx_bdl_name = function(e3) {
            try {
              var t3 = e3.substring(e3.lastIndexOf("/") + 1);
              return -1 === t3.lastIndexOf(".") ? t3 : t3.substring(0, t3.lastIndexOf("."));
            } catch (e4) {
              return "";
            }
          }(e2.wx_bdl_url), e2;
        };
        e.exports = { env: r.env.WEEX, root: o, isHttps: false, send: function(e2, t2, n2) {
          var r2 = this.toolKit.extend(i(), n2, { w_frmid: this._sid });
          r2.fr = r2.wx_os, r2.rom = r2.wx_os_ver, r2.brand = r2.wx_dev_md, r2.model = r2.wx_dev_md, r2.browser = r2.wx_app, r2.bver = r2.wx_app_ver, r2.w_url = r2.wx_bdl_name, r2.w_send_mode = "weexfetch";
          var o2 = encodeURIComponent(t2), a = encodeURIComponent(this.toolKit.objToJsonString(r2));
          weex.requireModule("stream").fetch({ url: e2, method: "POST", headers: { "wpk-header": o2 }, body: a }, function(e3, t3) {
          });
        }, getWid: function() {
          return this.toolKit.uuid();
        }, bindUnloadEvent: function() {
        } };
      }, function(e, t, n) {
        var r = n(1), o = n(14);
        e.exports = function(e2) {
          var t2 = new r(e2);
          return t2.initialize(o), t2;
        };
      }, function(e, t, n) {
        (function(t2) {
          var r = n(0), o = t2;
          e.exports = { env: r.env.NODEJS, root: o, send: function(e2, t3, n2) {
          } };
        }).call(this, n(15));
      }, function(e, t) {
        var n;
        n = /* @__PURE__ */ function() {
          return this;
        }();
        try {
          n = n || new Function("return this")();
        } catch (e2) {
          "object" == typeof window && (n = window);
        }
        e.exports = n;
      }, function(e, t, n) {
        var r = n(1), o = n(17);
        e.exports = function(e2) {
          var t2 = new r(e2);
          return t2.initialize(o), t2;
        };
      }, function(e, t, n) {
        var r, o = n(0), i = "undefined" != typeof window ? window : "undefined" != typeof self ? self : {}, a = i.document, s = i.navigator, c = i.location, u = void 0 !== i.devicePixelRatio ? i.devicePixelRatio : 1, l = {}, p = null, d = null, f = function(e2, t2, n2, r2, o2) {
          if (void 0 === t2) {
            var i2, s2;
            if (!l[e2]) {
              i2 = new RegExp(e2 + "=([^;]+)");
              try {
                s2 = i2.exec(a.cookie);
              } catch (e3) {
                return null;
              }
              s2 && (l[e2] = s2[1]);
            }
            return l[e2];
          }
          var c2 = e2 + "=" + t2;
          n2 && (c2 += "; max-age=" + n2);
          try {
            return a.cookie = c2, !!a.cookie;
          } catch (e3) {
            return false;
          }
        }, g2 = function(e2, t2) {
          !function(e3, t3, n2, r2) {
            void 0 !== window.ucapi && "function" == typeof window.ucapi.invoke ? (t3 && (t3.success = n2, t3.fail = r2), window.ucapi.invoke(e3, t3)) : r2 && r2("ucapi is not exist");
          }("webMonitor.reportWpkLog", e2, function(e3) {
            t2.logger.warn("log reported success by jsapi", e3);
          }, function(e3) {
            t2.logger.warn("log report failed by jsapi", e3);
          });
        }, w = function(e2) {
          var t2 = window, n2 = "wpkimgreporter_" + +/* @__PURE__ */ new Date() + ".r" + Math.floor(1e3 * Math.random()), r2 = t2[n2] = new Image();
          r2.onload = r2.onerror = function() {
            t2[n2] = null;
          }, r2.src = e2;
        }, h = function(e2, t2, n2) {
          if ("function" == typeof XMLHttpRequest) {
            var r2 = new XMLHttpRequest();
            r2.open("POST", e2, true), r2.setRequestHeader("Content-Type", "text/plain"), r2.timeout = 5e3, r2.send(t2);
          } else n2.logger.info("xhr is not supported");
        }, v = function(e2, t2, n2) {
          s.sendBeacon(e2, t2) || (n2.logger.info("beacon send fail, retry by xhr"), h(e2, t2, n2));
        }, m = function(e2) {
          var t2, n2 = e2._waitingQueue;
          if (e2.checkHidden && a && a.hidden) return e2.logger.warn(": ", n2), void (e2._waitingQueue = []);
          null === p && (t2 = (navigator ? navigator.userAgent : "").toLowerCase(), p = t2.indexOf("windvane") > -1 && /(iphone|ipad|ipod|ios)/i.test(t2)), null === d && (d = e2.useNativeCH && function(e3) {
            try {
              return "undefined" != typeof window && void 0 !== window.nativeWpkReport && 1 === (window.nativeWpkReport || {})[e3];
            } catch (e4) {
              return false;
            }
          }("enablePerformanceReport"));
          var r2 = s && s.sendBeacon && i.Blob, o2 = e2.supportBeaconBody && !p;
          if (d) {
            for (var c2 = 0; c2 < n2.length; c2++) try {
              var u2 = n2[c2];
              u2.w_send_mode = "jsapi", u2._servAddr = void 0, u2._hash = void 0, g2({ type: u2.type, immediate: "jsfsperf" === u2.type ? 0 : 1, args: u2 }, e2);
            } catch (e3) {
            }
            e2._waitingQueue = [];
          } else if (r2 && o2) {
            var l2, f2, m2 = function(e3) {
              for (var t3, n3, r3 = [], o3 = [], i2 = e3.length, a2 = 0; a2 < i2; a2++) n3 = e3[a2].category, -1 === o3.indexOf(n3) && o3.push(n3);
              t3 = o3.length;
              for (var s2 = 0; s2 < t3; s2++) {
                n3 = o3[s2];
                for (var c3 = [], u3 = 0; u3 < i2; u3++) {
                  var l3 = e3[u3];
                  l3.category === n3 && c3.push(l3);
                }
                r3[s2] = c3;
              }
              return r3;
            }(n2), y2 = m2.length;
            try {
              for (var _2, b2 = 0; b2 < y2; b2++) {
                f2 = (l2 = m2[b2]).length;
                for (var x = 0, E = [], S = 0; S < f2; S++) {
                  _2 = l2[S]._servAddr, l2[S].w_send_mode = "sendbeacon", l2[S]._servAddr = void 0, l2[S]._hash = void 0, l2[S] = e2.toolKit.objToJsonString(l2[S]);
                  var k = encodeURIComponent(l2[S]), R = e2.toolKit.byteLength(k);
                  R > 6e4 ? (e2.logger.info("single log oversize 60k, send by xhr"), h(_2, k, e2)) : ((x += R) > 6e4 && (e2.logger.info("group log length is " + x + " oversize 60k, send now"), v(_2, encodeURIComponent(E.join("\n")), e2), E.splice(0, E.length), x = R), E.push(l2[S]));
                }
                E.length > 0 && v(_2, encodeURIComponent(E.join("\n")), e2);
              }
              e2._waitingQueue = [];
            } catch (e3) {
            }
          } else {
            for (var T, O, C, K = 0; K < n2.length; K++) {
              O = (T = n2[K])._servAddr, C = T._forcePost, T.w_send_mode = C ? "fetch" : r2 ? "sendbeacon" : "imgsrc", T._servAddr = void 0, T._hash = void 0, T._forcePost = void 0, T = encodeURIComponent(e2.toolKit.objToJsonString(T));
              var I = e2.toolKit.byteLength(T);
              I > 7500 && (C = true, e2.logger.info("log len " + I + " oversize 7.5k, force post"));
              try {
                true === C ? (e2.logger.info("force post, send by xhr"), h(O, T, e2)) : r2 ? s.sendBeacon(O + "&data=" + T) : w(O + "&data=" + T);
              } catch (e3) {
              }
            }
            e2._waitingQueue = [];
          }
        }, y = null, _ = function(e2) {
          clearTimeout(y), y = null, m(e2);
        }, b = function(e2) {
          _(e2);
        };
        e.exports = { env: o.env.BROWSER, root: i, isHttps: c.protocol === o.http.protocols.HTTPS, send: function(e2, t2, n2) {
          var r2 = this;
          if (!r2.ignoreU4HA && r2.toolKit.isU4HA(r2.onlyCustom) && n2.category < 100 && (2 !== n2.category || 100 !== n2.w_type)) r2.logger.warn("u4");
          else if (r2.toolKit.inAlipayMiniAppWebview() && true === r2.blockAlipayMiniAppWebview) r2.logger.warn("current runtime is alipay miniapp webview, this request will be blocked.");
          else {
            var l2 = r2.toolKit.extend(function(e3) {
              if (!a) return {};
              var t3, n3 = a.referrer;
              return n3 && -1 !== n3.indexOf('"') && (n3 = encodeURIComponent(a.referrer)), { w_url: c.origin + c.pathname, w_query: c.search, w_ref: c.hash.substring(1), w_title: a.title, ua: s.userAgent, referrer: n3, dsp_dpi: u || 1, dsp_w: i.screen.width, dsp_h: i.screen.height, net: (t3 = s.connection, t3 && t3.type ? t3.type === o.navConn.types.NONE ? "disconnected" : t3.type === o.navConn.types.CELLULAR ? t3.effectiveType === o.navConn.effectiveTypes.SLOW2G ? "2g" : t3.effectiveType : t3.type : "") };
            }(r2.spa), n2, { w_frmid: r2._sid });
            if (r2.logger.warn("logData to send: ", e2, l2), e2 += "?wpk-header=" + encodeURIComponent(t2), r2.uc_param_str && (e2 += "&uc_param_str=" + r2.uc_param_str), true === n2._diagnose) return l2 = encodeURIComponent(r2.toolKit.objToJsonString(l2)), void window.open(e2 + "&data=" + l2);
            l2._servAddr = e2, l2._hash = r2.toolKit.genContentHash(l2);
            var p2, d2, f2 = r2.delay && -1 !== [1, 2, 4].indexOf(l2.category);
            if (function(e3, t3) {
              var n3 = e3._waitingQueue, r3 = n3.length, o2 = t3.reduplication || e3.reduplication || true, i2 = true;
              if (1 === t3.category && o2 && 0 !== r3) {
                for (var a2, s2 = 0; s2 < r3; s2++) if ((a2 = n3[s2])._hash === t3._hash) {
                  a2.w_cnt++, i2 = false;
                  break;
                }
                i2 && n3.push(t3);
              } else n3.push(t3);
              return i2;
            }(r2, l2) || !f2) p2 = function() {
              _(r2);
            }, y = -1 === (d2 = f2 ? 3e3 : -1) ? (p2(), null) : setTimeout(p2, d2 || 0);
            else r2.logger.warn("logData: ", l2);
          }
        }, getWid: function() {
          var e2;
          return this.disableCookie ? (f(o.sdk.WID_KEY) && f(o.sdk.WID_KEY, "", -1), f(o.sdk.WID_KEY2) && f(o.sdk.WID_KEY2, "", -1), e2 = r) : e2 = f(o.sdk.WID_KEY), e2 || (e2 = this.toolKit.uuid(), this.disableCookie ? r = e2 : f(o.sdk.WID_KEY, e2, 15552e3)), e2;
        }, bindUnloadEvent: function(e2) {
          window && (window.addEventListener ? window.addEventListener("beforeunload", function(t2) {
            b(e2);
          }, false) : window.attachEvent && window.attachEvent("onbeforeunload", function(t2) {
            b(e2);
          }));
        } };
      }]);
    });
  })(wpkReporter$1);
  var wpkReporterExports = wpkReporter$1.exports;
  const wpkReporter = /* @__PURE__ */ getDefaultExportFromCjs(wpkReporterExports);
  const version = "4.0.1";
  const pkg = {
    version
  };
  var __wpk;
  const Reporter = {
    /**
     * sdk
     */
    install: function install() {
      var cookieInfo = getFromCookie();
      var cna = cookieInfo.cna;
      __wpk = new wpkReporter({
        bid: "dataphant-js-sdk",
        // 
        uid: cna,
        rel: pkg.version,
        plugins: []
      });
      __wpk.install();
    },
    /**
     * 
     * @param data 
     * @param instance 
     */
    report: function report(data) {
      var cookieInfo = getFromCookie();
      var loginId = cookieInfo.loginId, aliId = cookieInfo.aliId, cna = cookieInfo.cna;
      var _ref = data, category = _ref.category, msg = _ref.msg, w_succ = _ref.w_succ, resInfo = _ref.resInfo, userInfo = _ref.userInfo;
      var _ref2 = resInfo, appName = _ref2.appName, testKey = _ref2.testKey, expVer = _ref2.expVer, segmentID = _ref2.segmentID, bucketName = _ref2.bucketName, sdkVer = _ref2.sdkVer;
      var params = {
        category: category || 100,
        // 
        msg,
        // msgtop
        w_succ,
        // ,10
        c1: testKey,
        // c1  
        c2: sdkVer,
        // c2  SDK
        c3: loginId,
        // c3  loginId
        c4: aliId,
        // c4  aliId
        c5: cna,
        // c5  cookie_id
        c6: appName,
        // c6  
        c7: expVer,
        // c7  
        c8: segmentID,
        // c8  Segment_ID
        c9: bucketName,
        // c9  
        bl1: JSON.stringify(resInfo),
        // bl1  
        bl2: JSON.stringify(userInfo),
        // bl1  
        bl3: JSON.stringify(cookieInfo)
        // bl1  cookie
      };
      __wpk && __wpk.report(params);
    }
  };
  var KEY_TYPE = /* @__PURE__ */ function(KEY_TYPE2) {
    KEY_TYPE2["BUYER_ID"] = "buyerId";
    KEY_TYPE2["SELLER_ID"] = "sellerId";
    KEY_TYPE2["BUYER_ALI_ID"] = "buyerAliId";
    KEY_TYPE2["SELLER_ALI_ID"] = "sellerAliId";
    KEY_TYPE2["DEVICE_ID"] = "deviceId";
    KEY_TYPE2["COOKIE_ID"] = "cookieId";
    KEY_TYPE2["SALE_ID"] = "saleId";
    KEY_TYPE2["REQUEST_ID"] = "requestId";
    KEY_TYPE2["USER_ID"] = "userId";
    return KEY_TYPE2;
  }({});
  var SAMPLE_TYPE = /* @__PURE__ */ function(SAMPLE_TYPE2) {
    SAMPLE_TYPE2["ACCOUNT_ID"] = "accountId";
    SAMPLE_TYPE2["ALI_ID"] = "aliId";
    SAMPLE_TYPE2["DEVICE_ID"] = "deviceId";
    SAMPLE_TYPE2["COOKIE_ID"] = "cookieId";
    SAMPLE_TYPE2["REQUEST_ID"] = "eachRequest";
    return SAMPLE_TYPE2;
  }({});
  function _regeneratorRuntime() {
    /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
    _regeneratorRuntime = function _regeneratorRuntime2() {
      return exports3;
    };
    var exports3 = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function(obj, key2, desc) {
      obj[key2] = desc.value;
    }, $Symbol = "function" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || "@@iterator", asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator", toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";
    function define2(obj, key2, value) {
      return Object.defineProperty(obj, key2, { value, enumerable: true, configurable: true, writable: true }), obj[key2];
    }
    try {
      define2({}, "");
    } catch (err) {
      define2 = function define3(obj, key2, value) {
        return obj[key2] = value;
      };
    }
    function wrap(innerFn, outerFn, self2, tryLocsList) {
      var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []);
      return defineProperty(generator, "_invoke", { value: makeInvokeMethod(innerFn, self2, context) }), generator;
    }
    function tryCatch(fn, obj, arg) {
      try {
        return { type: "normal", arg: fn.call(obj, arg) };
      } catch (err) {
        return { type: "throw", arg: err };
      }
    }
    exports3.wrap = wrap;
    var ContinueSentinel = {};
    function Generator() {
    }
    function GeneratorFunction() {
    }
    function GeneratorFunctionPrototype() {
    }
    var IteratorPrototype = {};
    define2(IteratorPrototype, iteratorSymbol, function() {
      return this;
    });
    var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([])));
    NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);
    var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);
    function defineIteratorMethods(prototype) {
      ["next", "throw", "return"].forEach(function(method) {
        define2(prototype, method, function(arg) {
          return this._invoke(method, arg);
        });
      });
    }
    function AsyncIterator(generator, PromiseImpl) {
      function invoke(method, arg, resolve, reject) {
        var record = tryCatch(generator[method], generator, arg);
        if ("throw" !== record.type) {
          var result = record.arg, value = result.value;
          return value && "object" == typeof value && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function(value2) {
            invoke("next", value2, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          }) : PromiseImpl.resolve(value).then(function(unwrapped) {
            result.value = unwrapped, resolve(result);
          }, function(error) {
            return invoke("throw", error, resolve, reject);
          });
        }
        reject(record.arg);
      }
      var previousPromise;
      defineProperty(this, "_invoke", { value: function value(method, arg) {
        function callInvokeWithMethodAndArg() {
          return new PromiseImpl(function(resolve, reject) {
            invoke(method, arg, resolve, reject);
          });
        }
        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();
      } });
    }
    function makeInvokeMethod(innerFn, self2, context) {
      var state = "suspendedStart";
      return function(method, arg) {
        if ("executing" === state) throw new Error("Generator is already running");
        if ("completed" === state) {
          if ("throw" === method) throw arg;
          return doneResult();
        }
        for (context.method = method, context.arg = arg; ; ) {
          var delegate = context.delegate;
          if (delegate) {
            var delegateResult = maybeInvokeDelegate(delegate, context);
            if (delegateResult) {
              if (delegateResult === ContinueSentinel) continue;
              return delegateResult;
            }
          }
          if ("next" === context.method) context.sent = context._sent = context.arg;
          else if ("throw" === context.method) {
            if ("suspendedStart" === state) throw state = "completed", context.arg;
            context.dispatchException(context.arg);
          } else "return" === context.method && context.abrupt("return", context.arg);
          state = "executing";
          var record = tryCatch(innerFn, self2, context);
          if ("normal" === record.type) {
            if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue;
            return { value: record.arg, done: context.done };
          }
          "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg);
        }
      };
    }
    function maybeInvokeDelegate(delegate, context) {
      var methodName = context.method, method = delegate.iterator[methodName];
      if (void 0 === method) return context.delegate = null, "throw" === methodName && delegate.iterator.return && (context.method = "return", context.arg = void 0, maybeInvokeDelegate(delegate, context), "throw" === context.method) || "return" !== methodName && (context.method = "throw", context.arg = new TypeError("The iterator does not provide a '" + methodName + "' method")), ContinueSentinel;
      var record = tryCatch(method, delegate.iterator, context.arg);
      if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel;
      var info = record.arg;
      return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = void 0), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel);
    }
    function pushTryEntry(locs) {
      var entry = { tryLoc: locs[0] };
      1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);
    }
    function resetTryEntry(entry) {
      var record = entry.completion || {};
      record.type = "normal", delete record.arg, entry.completion = record;
    }
    function Context(tryLocsList) {
      this.tryEntries = [{ tryLoc: "root" }], tryLocsList.forEach(pushTryEntry, this), this.reset(true);
    }
    function values(iterable) {
      if (iterable) {
        var iteratorMethod = iterable[iteratorSymbol];
        if (iteratorMethod) return iteratorMethod.call(iterable);
        if ("function" == typeof iterable.next) return iterable;
        if (!isNaN(iterable.length)) {
          var i = -1, next = function next2() {
            for (; ++i < iterable.length; ) if (hasOwn.call(iterable, i)) return next2.value = iterable[i], next2.done = false, next2;
            return next2.value = void 0, next2.done = true, next2;
          };
          return next.next = next;
        }
      }
      return { next: doneResult };
    }
    function doneResult() {
      return { value: void 0, done: true };
    }
    return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, "constructor", { value: GeneratorFunctionPrototype, configurable: true }), defineProperty(GeneratorFunctionPrototype, "constructor", { value: GeneratorFunction, configurable: true }), GeneratorFunction.displayName = define2(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports3.isGeneratorFunction = function(genFun) {
      var ctor = "function" == typeof genFun && genFun.constructor;
      return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name));
    }, exports3.mark = function(genFun) {
      return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define2(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun;
    }, exports3.awrap = function(arg) {
      return { __await: arg };
    }, defineIteratorMethods(AsyncIterator.prototype), define2(AsyncIterator.prototype, asyncIteratorSymbol, function() {
      return this;
    }), exports3.AsyncIterator = AsyncIterator, exports3.async = function(innerFn, outerFn, self2, tryLocsList, PromiseImpl) {
      void 0 === PromiseImpl && (PromiseImpl = Promise);
      var iter = new AsyncIterator(wrap(innerFn, outerFn, self2, tryLocsList), PromiseImpl);
      return exports3.isGeneratorFunction(outerFn) ? iter : iter.next().then(function(result) {
        return result.done ? result.value : iter.next();
      });
    }, defineIteratorMethods(Gp), define2(Gp, toStringTagSymbol, "Generator"), define2(Gp, iteratorSymbol, function() {
      return this;
    }), define2(Gp, "toString", function() {
      return "[object Generator]";
    }), exports3.keys = function(val) {
      var object = Object(val), keys = [];
      for (var key2 in object) keys.push(key2);
      return keys.reverse(), function next() {
        for (; keys.length; ) {
          var key3 = keys.pop();
          if (key3 in object) return next.value = key3, next.done = false, next;
        }
        return next.done = true, next;
      };
    }, exports3.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) {
      if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = false, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = void 0);
    }, stop: function stop() {
      this.done = true;
      var rootRecord = this.tryEntries[0].completion;
      if ("throw" === rootRecord.type) throw rootRecord.arg;
      return this.rval;
    }, dispatchException: function dispatchException(exception) {
      if (this.done) throw exception;
      var context = this;
      function handle(loc, caught) {
        return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = void 0), !!caught;
      }
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i], record = entry.completion;
        if ("root" === entry.tryLoc) return handle("end");
        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc"), hasFinally = hasOwn.call(entry, "finallyLoc");
          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, true);
            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);
          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, true);
          } else {
            if (!hasFinally) throw new Error("try statement without catch or finally");
            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);
          }
        }
      }
    }, abrupt: function abrupt(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }
      finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);
      var record = finallyEntry ? finallyEntry.completion : {};
      return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);
    }, complete: function complete(record, afterLoc) {
      if ("throw" === record.type) throw record.arg;
      return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;
    }, finish: function finish(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;
      }
    }, catch: function _catch(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if ("throw" === record.type) {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }
      throw new Error("illegal catch attempt");
    }, delegateYield: function delegateYield(iterable, resultName, nextLoc) {
      return this.delegate = { iterator: values(iterable), resultName, nextLoc }, "next" === this.method && (this.arg = void 0), ContinueSentinel;
    } }, exports3;
  }
  function _extends() {
    _extends = Object.assign ? Object.assign.bind() : function(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key2 in source) {
          if (Object.prototype.hasOwnProperty.call(source, key2)) {
            target[key2] = source[key2];
          }
        }
      }
      return target;
    };
    return _extends.apply(this, arguments);
  }
  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key2, arg) {
    try {
      var info = gen[key2](arg);
      var value = info.value;
    } catch (error) {
      reject(error);
      return;
    }
    if (info.done) {
      resolve(value);
    } else {
      Promise.resolve(value).then(_next, _throw);
    }
  }
  function _asyncToGenerator(fn) {
    return function() {
      var self2 = this, args = arguments;
      return new Promise(function(resolve, reject) {
        var gen = fn.apply(self2, args);
        function _next(value) {
          asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
        }
        function _throw(err) {
          asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
        }
        _next(void 0);
      });
    };
  }
  var ABTest = /* @__PURE__ */ function() {
    function ABTest2(params) {
      this.appName = void 0;
      this.testKey = void 0;
      this.diversionKey = void 0;
      this.DiversionCondition = void 0;
      this.appExpConfig = void 0;
      this.expConfig = void 0;
      this.userInfo = void 0;
      this.expResult = void 0;
      this.Storage = void 0;
      this.Request = void 0;
      this.appName = params.appName;
      this.testKey = params.testKey;
      this.diversionKey = params.diversion || "";
      this.DiversionCondition = params.filters || {};
      this.Storage = Storage;
      this.Request = Request;
      Reporter.install();
    }
    var _proto = ABTest2.prototype;
    _proto.getTreatment = /* @__PURE__ */ function() {
      var _getTreatment = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee() {
        var expResult, allocateInfo, taskInfo, _allocateInfo, treatment, _allocateInfo$message, message, errCode;
        return _regeneratorRuntime().wrap(function _callee$(_context) {
          while (1) switch (_context.prev = _context.next) {
            case 0:
              expResult = {};
              allocateInfo = {};
              _context.prev = 2;
              this.validateRequest();
              this.recordExpInvoked();
              _context.next = 7;
              return Promise.all([
                this.getAppExpConfig(),
                // cdn
                this.getWhiteList(),
                // 
                this.getLaunchConfig()
                //
              ]);
            case 7:
              taskInfo = _context.sent;
              this.appExpConfig = _extends({}, taskInfo[0], {
                whiteList: taskInfo[1],
                launchConfig: taskInfo[2]
              });
              this.validateExpConfig();
              _context.next = 12;
              return this.getUserInfo();
            case 12:
              this.userInfo = _context.sent;
              allocateInfo = Allocate(this.appExpConfig, this.userInfo, this.testKey);
              _allocateInfo = allocateInfo, treatment = _allocateInfo.treatment, _allocateInfo$message = _allocateInfo.message, message = _allocateInfo$message === void 0 ? "" : _allocateInfo$message;
              if (treatment) {
                expResult = this.setExpSucceedResult(allocateInfo);
                this.recordExpResultSucceed(expResult);
              } else {
                expResult = this.setExpFailedResult(RESULT_TYPE.SUCCESS.code, message);
                this.recordExpFailed(expResult);
              }
              this.saveGlobalExpResult(expResult);
              _context.next = 24;
              break;
            case 19:
              _context.prev = 19;
              _context.t0 = _context["catch"](2);
              errCode = _context.t0 instanceof ValidateError ? _context.t0.code : RESULT_TYPE.XS_SDK_ERROR.code;
              expResult = this.setExpFailedResult(errCode, _context.t0.message);
              this.recordExpFailed(expResult);
            case 24:
              this.expResult = expResult;
              this.afterAllocate();
              return _context.abrupt("return", expResult);
            case 27:
            case "end":
              return _context.stop();
          }
        }, _callee, this, [[2, 19]]);
      }));
      function getTreatment2() {
        return _getTreatment.apply(this, arguments);
      }
      return getTreatment2;
    }();
    _proto.validateRequest = function validateRequest() {
      if (!this.appName) {
        throw new ValidateError("Missing required parameter: appName");
      }
      if (!this.testKey) {
        throw new ValidateError("Missing required parameter: testKey");
      }
    };
    _proto.validateExpConfig = function validateExpConfig() {
      var _this = this;
      var _this$appExpConfig = this.appExpConfig, experiments = _this$appExpConfig.experiments, _this$appExpConfig$la = _this$appExpConfig.launchConfig, launchConfig = _this$appExpConfig$la === void 0 ? {} : _this$appExpConfig$la;
      if (!experiments) {
        throw new ValidateError("appName: " + this.appName + " not found.");
      }
      this.expConfig = experiments.find(function(v) {
        return v.testKey === _this.testKey;
      });
      var _launchConfig$launchE = launchConfig.launchExperiments, launchExperiments = _launchConfig$launchE === void 0 ? {} : _launchConfig$launchE;
      var launchExperiment = launchExperiments[this.testKey];
      if (!this.expConfig && !launchExperiment) {
        throw new ValidateError("Experiment: " + this.testKey + " not found. Please check if the experiment exists or launched.");
      }
    };
    _proto.getAppExpConfig = /* @__PURE__ */ function() {
      var _getAppExpConfig = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee2() {
        var config, expire, cache, EXP_LOCAL_KEY;
        return _regeneratorRuntime().wrap(function _callee2$(_context2) {
          while (1) switch (_context2.prev = _context2.next) {
            case 0:
              config = {};
              expire = EXP_CACHE.expire;
              cache = this.getExpConfigFromCache();
              if (!(cache && Date.now() - cache.updateAt < expire)) {
                _context2.next = 5;
                break;
              }
              return _context2.abrupt("return", cache);
            case 5:
              _context2.next = 7;
              return this.getExpConfigFromRemote();
            case 7:
              config = _context2.sent;
              config.updateAt = Date.now();
              EXP_LOCAL_KEY = this.getExpLocalKey();
              this.Storage.setItem(EXP_LOCAL_KEY, JSON.stringify(config));
              return _context2.abrupt("return", config);
            case 12:
            case "end":
              return _context2.stop();
          }
        }, _callee2, this);
      }));
      function getAppExpConfig() {
        return _getAppExpConfig.apply(this, arguments);
      }
      return getAppExpConfig;
    }();
    _proto.getExpConfigFromCache = function getExpConfigFromCache() {
      var EXP_LOCAL_KEY = this.getExpLocalKey();
      var storage = this.Storage.getItem(EXP_LOCAL_KEY);
      return storage ? JSON.parse(storage) : null;
    };
    _proto.getExpLocalKey = function getExpLocalKey() {
      return "" + EXP_CACHE.storagePrefix + this.appName;
    };
    _proto.getExpConfigFromRemote = /* @__PURE__ */ function() {
      var _getExpConfigFromRemote = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee3() {
        var _this2 = this;
        var url;
        return _regeneratorRuntime().wrap(function _callee3$(_context3) {
          while (1) switch (_context3.prev = _context3.next) {
            case 0:
              url = getExpConfigURL({
                appName: this.appName
                // 
              });
              if (url) {
                _context3.next = 3;
                break;
              }
              throw new ValidateError("Failed to get experiment remote url", RESULT_TYPE.XS_SDK_ERROR.code);
            case 3:
              _context3.next = 5;
              return Request(url).then(function(response) {
                if (response) {
                  if (response.status === 200) {
                    return response.json();
                  } else {
                    throw new ValidateError("Failed to get experiment:" + _this2.testKey + " configuration from remote", response.status);
                  }
                }
              }, function() {
                throw new ValidateError("Failed to get experiment:" + _this2.testKey + " configuration from remote", RESULT_TYPE.XS_SDK_ERROR.code);
              });
            case 5:
              return _context3.abrupt("return", _context3.sent);
            case 6:
            case "end":
              return _context3.stop();
          }
        }, _callee3, this);
      }));
      function getExpConfigFromRemote() {
        return _getExpConfigFromRemote.apply(this, arguments);
      }
      return getExpConfigFromRemote;
    }();
    _proto.getWhiteList = /* @__PURE__ */ function() {
      var _getWhiteList = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee4() {
        var url, response;
        return _regeneratorRuntime().wrap(function _callee4$(_context4) {
          while (1) switch (_context4.prev = _context4.next) {
            case 0:
              _context4.prev = 0;
              url = getWhiteListURL({
                appName: this.appName
                // 
              });
              _context4.next = 4;
              return Request(url);
            case 4:
              response = _context4.sent;
              if (!response) {
                _context4.next = 8;
                break;
              }
              if (!(response.status === 200)) {
                _context4.next = 8;
                break;
              }
              return _context4.abrupt("return", response.json());
            case 8:
              _context4.next = 12;
              break;
            case 10:
              _context4.prev = 10;
              _context4.t0 = _context4["catch"](0);
            case 12:
              return _context4.abrupt("return", {});
            case 13:
            case "end":
              return _context4.stop();
          }
        }, _callee4, this, [[0, 10]]);
      }));
      function getWhiteList() {
        return _getWhiteList.apply(this, arguments);
      }
      return getWhiteList;
    }();
    _proto.getLaunchConfig = /* @__PURE__ */ function() {
      var _getLaunchConfig = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee5() {
        var url, response;
        return _regeneratorRuntime().wrap(function _callee5$(_context5) {
          while (1) switch (_context5.prev = _context5.next) {
            case 0:
              _context5.prev = 0;
              url = getLaunchConfigURL({
                appName: this.appName
              });
              _context5.next = 4;
              return Request(url);
            case 4:
              response = _context5.sent;
              if (!response) {
                _context5.next = 8;
                break;
              }
              if (!(response.status === 200)) {
                _context5.next = 8;
                break;
              }
              return _context5.abrupt("return", response.json());
            case 8:
              _context5.next = 12;
              break;
            case 10:
              _context5.prev = 10;
              _context5.t0 = _context5["catch"](0);
            case 12:
              return _context5.abrupt("return", {});
            case 13:
            case "end":
              return _context5.stop();
          }
        }, _callee5, this, [[0, 10]]);
      }));
      function getLaunchConfig() {
        return _getLaunchConfig.apply(this, arguments);
      }
      return getLaunchConfig;
    }();
    _proto.getUserInfo = /* @__PURE__ */ function() {
      var _getUserInfo = _asyncToGenerator(/* @__PURE__ */ _regeneratorRuntime().mark(function _callee6() {
        var cookieInfo, platform, country, channel, language, version2, loginId, aliId, cna, diversionKey, _this$expConfig, keyType, sampleType, defaultCondition;
        return _regeneratorRuntime().wrap(function _callee6$(_context6) {
          while (1) switch (_context6.prev = _context6.next) {
            case 0:
              if (this.expConfig) {
                _context6.next = 2;
                break;
              }
              return _context6.abrupt("return", {});
            case 2:
              cookieInfo = getFromCookie();
              platform = cookieInfo.platform, country = cookieInfo.country, channel = cookieInfo.channel, language = cookieInfo.language, version2 = cookieInfo.version, loginId = cookieInfo.loginId, aliId = cookieInfo.aliId, cna = cookieInfo.cna;
              diversionKey = null;
              _this$expConfig = this.expConfig, keyType = _this$expConfig.keyType, sampleType = _this$expConfig.sampleType;
              if (!this.diversionKey) {
                _context6.next = 10;
                break;
              }
              diversionKey = "" + this.diversionKey;
              _context6.next = 33;
              break;
            case 10:
              _context6.t0 = sampleType;
              _context6.next = _context6.t0 === SAMPLE_TYPE.ACCOUNT_ID ? 13 : _context6.t0 === SAMPLE_TYPE.ALI_ID ? 15 : _context6.t0 === SAMPLE_TYPE.DEVICE_ID ? 23 : _context6.t0 === SAMPLE_TYPE.COOKIE_ID ? 23 : _context6.t0 === SAMPLE_TYPE.REQUEST_ID ? 29 : 29;
              break;
            case 13:
              diversionKey = loginId;
              return _context6.abrupt("break", 31);
            case 15:
              if (!(keyType === KEY_TYPE.SELLER_ALI_ID)) {
                _context6.next = 21;
                break;
              }
              _context6.next = 18;
              return getAliId(aliId);
            case 18:
              diversionKey = _context6.sent;
              _context6.next = 22;
              break;
            case 21:
              diversionKey = aliId;
            case 22:
              return _context6.abrupt("break", 31);
            case 23:
              diversionKey = cna;
              if (diversionKey) {
                _context6.next = 28;
                break;
              }
              _context6.next = 27;
              return getCna();
            case 27:
              diversionKey = _context6.sent;
            case 28:
              return _context6.abrupt("break", 31);
            case 29:
              diversionKey = null;
              return _context6.abrupt("break", 31);
            case 31:
              if (diversionKey) {
                _context6.next = 33;
                break;
              }
              throw new ValidateError("Missing keyType: [" + keyType + "] required parameter: [diversion]");
            case 33:
              defaultCondition = {
                platform,
                country,
                channel,
                language,
                version: version2
              };
              return _context6.abrupt("return", {
                diversionKey,
                DiversionCondition: _extends({}, defaultCondition, this.DiversionCondition)
              });
            case 35:
            case "end":
              return _context6.stop();
          }
        }, _callee6, this);
      }));
      function getUserInfo() {
        return _getUserInfo.apply(this, arguments);
      }
      return getUserInfo;
    }();
    _proto.saveGlobalExpResult = function saveGlobalExpResult(expResult) {
      var globalKey = EXP_RESULT.globalKey, aplusKey = EXP_RESULT.aplusKey;
      var global_res = window[globalKey] || {};
      var treatment = expResult.treatment;
      if (treatment) {
        var _extends2, _Aplus$injectIntoGold;
        window[globalKey] = _extends({}, global_res, (_extends2 = {}, _extends2[this.testKey] = treatment, _extends2));
        injectIntoGoldlog((_Aplus$injectIntoGold = {}, _Aplus$injectIntoGold[aplusKey] = encodeURIComponent(stringify(window[globalKey])), _Aplus$injectIntoGold));
      }
    };
    _proto.setExpSucceedResult = function setExpSucceedResult(allocateInfo) {
      return _extends({
        success: true,
        code: RESULT_TYPE.SUCCESS.code,
        message: RESULT_TYPE.SUCCESS.message
      }, allocateInfo);
    };
    _proto.setExpFailedResult = function setExpFailedResult(code, message) {
      return {
        success: false,
        code,
        message
      };
    };
    _proto.afterAllocate = function afterAllocate() {
      if (utils.isDebug()) {
        console.group("%c" + this.testKey, "color: #CC3300");
        console.log("%c%c" + JSON.stringify(this.expConfig), "color: #339966", "");
        console.log("%c%c" + JSON.stringify(this.userInfo), "color: #3366CC", "");
        console.log("%c%c" + JSON.stringify(this.expResult), "color: #990099", "");
        console.groupEnd();
      }
    };
    _proto.recordExpInvoked = function recordExpInvoked() {
      var resInfo = {
        appName: this.appName,
        testKey: this.testKey,
        sdkVer: pkg.version
      };
      goldlog$1(EXP_LOG.action.sdkInvoked, resInfo);
    };
    _proto.recordExpResultSucceed = function recordExpResultSucceed(expResult) {
      if (!this.expConfig) return;
      var _expResult$segmentID = expResult.segmentID, segmentID = _expResult$segmentID === void 0 ? null : _expResult$segmentID, _expResult$treatmentI = expResult.treatmentID, treatmentID = _expResult$treatmentI === void 0 ? null : _expResult$treatmentI, _expResult$treatment = expResult.treatment, treatment = _expResult$treatment === void 0 ? "" : _expResult$treatment, rangeInfo = expResult.rangeInfo;
      var _this$appExpConfig$en = this.appExpConfig.envType, envType = _this$appExpConfig$en === void 0 ? "" : _this$appExpConfig$en;
      var _this$expConfig2 = this.expConfig, id = _this$expConfig2.id, releaseId = _this$expConfig2.releaseId, keyType = _this$expConfig2.keyType;
      var diversionKey = this.userInfo.diversionKey;
      var expVer = rangeInfo ? rangeInfo.releaseId : releaseId;
      var releaseVer = rangeInfo ? rangeInfo.version : "";
      var resInfo = {
        expID: id,
        expVer,
        segmentID,
        bucketID: treatmentID,
        diverKey: diversionKey,
        keyType,
        expTime: +/* @__PURE__ */ new Date(),
        sdkVer: pkg.version,
        appName: this.appName,
        testKey: this.testKey,
        bucketName: treatment,
        releaseVer,
        envType
      };
      if (segmentID !== null && treatmentID !== null) {
        goldlog$1(EXP_LOG.action.resultSucceed, resInfo);
      }
      Reporter.report({
        category: 100,
        msg: "experiment allocated succeed",
        w_succ: 1,
        resInfo,
        userInfo: this.userInfo || {}
      });
    };
    _proto.recordExpFailed = function recordExpFailed(_ref) {
      var _this$expConfig$id, _this$expConfig3, _this$expConfig$relea, _this$expConfig4;
      var _ref$code = _ref.code, code = _ref$code === void 0 ? -1 : _ref$code, _ref$message = _ref.message, message = _ref$message === void 0 ? "" : _ref$message;
      if (!this.expConfig) return;
      var resInfo = {
        code,
        message,
        appName: this.appName,
        testKey: this.testKey,
        expID: (_this$expConfig$id = (_this$expConfig3 = this.expConfig) == null ? void 0 : _this$expConfig3.id) != null ? _this$expConfig$id : "",
        expVer: (_this$expConfig$relea = (_this$expConfig4 = this.expConfig) == null ? void 0 : _this$expConfig4.releaseId) != null ? _this$expConfig$relea : "",
        sdkVer: pkg.version
      };
      goldlog$1(EXP_LOG.action.resultFailed, resInfo);
      Reporter.report({
        category: 100,
        msg: message,
        w_succ: 0,
        resInfo,
        userInfo: this.userInfo || {}
      });
    };
    return ABTest2;
  }();
  function getTreatment$1(params) {
    var instance = new ABTest(params);
    return instance.getTreatment();
  }
  window["Dataphant"] = {
    getTreatment: getTreatment$1
  };
  var getTreatment = getTreatment$1;
  const SVG_MAP = {
    message: /* @__PURE__ */ React.createElement(
      "svg",
      {
        preserveAspectRatio: "none",
        viewBox: "0 0 1024 1024",
        width: "24",
        height: "24",
        xmlns: "http://www.w3.org/2000/svg"
      },
      /* @__PURE__ */ React.createElement("path", { d: "M853.333333 170.666667a73.142857 73.142857 0 0 1 73.142857 73.142857v487.619047a73.142857 73.142857 0 0 1-73.142857 73.142858H473.526857l-167.594667 109.83619A24.380952 24.380952 0 0 1 268.190476 894.000762V804.571429H170.666667a73.142857 73.142857 0 0 1-73.142857-73.142858V243.809524a73.142857 73.142857 0 0 1 73.142857-73.142857h682.666666z m0 73.142857H170.666667v487.619047h170.666666v72.338286L451.705905 731.428571H853.333333V243.809524zM543.207619 487.619048v73.142857H341.333333v-73.142857h201.874286zM682.666667 341.333333v73.142857H341.333333v-73.142857h341.333334z" })
    )
  };
  /*! js-cookie v3.0.5 | MIT */
  function assign(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var key2 in source) {
        target[key2] = source[key2];
      }
    }
    return target;
  }
  var defaultConverter = {
    read: function(value) {
      if (value[0] === '"') {
        value = value.slice(1, -1);
      }
      return value.replace(/(%[\dA-F]{2})+/gi, decodeURIComponent);
    },
    write: function(value) {
      return encodeURIComponent(value).replace(
        /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,
        decodeURIComponent
      );
    }
  };
  function init(converter, defaultAttributes) {
    function set(name, value, attributes) {
      if (typeof document === "undefined") {
        return;
      }
      attributes = assign({}, defaultAttributes, attributes);
      if (typeof attributes.expires === "number") {
        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);
      }
      if (attributes.expires) {
        attributes.expires = attributes.expires.toUTCString();
      }
      name = encodeURIComponent(name).replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent).replace(/[()]/g, escape);
      var stringifiedAttributes = "";
      for (var attributeName in attributes) {
        if (!attributes[attributeName]) {
          continue;
        }
        stringifiedAttributes += "; " + attributeName;
        if (attributes[attributeName] === true) {
          continue;
        }
        stringifiedAttributes += "=" + attributes[attributeName].split(";")[0];
      }
      return document.cookie = name + "=" + converter.write(value, name) + stringifiedAttributes;
    }
    function get(name) {
      if (typeof document === "undefined" || arguments.length && !name) {
        return;
      }
      var cookies = document.cookie ? document.cookie.split("; ") : [];
      var jar = {};
      for (var i = 0; i < cookies.length; i++) {
        var parts = cookies[i].split("=");
        var value = parts.slice(1).join("=");
        try {
          var found = decodeURIComponent(parts[0]);
          jar[found] = converter.read(value, found);
          if (name === found) {
            break;
          }
        } catch (e) {
        }
      }
      return name ? jar[name] : jar;
    }
    return Object.create(
      {
        set,
        get,
        remove: function(name, attributes) {
          set(
            name,
            "",
            assign({}, attributes, {
              expires: -1
            })
          );
        },
        withAttributes: function(attributes) {
          return init(this.converter, assign({}, this.attributes, attributes));
        },
        withConverter: function(converter2) {
          return init(assign({}, this.converter, converter2), this.attributes);
        }
      },
      {
        attributes: { value: Object.freeze(defaultAttributes) },
        converter: { value: Object.freeze(converter) }
      }
    );
  }
  var api = init(defaultConverter, { path: "/" });
  var lib = {};
  Object.defineProperty(lib, "__esModule", { value: true });
  var transferDomain_1 = lib.transferDomain = void 0;
  function transferDomain(domain, customHost) {
    const host = customHost || location && location.hostname;
    if (host) {
      const suffixList = host.match(/alibaba\.(.*)/);
      if (suffixList && suffixList.length > 0) {
        return domain.replace("com", suffixList[1]);
      }
    }
    return domain;
  }
  transferDomain_1 = lib.transferDomain = transferDomain;
  const ONETALK_DOMAIN = transferDomain_1("onetalk.alibaba.com");
  const MESSAGE_DOMAIN = transferDomain_1("message.alibaba.com");
  const PASSPORT_DOMAIN = transferDomain_1("passport.alibaba.com");
  const SELLER_MESSENGER_URL = `https://${ONETALK_DOMAIN}/message/weblitePWA.htm`;
  const BUYER_MESSENGER_URL = `https://${MESSAGE_DOMAIN}/message/messenger.htm`;
  const SELLER_INQUIRY_URL = `https://${MESSAGE_DOMAIN}/message/default.htm`;
  const SELLER_GGS_MESSENGER_URL = `https://${ONETALK_DOMAIN}/message/weblitePWA.htm?isGray=1&from=menu&hideMenu=1`;
  const goldlog = function(data) {
    const content = `ext=${encodeURIComponent(`${data}&host=header`)}`;
    if (window.goldlog && window.goldlog.record) {
      window.goldlog.record("/sc.ma.im", "CLK", content, "GET");
    } else {
      const q = window.goldlog_queue || (window.goldlog_queue = []);
      q.push({
        action: "goldlog.record",
        arguments: ["/sc.ma.im", "CLK", content, "GET"]
      });
    }
  };
  function getHashCode(str) {
    let hashcode = 0;
    if (!str) return hashcode;
    for (let i = 0; i < str.length; i++) {
      hashcode = hashcode * 31 + str.charCodeAt(i);
      hashcode &= 4294967295;
    }
    return hashcode;
  }
  function getAvatarBackground(name) {
    const avatarBackgroundList = [
      "#50E3C2",
      "#FE5D59",
      "#FF9A59",
      "#FFDD59",
      "#59DBFF",
      "#5966FF",
      "#59ABFD",
      "#FE5977",
      "#5A8EFF",
      "#A559FF",
      "#50E3C2",
      "#D84C4C"
    ];
    return avatarBackgroundList[Math.abs(getHashCode(name) % 12)];
  }
  function formatNumber(num) {
    return num < 10 ? `0${num}` : num;
  }
  function timeSince(date) {
    if (typeof date !== "object") {
      date = new Date(date);
    }
    let seconds = Math.floor((/* @__PURE__ */ new Date() - date) / 1e3);
    const dateStr = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;
    if (seconds > 60 * 60 * 24) {
      return dateStr;
    }
    const d = /* @__PURE__ */ new Date();
    const diff = (d.getTime() - new Date(d.getFullYear(), d.getMonth(), d.getDate()).getTime()) / 1e3;
    seconds -= diff;
    const interval = Math.ceil(seconds / 86400);
    const hour = formatNumber(date.getHours());
    const minute = formatNumber(date.getMinutes());
    const tt = `${hour}:${minute}`;
    return interval === 1 ? dateStr : `${tt}`;
  }
  function decodeHTML(str) {
    if (typeof str !== "string") {
      return str;
    }
    str = str.replace(/&lt;|&#60;/g, "<");
    str = str.replace(/&gt;|&#62;/g, ">");
    str = str.replace(/&apos;|&#39;/g, "'");
    str = str.replace(/&quot;|&#34;/g, '"');
    str = str.replace(/&amp;|&#38;/g, "&");
    return str;
  }
  const getCtoken = () => {
    let json = {};
    try {
      json = search2Json(api.get("xman_us_t") || "") || {};
    } catch (error) {
    }
    return json.ctoken || api.get("ctoken");
  };
  const search2Json = (searchStr) => {
    const arrayReg = /\[((\d+)(,\d+)*)?\]/;
    if (!searchStr) {
      return;
    }
    const paramItems = searchStr.split("&");
    const params = [];
    params.push("{");
    for (let i = 0, { length } = paramItems; i < length; i++) {
      const map = paramItems[i].split("=");
      params.push('"');
      params.push(map[0]);
      params.push('"');
      params.push(":");
      if (!isNaN(map[1])) {
        params.push(Number(map[1]));
      } else if (arrayReg.test(map[1])) {
        params.push(map[1]);
      } else {
        params.push('"');
        params.push(map[1]);
        params.push('"');
      }
      if (i !== length - 1) {
        params.push(",");
      }
    }
    params.push("}");
    return JSON.parse(params.join(""));
  };
  function checkLogin() {
    const { cookie } = document;
    return cookie && cookie.indexOf("sign=y") !== -1;
  }
  function getMemberType() {
    try {
      const xman_us_f = document.cookie.match(new RegExp("(^|;\\s*)xman_us_f=([^;]*)"));
      if (xman_us_f == null ? void 0 : xman_us_f.length) {
        const x_user = /(x_user=.+?)([;&])/.exec(xman_us_f[0]);
        if (x_user == null ? void 0 : x_user.length) {
          const splitResult = x_user[0].split("|");
          if (splitResult == null ? void 0 : splitResult.length) {
            return splitResult[3];
          }
        }
      }
      return "";
    } catch (e) {
      console.error("==== get member type failed ====", e);
      return "";
    }
  }
  function getMessengerUrl() {
    const type = getMemberType();
    const urlMap = {
      cgs: SELLER_INQUIRY_URL,
      tp: SELLER_GGS_MESSENGER_URL,
      ifm: BUYER_MESSENGER_URL,
      cnfm: SELLER_MESSENGER_URL
    };
    return urlMap[type] || BUYER_MESSENGER_URL;
  }
  function getBuyerLocale() {
    try {
      const matchResult = /(sc_b_locale=*.+?)[&]/.exec(document.cookie);
      let locale2 = matchResult && matchResult[1] && matchResult[1].slice(12) || "";
      locale2 = locale2.split("_");
      return {
        lang: locale2[0] || "en",
        country: locale2[1] || "US"
      };
    } catch (e) {
      console.error("==== get locale failed ====", e);
      goldlog(`getLocaleFail&msg=${e == null ? void 0 : e.message}`);
      return {
        lang: "en",
        country: "US"
      };
    }
  }
  /*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */
  const {
    entries,
    setPrototypeOf,
    isFrozen,
    getPrototypeOf,
    getOwnPropertyDescriptor
  } = Object;
  let {
    freeze,
    seal,
    create
  } = Object;
  let {
    apply,
    construct
  } = typeof Reflect !== "undefined" && Reflect;
  if (!freeze) {
    freeze = function freeze2(x) {
      return x;
    };
  }
  if (!seal) {
    seal = function seal2(x) {
      return x;
    };
  }
  if (!apply) {
    apply = function apply2(fun, thisValue, args) {
      return fun.apply(thisValue, args);
    };
  }
  if (!construct) {
    construct = function construct2(Func, args) {
      return new Func(...args);
    };
  }
  const arrayForEach = unapply(Array.prototype.forEach);
  const arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);
  const arrayPop = unapply(Array.prototype.pop);
  const arrayPush = unapply(Array.prototype.push);
  const arraySplice = unapply(Array.prototype.splice);
  const stringToLowerCase = unapply(String.prototype.toLowerCase);
  const stringToString = unapply(String.prototype.toString);
  const stringMatch = unapply(String.prototype.match);
  const stringReplace = unapply(String.prototype.replace);
  const stringIndexOf = unapply(String.prototype.indexOf);
  const stringTrim = unapply(String.prototype.trim);
  const objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);
  const regExpTest = unapply(RegExp.prototype.test);
  const typeErrorCreate = unconstruct(TypeError);
  function unapply(func) {
    return function(thisArg) {
      if (thisArg instanceof RegExp) {
        thisArg.lastIndex = 0;
      }
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }
      return apply(func, thisArg, args);
    };
  }
  function unconstruct(func) {
    return function() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      return construct(func, args);
    };
  }
  function addToSet(set, array) {
    let transformCaseFunc = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : stringToLowerCase;
    if (setPrototypeOf) {
      setPrototypeOf(set, null);
    }
    let l = array.length;
    while (l--) {
      let element = array[l];
      if (typeof element === "string") {
        const lcElement = transformCaseFunc(element);
        if (lcElement !== element) {
          if (!isFrozen(array)) {
            array[l] = lcElement;
          }
          element = lcElement;
        }
      }
      set[element] = true;
    }
    return set;
  }
  function cleanArray(array) {
    for (let index = 0; index < array.length; index++) {
      const isPropertyExist = objectHasOwnProperty(array, index);
      if (!isPropertyExist) {
        array[index] = null;
      }
    }
    return array;
  }
  function clone(object) {
    const newObject = create(null);
    for (const [property, value] of entries(object)) {
      const isPropertyExist = objectHasOwnProperty(object, property);
      if (isPropertyExist) {
        if (Array.isArray(value)) {
          newObject[property] = cleanArray(value);
        } else if (value && typeof value === "object" && value.constructor === Object) {
          newObject[property] = clone(value);
        } else {
          newObject[property] = value;
        }
      }
    }
    return newObject;
  }
  function lookupGetter(object, prop) {
    while (object !== null) {
      const desc = getOwnPropertyDescriptor(object, prop);
      if (desc) {
        if (desc.get) {
          return unapply(desc.get);
        }
        if (typeof desc.value === "function") {
          return unapply(desc.value);
        }
      }
      object = getPrototypeOf(object);
    }
    function fallbackValue() {
      return null;
    }
    return fallbackValue;
  }
  const html$1 = freeze(["a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr"]);
  const svg$1 = freeze(["svg", "a", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "circle", "clippath", "defs", "desc", "ellipse", "filter", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "style", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "view", "vkern"]);
  const svgFilters = freeze(["feBlend", "feColorMatrix", "feComponentTransfer", "feComposite", "feConvolveMatrix", "feDiffuseLighting", "feDisplacementMap", "feDistantLight", "feDropShadow", "feFlood", "feFuncA", "feFuncB", "feFuncG", "feFuncR", "feGaussianBlur", "feImage", "feMerge", "feMergeNode", "feMorphology", "feOffset", "fePointLight", "feSpecularLighting", "feSpotLight", "feTile", "feTurbulence"]);
  const svgDisallowed = freeze(["animate", "color-profile", "cursor", "discard", "font-face", "font-face-format", "font-face-name", "font-face-src", "font-face-uri", "foreignobject", "hatch", "hatchpath", "mesh", "meshgradient", "meshpatch", "meshrow", "missing-glyph", "script", "set", "solidcolor", "unknown", "use"]);
  const mathMl$1 = freeze(["math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmultiscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mspace", "msqrt", "mstyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover", "mprescripts"]);
  const mathMlDisallowed = freeze(["maction", "maligngroup", "malignmark", "mlongdiv", "mscarries", "mscarry", "msgroup", "mstack", "msline", "msrow", "semantics", "annotation", "annotation-xml", "mprescripts", "none"]);
  const text = freeze(["#text"]);
  const html = freeze(["accept", "action", "align", "alt", "autocapitalize", "autocomplete", "autopictureinpicture", "autoplay", "background", "bgcolor", "border", "capture", "cellpadding", "cellspacing", "checked", "cite", "class", "clear", "color", "cols", "colspan", "controls", "controlslist", "coords", "crossorigin", "datetime", "decoding", "default", "dir", "disabled", "disablepictureinpicture", "disableremoteplayback", "download", "draggable", "enctype", "enterkeyhint", "face", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "inputmode", "integrity", "ismap", "kind", "label", "lang", "list", "loading", "loop", "low", "max", "maxlength", "media", "method", "min", "minlength", "multiple", "muted", "name", "nonce", "noshade", "novalidate", "nowrap", "open", "optimum", "pattern", "placeholder", "playsinline", "popover", "popovertarget", "popovertargetaction", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "role", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "sizes", "span", "srclang", "start", "src", "srcset", "step", "style", "summary", "tabindex", "title", "translate", "type", "usemap", "valign", "value", "width", "wrap", "xmlns", "slot"]);
  const svg = freeze(["accent-height", "accumulate", "additive", "alignment-baseline", "amplitude", "ascent", "attributename", "attributetype", "azimuth", "basefrequency", "baseline-shift", "begin", "bias", "by", "class", "clip", "clippathunits", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dx", "dy", "diffuseconstant", "direction", "display", "divisor", "dur", "edgemode", "elevation", "end", "exponent", "fill", "fill-opacity", "fill-rule", "filter", "filterunits", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "font-weight", "fx", "fy", "g1", "g2", "glyph-name", "glyphref", "gradientunits", "gradienttransform", "height", "href", "id", "image-rendering", "in", "in2", "intercept", "k", "k1", "k2", "k3", "k4", "kerning", "keypoints", "keysplines", "keytimes", "lang", "lengthadjust", "letter-spacing", "kernelmatrix", "kernelunitlength", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "markerheight", "markerunits", "markerwidth", "maskcontentunits", "maskunits", "max", "mask", "media", "method", "mode", "min", "name", "numoctaves", "offset", "operator", "opacity", "order", "orient", "orientation", "origin", "overflow", "paint-order", "path", "pathlength", "patterncontentunits", "patterntransform", "patternunits", "points", "preservealpha", "preserveaspectratio", "primitiveunits", "r", "rx", "ry", "radius", "refx", "refy", "repeatcount", "repeatdur", "restart", "result", "rotate", "scale", "seed", "shape-rendering", "slope", "specularconstant", "specularexponent", "spreadmethod", "startoffset", "stddeviation", "stitchtiles", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "style", "surfacescale", "systemlanguage", "tabindex", "tablevalues", "targetx", "targety", "transform", "transform-origin", "text-anchor", "text-decoration", "text-rendering", "textlength", "type", "u1", "u2", "unicode", "values", "viewbox", "visibility", "version", "vert-adv-y", "vert-origin-x", "vert-origin-y", "width", "word-spacing", "wrap", "writing-mode", "xchannelselector", "ychannelselector", "x", "x1", "x2", "xmlns", "y", "y1", "y2", "z", "zoomandpan"]);
  const mathMl = freeze(["accent", "accentunder", "align", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "dir", "display", "displaystyle", "encoding", "fence", "frame", "height", "href", "id", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "width", "xmlns"]);
  const xml = freeze(["xlink:href", "xml:id", "xlink:title", "xml:space", "xmlns:xlink"]);
  const MUSTACHE_EXPR = seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm);
  const ERB_EXPR = seal(/<%[\w\W]*|[\w\W]*%>/gm);
  const TMPLIT_EXPR = seal(/\$\{[\w\W]*/gm);
  const DATA_ATTR = seal(/^data-[\-\w.\u00B7-\uFFFF]+$/);
  const ARIA_ATTR = seal(/^aria-[\-\w]+$/);
  const IS_ALLOWED_URI = seal(
    /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i
    // eslint-disable-line no-useless-escape
  );
  const IS_SCRIPT_OR_DATA = seal(/^(?:\w+script|data):/i);
  const ATTR_WHITESPACE = seal(
    /[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g
    // eslint-disable-line no-control-regex
  );
  const DOCTYPE_NAME = seal(/^html$/i);
  const CUSTOM_ELEMENT = seal(/^[a-z][.\w]*(-[.\w]+)+$/i);
  var EXPRESSIONS = /* @__PURE__ */ Object.freeze({
    __proto__: null,
    ARIA_ATTR,
    ATTR_WHITESPACE,
    CUSTOM_ELEMENT,
    DATA_ATTR,
    DOCTYPE_NAME,
    ERB_EXPR,
    IS_ALLOWED_URI,
    IS_SCRIPT_OR_DATA,
    MUSTACHE_EXPR,
    TMPLIT_EXPR
  });
  const NODE_TYPE = {
    element: 1,
    text: 3,
    // Deprecated
    progressingInstruction: 7,
    comment: 8,
    document: 9
  };
  const getGlobal = function getGlobal2() {
    return typeof window === "undefined" ? null : window;
  };
  const _createTrustedTypesPolicy = function _createTrustedTypesPolicy2(trustedTypes, purifyHostElement) {
    if (typeof trustedTypes !== "object" || typeof trustedTypes.createPolicy !== "function") {
      return null;
    }
    let suffix = null;
    const ATTR_NAME = "data-tt-policy-suffix";
    if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {
      suffix = purifyHostElement.getAttribute(ATTR_NAME);
    }
    const policyName = "dompurify" + (suffix ? "#" + suffix : "");
    try {
      return trustedTypes.createPolicy(policyName, {
        createHTML(html2) {
          return html2;
        },
        createScriptURL(scriptUrl) {
          return scriptUrl;
        }
      });
    } catch (_) {
      console.warn("TrustedTypes policy " + policyName + " could not be created.");
      return null;
    }
  };
  const _createHooksMap = function _createHooksMap2() {
    return {
      afterSanitizeAttributes: [],
      afterSanitizeElements: [],
      afterSanitizeShadowDOM: [],
      beforeSanitizeAttributes: [],
      beforeSanitizeElements: [],
      beforeSanitizeShadowDOM: [],
      uponSanitizeAttribute: [],
      uponSanitizeElement: [],
      uponSanitizeShadowNode: []
    };
  };
  function createDOMPurify() {
    let window2 = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : getGlobal();
    const DOMPurify = (root) => createDOMPurify(root);
    DOMPurify.version = "3.2.6";
    DOMPurify.removed = [];
    if (!window2 || !window2.document || window2.document.nodeType !== NODE_TYPE.document || !window2.Element) {
      DOMPurify.isSupported = false;
      return DOMPurify;
    }
    let {
      document: document2
    } = window2;
    const originalDocument = document2;
    const currentScript = originalDocument.currentScript;
    const {
      DocumentFragment,
      HTMLTemplateElement,
      Node,
      Element,
      NodeFilter,
      NamedNodeMap = window2.NamedNodeMap || window2.MozNamedAttrMap,
      HTMLFormElement,
      DOMParser,
      trustedTypes
    } = window2;
    const ElementPrototype = Element.prototype;
    const cloneNode = lookupGetter(ElementPrototype, "cloneNode");
    const remove = lookupGetter(ElementPrototype, "remove");
    const getNextSibling = lookupGetter(ElementPrototype, "nextSibling");
    const getChildNodes = lookupGetter(ElementPrototype, "childNodes");
    const getParentNode = lookupGetter(ElementPrototype, "parentNode");
    if (typeof HTMLTemplateElement === "function") {
      const template = document2.createElement("template");
      if (template.content && template.content.ownerDocument) {
        document2 = template.content.ownerDocument;
      }
    }
    let trustedTypesPolicy;
    let emptyHTML = "";
    const {
      implementation,
      createNodeIterator,
      createDocumentFragment,
      getElementsByTagName
    } = document2;
    const {
      importNode
    } = originalDocument;
    let hooks = _createHooksMap();
    DOMPurify.isSupported = typeof entries === "function" && typeof getParentNode === "function" && implementation && implementation.createHTMLDocument !== void 0;
    const {
      MUSTACHE_EXPR: MUSTACHE_EXPR2,
      ERB_EXPR: ERB_EXPR2,
      TMPLIT_EXPR: TMPLIT_EXPR2,
      DATA_ATTR: DATA_ATTR2,
      ARIA_ATTR: ARIA_ATTR2,
      IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA2,
      ATTR_WHITESPACE: ATTR_WHITESPACE2,
      CUSTOM_ELEMENT: CUSTOM_ELEMENT2
    } = EXPRESSIONS;
    let {
      IS_ALLOWED_URI: IS_ALLOWED_URI$1
    } = EXPRESSIONS;
    let ALLOWED_TAGS = null;
    const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);
    let ALLOWED_ATTR = null;
    const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);
    let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {
      tagNameCheck: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: null
      },
      attributeNameCheck: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: null
      },
      allowCustomizedBuiltInElements: {
        writable: true,
        configurable: false,
        enumerable: true,
        value: false
      }
    }));
    let FORBID_TAGS = null;
    let FORBID_ATTR = null;
    let ALLOW_ARIA_ATTR = true;
    let ALLOW_DATA_ATTR = true;
    let ALLOW_UNKNOWN_PROTOCOLS = false;
    let ALLOW_SELF_CLOSE_IN_ATTR = true;
    let SAFE_FOR_TEMPLATES = false;
    let SAFE_FOR_XML = true;
    let WHOLE_DOCUMENT = false;
    let SET_CONFIG = false;
    let FORCE_BODY = false;
    let RETURN_DOM = false;
    let RETURN_DOM_FRAGMENT = false;
    let RETURN_TRUSTED_TYPE = false;
    let SANITIZE_DOM = true;
    let SANITIZE_NAMED_PROPS = false;
    const SANITIZE_NAMED_PROPS_PREFIX = "user-content-";
    let KEEP_CONTENT = true;
    let IN_PLACE = false;
    let USE_PROFILES = {};
    let FORBID_CONTENTS = null;
    const DEFAULT_FORBID_CONTENTS = addToSet({}, ["annotation-xml", "audio", "colgroup", "desc", "foreignobject", "head", "iframe", "math", "mi", "mn", "mo", "ms", "mtext", "noembed", "noframes", "noscript", "plaintext", "script", "style", "svg", "template", "thead", "title", "video", "xmp"]);
    let DATA_URI_TAGS = null;
    const DEFAULT_DATA_URI_TAGS = addToSet({}, ["audio", "video", "img", "source", "image", "track"]);
    let URI_SAFE_ATTRIBUTES = null;
    const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ["alt", "class", "for", "id", "label", "name", "pattern", "placeholder", "role", "summary", "title", "value", "style", "xmlns"]);
    const MATHML_NAMESPACE = "http://www.w3.org/1998/Math/MathML";
    const SVG_NAMESPACE = "http://www.w3.org/2000/svg";
    const HTML_NAMESPACE = "http://www.w3.org/1999/xhtml";
    let NAMESPACE = HTML_NAMESPACE;
    let IS_EMPTY_INPUT = false;
    let ALLOWED_NAMESPACES = null;
    const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);
    let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ["mi", "mo", "mn", "ms", "mtext"]);
    let HTML_INTEGRATION_POINTS = addToSet({}, ["annotation-xml"]);
    const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ["title", "style", "font", "a", "script"]);
    let PARSER_MEDIA_TYPE = null;
    const SUPPORTED_PARSER_MEDIA_TYPES = ["application/xhtml+xml", "text/html"];
    const DEFAULT_PARSER_MEDIA_TYPE = "text/html";
    let transformCaseFunc = null;
    let CONFIG2 = null;
    const formElement = document2.createElement("form");
    const isRegexOrFunction = function isRegexOrFunction2(testValue) {
      return testValue instanceof RegExp || testValue instanceof Function;
    };
    const _parseConfig = function _parseConfig2() {
      let cfg = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      if (CONFIG2 && CONFIG2 === cfg) {
        return;
      }
      if (!cfg || typeof cfg !== "object") {
        cfg = {};
      }
      cfg = clone(cfg);
      PARSER_MEDIA_TYPE = // eslint-disable-next-line unicorn/prefer-includes
      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;
      transformCaseFunc = PARSER_MEDIA_TYPE === "application/xhtml+xml" ? stringToString : stringToLowerCase;
      ALLOWED_TAGS = objectHasOwnProperty(cfg, "ALLOWED_TAGS") ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;
      ALLOWED_ATTR = objectHasOwnProperty(cfg, "ALLOWED_ATTR") ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;
      ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, "ALLOWED_NAMESPACES") ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;
      URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, "ADD_URI_SAFE_ATTR") ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR, transformCaseFunc) : DEFAULT_URI_SAFE_ATTRIBUTES;
      DATA_URI_TAGS = objectHasOwnProperty(cfg, "ADD_DATA_URI_TAGS") ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS, transformCaseFunc) : DEFAULT_DATA_URI_TAGS;
      FORBID_CONTENTS = objectHasOwnProperty(cfg, "FORBID_CONTENTS") ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;
      FORBID_TAGS = objectHasOwnProperty(cfg, "FORBID_TAGS") ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : clone({});
      FORBID_ATTR = objectHasOwnProperty(cfg, "FORBID_ATTR") ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : clone({});
      USE_PROFILES = objectHasOwnProperty(cfg, "USE_PROFILES") ? cfg.USE_PROFILES : false;
      ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false;
      ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false;
      ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false;
      ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false;
      SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false;
      SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false;
      WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false;
      RETURN_DOM = cfg.RETURN_DOM || false;
      RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false;
      RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false;
      FORCE_BODY = cfg.FORCE_BODY || false;
      SANITIZE_DOM = cfg.SANITIZE_DOM !== false;
      SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false;
      KEEP_CONTENT = cfg.KEEP_CONTENT !== false;
      IN_PLACE = cfg.IN_PLACE || false;
      IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;
      NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;
      MATHML_TEXT_INTEGRATION_POINTS = cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;
      HTML_INTEGRATION_POINTS = cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;
      CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};
      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {
        CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;
      }
      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {
        CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;
      }
      if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === "boolean") {
        CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;
      }
      if (SAFE_FOR_TEMPLATES) {
        ALLOW_DATA_ATTR = false;
      }
      if (RETURN_DOM_FRAGMENT) {
        RETURN_DOM = true;
      }
      if (USE_PROFILES) {
        ALLOWED_TAGS = addToSet({}, text);
        ALLOWED_ATTR = [];
        if (USE_PROFILES.html === true) {
          addToSet(ALLOWED_TAGS, html$1);
          addToSet(ALLOWED_ATTR, html);
        }
        if (USE_PROFILES.svg === true) {
          addToSet(ALLOWED_TAGS, svg$1);
          addToSet(ALLOWED_ATTR, svg);
          addToSet(ALLOWED_ATTR, xml);
        }
        if (USE_PROFILES.svgFilters === true) {
          addToSet(ALLOWED_TAGS, svgFilters);
          addToSet(ALLOWED_ATTR, svg);
          addToSet(ALLOWED_ATTR, xml);
        }
        if (USE_PROFILES.mathMl === true) {
          addToSet(ALLOWED_TAGS, mathMl$1);
          addToSet(ALLOWED_ATTR, mathMl);
          addToSet(ALLOWED_ATTR, xml);
        }
      }
      if (cfg.ADD_TAGS) {
        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {
          ALLOWED_TAGS = clone(ALLOWED_TAGS);
        }
        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);
      }
      if (cfg.ADD_ATTR) {
        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {
          ALLOWED_ATTR = clone(ALLOWED_ATTR);
        }
        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);
      }
      if (cfg.ADD_URI_SAFE_ATTR) {
        addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);
      }
      if (cfg.FORBID_CONTENTS) {
        if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {
          FORBID_CONTENTS = clone(FORBID_CONTENTS);
        }
        addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);
      }
      if (KEEP_CONTENT) {
        ALLOWED_TAGS["#text"] = true;
      }
      if (WHOLE_DOCUMENT) {
        addToSet(ALLOWED_TAGS, ["html", "head", "body"]);
      }
      if (ALLOWED_TAGS.table) {
        addToSet(ALLOWED_TAGS, ["tbody"]);
        delete FORBID_TAGS.tbody;
      }
      if (cfg.TRUSTED_TYPES_POLICY) {
        if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== "function") {
          throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');
        }
        if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== "function") {
          throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');
        }
        trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;
        emptyHTML = trustedTypesPolicy.createHTML("");
      } else {
        if (trustedTypesPolicy === void 0) {
          trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);
        }
        if (trustedTypesPolicy !== null && typeof emptyHTML === "string") {
          emptyHTML = trustedTypesPolicy.createHTML("");
        }
      }
      if (freeze) {
        freeze(cfg);
      }
      CONFIG2 = cfg;
    };
    const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);
    const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);
    const _checkValidNamespace = function _checkValidNamespace2(element) {
      let parent = getParentNode(element);
      if (!parent || !parent.tagName) {
        parent = {
          namespaceURI: NAMESPACE,
          tagName: "template"
        };
      }
      const tagName = stringToLowerCase(element.tagName);
      const parentTagName = stringToLowerCase(parent.tagName);
      if (!ALLOWED_NAMESPACES[element.namespaceURI]) {
        return false;
      }
      if (element.namespaceURI === SVG_NAMESPACE) {
        if (parent.namespaceURI === HTML_NAMESPACE) {
          return tagName === "svg";
        }
        if (parent.namespaceURI === MATHML_NAMESPACE) {
          return tagName === "svg" && (parentTagName === "annotation-xml" || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);
        }
        return Boolean(ALL_SVG_TAGS[tagName]);
      }
      if (element.namespaceURI === MATHML_NAMESPACE) {
        if (parent.namespaceURI === HTML_NAMESPACE) {
          return tagName === "math";
        }
        if (parent.namespaceURI === SVG_NAMESPACE) {
          return tagName === "math" && HTML_INTEGRATION_POINTS[parentTagName];
        }
        return Boolean(ALL_MATHML_TAGS[tagName]);
      }
      if (element.namespaceURI === HTML_NAMESPACE) {
        if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {
          return false;
        }
        if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {
          return false;
        }
        return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);
      }
      if (PARSER_MEDIA_TYPE === "application/xhtml+xml" && ALLOWED_NAMESPACES[element.namespaceURI]) {
        return true;
      }
      return false;
    };
    const _forceRemove = function _forceRemove2(node) {
      arrayPush(DOMPurify.removed, {
        element: node
      });
      try {
        getParentNode(node).removeChild(node);
      } catch (_) {
        remove(node);
      }
    };
    const _removeAttribute = function _removeAttribute2(name, element) {
      try {
        arrayPush(DOMPurify.removed, {
          attribute: element.getAttributeNode(name),
          from: element
        });
      } catch (_) {
        arrayPush(DOMPurify.removed, {
          attribute: null,
          from: element
        });
      }
      element.removeAttribute(name);
      if (name === "is") {
        if (RETURN_DOM || RETURN_DOM_FRAGMENT) {
          try {
            _forceRemove(element);
          } catch (_) {
          }
        } else {
          try {
            element.setAttribute(name, "");
          } catch (_) {
          }
        }
      }
    };
    const _initDocument = function _initDocument2(dirty) {
      let doc = null;
      let leadingWhitespace = null;
      if (FORCE_BODY) {
        dirty = "<remove></remove>" + dirty;
      } else {
        const matches = stringMatch(dirty, /^[\r\n\t ]+/);
        leadingWhitespace = matches && matches[0];
      }
      if (PARSER_MEDIA_TYPE === "application/xhtml+xml" && NAMESPACE === HTML_NAMESPACE) {
        dirty = '<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>' + dirty + "</body></html>";
      }
      const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;
      if (NAMESPACE === HTML_NAMESPACE) {
        try {
          doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);
        } catch (_) {
        }
      }
      if (!doc || !doc.documentElement) {
        doc = implementation.createDocument(NAMESPACE, "template", null);
        try {
          doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;
        } catch (_) {
        }
      }
      const body = doc.body || doc.documentElement;
      if (dirty && leadingWhitespace) {
        body.insertBefore(document2.createTextNode(leadingWhitespace), body.childNodes[0] || null);
      }
      if (NAMESPACE === HTML_NAMESPACE) {
        return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? "html" : "body")[0];
      }
      return WHOLE_DOCUMENT ? doc.documentElement : body;
    };
    const _createNodeIterator = function _createNodeIterator2(root) {
      return createNodeIterator.call(
        root.ownerDocument || root,
        root,
        // eslint-disable-next-line no-bitwise
        NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION,
        null
      );
    };
    const _isClobbered = function _isClobbered2(element) {
      return element instanceof HTMLFormElement && (typeof element.nodeName !== "string" || typeof element.textContent !== "string" || typeof element.removeChild !== "function" || !(element.attributes instanceof NamedNodeMap) || typeof element.removeAttribute !== "function" || typeof element.setAttribute !== "function" || typeof element.namespaceURI !== "string" || typeof element.insertBefore !== "function" || typeof element.hasChildNodes !== "function");
    };
    const _isNode = function _isNode2(value) {
      return typeof Node === "function" && value instanceof Node;
    };
    function _executeHooks(hooks2, currentNode, data) {
      arrayForEach(hooks2, (hook) => {
        hook.call(DOMPurify, currentNode, data, CONFIG2);
      });
    }
    const _sanitizeElements = function _sanitizeElements2(currentNode) {
      let content = null;
      _executeHooks(hooks.beforeSanitizeElements, currentNode, null);
      if (_isClobbered(currentNode)) {
        _forceRemove(currentNode);
        return true;
      }
      const tagName = transformCaseFunc(currentNode.nodeName);
      _executeHooks(hooks.uponSanitizeElement, currentNode, {
        tagName,
        allowedTags: ALLOWED_TAGS
      });
      if (SAFE_FOR_XML && currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\w!]/g, currentNode.innerHTML) && regExpTest(/<[/\w!]/g, currentNode.textContent)) {
        _forceRemove(currentNode);
        return true;
      }
      if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {
        _forceRemove(currentNode);
        return true;
      }
      if (SAFE_FOR_XML && currentNode.nodeType === NODE_TYPE.comment && regExpTest(/<[/\w]/g, currentNode.data)) {
        _forceRemove(currentNode);
        return true;
      }
      if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
        if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {
          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {
            return false;
          }
          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {
            return false;
          }
        }
        if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {
          const parentNode = getParentNode(currentNode) || currentNode.parentNode;
          const childNodes = getChildNodes(currentNode) || currentNode.childNodes;
          if (childNodes && parentNode) {
            const childCount = childNodes.length;
            for (let i = childCount - 1; i >= 0; --i) {
              const childClone = cloneNode(childNodes[i], true);
              childClone.__removalCount = (currentNode.__removalCount || 0) + 1;
              parentNode.insertBefore(childClone, getNextSibling(currentNode));
            }
          }
        }
        _forceRemove(currentNode);
        return true;
      }
      if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {
        _forceRemove(currentNode);
        return true;
      }
      if ((tagName === "noscript" || tagName === "noembed" || tagName === "noframes") && regExpTest(/<\/no(script|embed|frames)/i, currentNode.innerHTML)) {
        _forceRemove(currentNode);
        return true;
      }
      if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {
        content = currentNode.textContent;
        arrayForEach([MUSTACHE_EXPR2, ERB_EXPR2, TMPLIT_EXPR2], (expr) => {
          content = stringReplace(content, expr, " ");
        });
        if (currentNode.textContent !== content) {
          arrayPush(DOMPurify.removed, {
            element: currentNode.cloneNode()
          });
          currentNode.textContent = content;
        }
      }
      _executeHooks(hooks.afterSanitizeElements, currentNode, null);
      return false;
    };
    const _isValidAttribute = function _isValidAttribute2(lcTag, lcName, value) {
      if (SANITIZE_DOM && (lcName === "id" || lcName === "name") && (value in document2 || value in formElement)) {
        return false;
      }
      if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR2, lcName)) ;
      else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR2, lcName)) ;
      else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {
        if (
          // First condition does a very basic check if a) it's basically a valid custom element tagname AND
          // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck
          // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck
          _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || // Alternative, second condition checks if it's an `is`-attribute, AND
          // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck
          lcName === "is" && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))
        ) ;
        else {
          return false;
        }
      } else if (URI_SAFE_ATTRIBUTES[lcName]) ;
      else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE2, ""))) ;
      else if ((lcName === "src" || lcName === "xlink:href" || lcName === "href") && lcTag !== "script" && stringIndexOf(value, "data:") === 0 && DATA_URI_TAGS[lcTag]) ;
      else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA2, stringReplace(value, ATTR_WHITESPACE2, ""))) ;
      else if (value) {
        return false;
      } else ;
      return true;
    };
    const _isBasicCustomElement = function _isBasicCustomElement2(tagName) {
      return tagName !== "annotation-xml" && stringMatch(tagName, CUSTOM_ELEMENT2);
    };
    const _sanitizeAttributes = function _sanitizeAttributes2(currentNode) {
      _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);
      const {
        attributes
      } = currentNode;
      if (!attributes || _isClobbered(currentNode)) {
        return;
      }
      const hookEvent = {
        attrName: "",
        attrValue: "",
        keepAttr: true,
        allowedAttributes: ALLOWED_ATTR,
        forceKeepAttr: void 0
      };
      let l = attributes.length;
      while (l--) {
        const attr = attributes[l];
        const {
          name,
          namespaceURI,
          value: attrValue
        } = attr;
        const lcName = transformCaseFunc(name);
        const initValue = attrValue;
        let value = name === "value" ? initValue : stringTrim(initValue);
        hookEvent.attrName = lcName;
        hookEvent.attrValue = value;
        hookEvent.keepAttr = true;
        hookEvent.forceKeepAttr = void 0;
        _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);
        value = hookEvent.attrValue;
        if (SANITIZE_NAMED_PROPS && (lcName === "id" || lcName === "name")) {
          _removeAttribute(name, currentNode);
          value = SANITIZE_NAMED_PROPS_PREFIX + value;
        }
        if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\/(style|title)/i, value)) {
          _removeAttribute(name, currentNode);
          continue;
        }
        if (hookEvent.forceKeepAttr) {
          continue;
        }
        if (!hookEvent.keepAttr) {
          _removeAttribute(name, currentNode);
          continue;
        }
        if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\/>/i, value)) {
          _removeAttribute(name, currentNode);
          continue;
        }
        if (SAFE_FOR_TEMPLATES) {
          arrayForEach([MUSTACHE_EXPR2, ERB_EXPR2, TMPLIT_EXPR2], (expr) => {
            value = stringReplace(value, expr, " ");
          });
        }
        const lcTag = transformCaseFunc(currentNode.nodeName);
        if (!_isValidAttribute(lcTag, lcName, value)) {
          _removeAttribute(name, currentNode);
          continue;
        }
        if (trustedTypesPolicy && typeof trustedTypes === "object" && typeof trustedTypes.getAttributeType === "function") {
          if (namespaceURI) ;
          else {
            switch (trustedTypes.getAttributeType(lcTag, lcName)) {
              case "TrustedHTML": {
                value = trustedTypesPolicy.createHTML(value);
                break;
              }
              case "TrustedScriptURL": {
                value = trustedTypesPolicy.createScriptURL(value);
                break;
              }
            }
          }
        }
        if (value !== initValue) {
          try {
            if (namespaceURI) {
              currentNode.setAttributeNS(namespaceURI, name, value);
            } else {
              currentNode.setAttribute(name, value);
            }
            if (_isClobbered(currentNode)) {
              _forceRemove(currentNode);
            } else {
              arrayPop(DOMPurify.removed);
            }
          } catch (_) {
            _removeAttribute(name, currentNode);
          }
        }
      }
      _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);
    };
    const _sanitizeShadowDOM = function _sanitizeShadowDOM2(fragment) {
      let shadowNode = null;
      const shadowIterator = _createNodeIterator(fragment);
      _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);
      while (shadowNode = shadowIterator.nextNode()) {
        _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);
        _sanitizeElements(shadowNode);
        _sanitizeAttributes(shadowNode);
        if (shadowNode.content instanceof DocumentFragment) {
          _sanitizeShadowDOM2(shadowNode.content);
        }
      }
      _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);
    };
    DOMPurify.sanitize = function(dirty) {
      let cfg = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
      let body = null;
      let importedNode = null;
      let currentNode = null;
      let returnNode = null;
      IS_EMPTY_INPUT = !dirty;
      if (IS_EMPTY_INPUT) {
        dirty = "<!-->";
      }
      if (typeof dirty !== "string" && !_isNode(dirty)) {
        if (typeof dirty.toString === "function") {
          dirty = dirty.toString();
          if (typeof dirty !== "string") {
            throw typeErrorCreate("dirty is not a string, aborting");
          }
        } else {
          throw typeErrorCreate("toString is not a function");
        }
      }
      if (!DOMPurify.isSupported) {
        return dirty;
      }
      if (!SET_CONFIG) {
        _parseConfig(cfg);
      }
      DOMPurify.removed = [];
      if (typeof dirty === "string") {
        IN_PLACE = false;
      }
      if (IN_PLACE) {
        if (dirty.nodeName) {
          const tagName = transformCaseFunc(dirty.nodeName);
          if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {
            throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place");
          }
        }
      } else if (dirty instanceof Node) {
        body = _initDocument("<!---->");
        importedNode = body.ownerDocument.importNode(dirty, true);
        if (importedNode.nodeType === NODE_TYPE.element && importedNode.nodeName === "BODY") {
          body = importedNode;
        } else if (importedNode.nodeName === "HTML") {
          body = importedNode;
        } else {
          body.appendChild(importedNode);
        }
      } else {
        if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && // eslint-disable-next-line unicorn/prefer-includes
        dirty.indexOf("<") === -1) {
          return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;
        }
        body = _initDocument(dirty);
        if (!body) {
          return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : "";
        }
      }
      if (body && FORCE_BODY) {
        _forceRemove(body.firstChild);
      }
      const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);
      while (currentNode = nodeIterator.nextNode()) {
        _sanitizeElements(currentNode);
        _sanitizeAttributes(currentNode);
        if (currentNode.content instanceof DocumentFragment) {
          _sanitizeShadowDOM(currentNode.content);
        }
      }
      if (IN_PLACE) {
        return dirty;
      }
      if (RETURN_DOM) {
        if (RETURN_DOM_FRAGMENT) {
          returnNode = createDocumentFragment.call(body.ownerDocument);
          while (body.firstChild) {
            returnNode.appendChild(body.firstChild);
          }
        } else {
          returnNode = body;
        }
        if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {
          returnNode = importNode.call(originalDocument, returnNode, true);
        }
        return returnNode;
      }
      let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;
      if (WHOLE_DOCUMENT && ALLOWED_TAGS["!doctype"] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {
        serializedHTML = "<!DOCTYPE " + body.ownerDocument.doctype.name + ">\n" + serializedHTML;
      }
      if (SAFE_FOR_TEMPLATES) {
        arrayForEach([MUSTACHE_EXPR2, ERB_EXPR2, TMPLIT_EXPR2], (expr) => {
          serializedHTML = stringReplace(serializedHTML, expr, " ");
        });
      }
      return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;
    };
    DOMPurify.setConfig = function() {
      let cfg = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
      _parseConfig(cfg);
      SET_CONFIG = true;
    };
    DOMPurify.clearConfig = function() {
      CONFIG2 = null;
      SET_CONFIG = false;
    };
    DOMPurify.isValidAttribute = function(tag, attr, value) {
      if (!CONFIG2) {
        _parseConfig({});
      }
      const lcTag = transformCaseFunc(tag);
      const lcName = transformCaseFunc(attr);
      return _isValidAttribute(lcTag, lcName, value);
    };
    DOMPurify.addHook = function(entryPoint, hookFunction) {
      if (typeof hookFunction !== "function") {
        return;
      }
      arrayPush(hooks[entryPoint], hookFunction);
    };
    DOMPurify.removeHook = function(entryPoint, hookFunction) {
      if (hookFunction !== void 0) {
        const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);
        return index === -1 ? void 0 : arraySplice(hooks[entryPoint], index, 1)[0];
      }
      return arrayPop(hooks[entryPoint]);
    };
    DOMPurify.removeHooks = function(entryPoint) {
      hooks[entryPoint] = [];
    };
    DOMPurify.removeAllHooks = function() {
      hooks = _createHooksMap();
    };
    return DOMPurify;
  }
  var purify = createDOMPurify();
  const emotionData = {
    "/:^_^": {
      t: "Smile",
      id: "0"
    },
    "/:^$^": {
      t: "Shy",
      id: "1"
    },
    "/:Q": {
      t: "Tongue",
      id: "2"
    },
    "/:815": {
      t: "Snicker",
      id: "3"
    },
    "/:809": {
      t: "Admire",
      id: "4"
    },
    "/:^O^": {
      t: "Laugh",
      id: "5"
    },
    "/:081": {
      t: "Dance",
      id: "6"
    },
    "/:087": {
      t: "Blow Kisses",
      id: "7"
    },
    "/:086": {
      t: "Comfort",
      id: "8"
    },
    "/:H": {
      t: "Hug",
      id: "9"
    },
    "/:012": {
      t: "Come on",
      id: "10"
    },
    "/:806": {
      t: "Victory",
      id: "11"
    },
    "/:b": {
      t: "Excellent",
      id: "12"
    },
    "/:^x^": {
      t: "Kiss",
      id: "13"
    },
    "/:814": {
      t: "Infatuated",
      id: "14"
    },
    "/:^W^": {
      t: "Grin",
      id: "15"
    },
    "/:080": {
      t: "Search",
      id: "16"
    },
    "/:066": {
      t: "Call",
      id: "17"
    },
    "/:807": {
      t: "Account",
      id: "18"
    },
    "/:805": {
      t: "Moneygrubber",
      id: "19"
    },
    "/:071": {
      t: "Good Idea",
      id: "20"
    },
    "/:072": {
      t: "Grimace",
      id: "21"
    },
    "/:065": {
      t: "Angel",
      id: "22"
    },
    "/:804": {
      t: "Bye",
      id: "23"
    },
    "/:813": {
      t: "Slobber",
      id: "24"
    },
    "/:818": {
      t: "Enjoy",
      id: "25"
    },
    "/:015": {
      t: "Erotomania",
      id: "26"
    },
    "/:084": {
      t: "Bemused",
      id: "27"
    },
    "/:801": {
      t: "Think",
      id: "28"
    },
    "/:811": {
      t: "Confused",
      id: "29"
    },
    "/:?": {
      t: "Question",
      id: "30"
    },
    "/:077": {
      t: "No Money",
      id: "31"
    },
    "/:083": {
      t: "Bored",
      id: "32"
    },
    "/:817": {
      t: "Doubt",
      id: "33"
    },
    "/:!": {
      t: "Sh",
      id: "34"
    },
    "/:068": {
      t: "Childish",
      id: "35"
    },
    "/:079": {
      t: "Shake",
      id: "36"
    },
    "/:028": {
      t: "Got a Cold",
      id: "37"
    },
    "/:026": {
      t: "Embarrassed",
      id: "38"
    },
    "/:007": {
      t: "Giggle",
      id: "39"
    },
    "/:816": {
      t: "Not Really",
      id: "40"
    },
    '/:\'""': {
      t: "No Choice",
      id: "41"
    },
    "/:802": {
      t: "Perspire",
      id: "42"
    },
    "/:027": {
      t: "Miserable",
      id: "43"
    },
    "/:(Zz...)": {
      t: "Sleepy",
      id: "44"
    },
    "/:*&*": {
      t: "Dizzy",
      id: "45"
    },
    "/:810": {
      t: "Sad",
      id: "46"
    },
    "/:>_<": {
      t: "Grievance",
      id: "47"
    },
    "/:018": {
      t: "Weep",
      id: "48"
    },
    "/:>O<": {
      t: "Cry",
      id: "49"
    },
    "/:020": {
      t: "Howl",
      id: "50"
    },
    "/:044": {
      t: "Speechless",
      id: "51"
    },
    "/:819": {
      t: "Sorry",
      id: "52"
    },
    "/:085": {
      t: "Bye",
      id: "53"
    },
    "/:812": {
      t: "Frown",
      id: "54"
    },
    '/:"': {
      t: "Tired",
      id: "55"
    },
    "/:>M<": {
      t: "Ill",
      id: "56"
    },
    "/:>@<": {
      t: "Puke",
      id: "57"
    },
    "/:076": {
      t: "Bad Luck",
      id: "58"
    },
    "/:069": {
      t: "Surprise",
      id: "59"
    },
    "/:O": {
      t: "Shock",
      id: "60"
    },
    "/:067": {
      t: "Shut up",
      id: "61"
    },
    "/:043": {
      t: "Slap",
      id: "62"
    },
    "/:P": {
      t: "Disdain",
      id: "63"
    },
    "/:808": {
      t: "Fury",
      id: "64"
    },
    "/:>W<": {
      t: "Angry",
      id: "65"
    },
    "/:073": {
      t: "God of Wealth",
      id: "66"
    },
    "/:008": {
      t: "Be Helpful",
      id: "67"
    },
    "/:803": {
      t: "Good Luck",
      id: "68"
    },
    "/:074": {
      t: "Waiter",
      id: "69"
    },
    "/:O=O": {
      t: "Boss",
      id: "70"
    },
    "/:036": {
      t: "Evil",
      id: "71"
    },
    "/:039": {
      t: "Fight Alone",
      id: "72"
    },
    "/:045": {
      t: "CS",
      id: "73"
    },
    "/:046": {
      t: "Invisible Man",
      id: "74"
    },
    "/:048": {
      t: "Bomb",
      id: "75"
    },
    "/:047": {
      t: "Scream",
      id: "76"
    },
    "/:girl": {
      t: "Beauty",
      id: "77"
    },
    "/:man": {
      t: "Handsome Guy",
      id: "78"
    },
    "/:052": {
      t: "Fortune Cat",
      id: "79"
    },
    "/:(OK)": {
      t: "OK",
      id: "80"
    },
    "/:8*8": {
      t: "Applause",
      id: "81"
    },
    "/:)-(": {
      t: "Shake Hands",
      id: "82"
    },
    "/:lip": {
      t: "Lip",
      id: "83"
    },
    "/:-F": {
      t: "Rose",
      id: "84"
    },
    "/:-W": {
      t: "Languished Rose",
      id: "85"
    },
    "/:Y": {
      t: "Love",
      id: "86"
    },
    "/:qp": {
      t: "Heartbreak",
      id: "87"
    },
    "/:$": {
      t: "Money",
      id: "88"
    },
    "/:%": {
      t: "Shopping",
      id: "89"
    },
    "/:(&)": {
      t: "Gift",
      id: "90"
    },
    "/:@": {
      t: "Mail",
      id: "91"
    },
    "/:~B": {
      t: "Phone",
      id: "92"
    },
    "/:U*U": {
      t: "Cheers",
      id: "93"
    },
    "/:clock": {
      t: "Clock",
      id: "94"
    },
    "/:R": {
      t: "Wait",
      id: "95"
    },
    "/:C": {
      t: "Late",
      id: "96"
    },
    "/:plane": {
      t: "Plane",
      id: "97"
    },
    "/:075": {
      t: "Alipay",
      id: "98"
    },
    "/:smile.": {
      t: "smile",
      id: "99"
    },
    "/:shy.": {
      t: "shy",
      id: "100"
    },
    "/:tongue.": {
      t: "tongue",
      id: "101"
    },
    "/:covermouth.": {
      t: "covermouth",
      id: "102"
    },
    "/:love.": {
      t: "love",
      id: "103"
    },
    "/:laugh.": {
      t: "laugh",
      id: "104"
    },
    "/:happy.": {
      t: "happy",
      id: "105"
    },
    "/:Blowkiss.": {
      t: "Blowkiss",
      id: "106"
    },
    "/:pathead.": {
      t: "pathead",
      id: "107"
    },
    "/:hug.": {
      t: "hug",
      id: "108"
    },
    "/:fighting.": {
      t: "fighting",
      id: "109"
    },
    "/:yeah.": {
      t: "yeah",
      id: "110"
    },
    "/:kiss.": {
      t: "kiss",
      id: "111"
    },
    "/:like.": {
      t: "like",
      id: "112"
    },
    "/:smug.": {
      t: "smug",
      id: "113"
    },
    "/:observe.": {
      t: "observe",
      id: "114"
    },
    "/:Broadcast.": {
      t: "Broadcast",
      id: "115"
    },
    "/:kaching.": {
      t: "kaching",
      id: "116"
    },
    "/:inspiration.": {
      t: "inspiration",
      id: "117"
    },
    "/:angel.": {
      t: "angel",
      id: "118"
    },
    "/:greet.": {
      t: "greet",
      id: "119"
    },
    "/:nosebleed.": {
      t: "nosebleed",
      id: "120"
    },
    "/:thinking.": {
      t: "thinking",
      id: "121"
    },
    "/:question.": {
      t: "question",
      id: "122"
    },
    "/:ask.": {
      t: "ask",
      id: "123"
    },
    "/:shush.": {
      t: "shush",
      id: "124"
    },
    "/:embarrassed.": {
      t: "embarrassed",
      id: "125"
    },
    "/:pitiful.": {
      t: "pitiful",
      id: "126"
    },
    "/:tear.": {
      t: "tear",
      id: "127"
    },
    "/:helpless.": {
      t: "helpless",
      id: "128"
    },
    "/:sweatsmile.": {
      t: "sweatsmile",
      id: "129"
    },
    "/:sleep.": {
      t: "sleep",
      id: "130"
    },
    "/:dizzy.": {
      t: "dizzy",
      id: "131"
    },
    "/:surrender.": {
      t: "surrender",
      id: "132"
    },
    "/:sorry.": {
      t: "sorry",
      id: "133"
    },
    "/:speechless.": {
      t: "speechless",
      id: "134"
    },
    "/:shocked.": {
      t: "shocked",
      id: "135"
    },
    "/:shutup.": {
      t: "shutup",
      id: "136"
    },
    "/:Boss.": {
      t: "Boss",
      id: "137"
    },
    "/:Beg.": {
      t: "Beg",
      id: "138"
    },
    "/:received.": {
      t: "received",
      id: "139"
    },
    "/:Busy.": {
      t: "Busy",
      id: "140"
    },
    "/:cute.": {
      t: "cute",
      id: "141"
    },
    "/:angry.": {
      t: "angry",
      id: "142"
    },
    "/:laughcry.": {
      t: "laughcry",
      id: "143"
    },
    "/:facecry.": {
      t: "facecry",
      id: "144"
    },
    "/:raisehand.": {
      t: "raisehand",
      id: "145"
    },
    "/:expect.": {
      t: "expect",
      id: "146"
    },
    "/:ok.": {
      t: "ok",
      id: "147"
    },
    "/:clap.": {
      t: "clap",
      id: "148"
    },
    "/:handshake.": {
      t: "handshake",
      id: "149"
    },
    "/:approve.": {
      t: "approve",
      id: "150"
    },
    "/:pray.": {
      t: "pray",
      id: "151"
    },
    "/:cheer.": {
      t: "cheer",
      id: "152"
    },
    "/:flowers.": {
      t: "flowers",
      id: "153"
    },
    "/:rose.": {
      t: "rose",
      id: "154"
    },
    "/:wither.": {
      t: "wither",
      id: "155"
    },
    "/:heart.": {
      t: "heart",
      id: "156"
    },
    "/:Brokenheart.": {
      t: "Brokenheart",
      id: "157"
    },
    "/:gift.": {
      t: "gift",
      id: "158"
    },
    "/:email.": {
      t: "email",
      id: "159"
    },
    "/:time.": {
      t: "time",
      id: "160"
    },
    "/:airplane.": {
      t: "airplane",
      id: "161"
    },
    "/:package.": {
      t: "package",
      id: "162"
    },
    "/:fire.": {
      t: "fire",
      id: "163"
    },
    "/:money.": {
      t: "money",
      id: "164"
    },
    "/:ship.": {
      t: "ship",
      id: "165"
    }
  };
  var enUs = {
    "messenger.list.content.audio": "Voice",
    "messenger.imHeader.toLogin": "Sign in",
    "messenger.list.content.company": "Company",
    "messenger.list.content.file": "File",
    "messenger.reverseTip": "User recalled a message.",
    "messenger.list.content.businessCard": "Business card",
    "messenger.list.content.behavior": "Card",
    "messenger.list.content.message": "Message",
    "messenger.imHeader.noData": "No new messages",
    "messenger.imHeader.message": "Messages",
    "messenger.list.content.video": "Video",
    "messenger.list.content.aiSummary": "Summary",
    "messenger.imHeader.viewmore": "View more",
    "messenger.list.content.ta": "Order",
    "messenger.list.content.image": "Image",
    "messenger.list.content.quotation": "Quotation",
    "messenger.list.content.tradeAssurance": "Order",
    "messenger.youReverseTip": "You've recalled a message.",
    "messenger.imHeader.LoginTip": "Sign in to view more",
    "messenger.list.content.text": "Message",
    "messenger.list.content.product": "Product"
  };
  var jaJp = {
    "messenger.imHeader.viewmore": "",
    "messenger.imHeader.noData": "",
    "messenger.list.content.ta": "",
    "messenger.list.content.aiSummary": "",
    "messenger.list.content.video": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.imHeader.message": "",
    "messenger.imHeader.LoginTip": "",
    "messenger.list.content.text": "",
    "messenger.list.content.file": "",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.company": "",
    "messenger.list.content.message": "",
    "messenger.list.content.image": "",
    "messenger.list.content.product": "",
    "messenger.list.content.behavior": "",
    "messenger.list.content.audio": "",
    "messenger.list.content.businessCard": "",
    "messenger.reverseTip": "",
    "messenger.youReverseTip": ""
  };
  var zhCn = {
    "messenger.youReverseTip": "",
    "messenger.list.content.ta": "",
    "messenger.list.content.video": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.message": "",
    "messenger.list.content.product": "",
    "messenger.list.content.company": "",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.aiSummary": "",
    "messenger.list.content.audio": "",
    "messenger.list.content.text": "",
    "messenger.list.content.businessCard": "",
    "messenger.imHeader.viewmore": "",
    "messenger.list.content.file": "",
    "messenger.list.content.quotation": "",
    "messenger.list.content.image": "",
    "messenger.imHeader.noData": "",
    "messenger.imHeader.LoginTip": "",
    "messenger.imHeader.message": "",
    "messenger.reverseTip": "",
    "messenger.list.content.behavior": ""
  };
  var hiIn = {
    "messenger.list.content.file": "",
    "messenger.list.content.quotation": "",
    "messenger.youReverseTip": "     .",
    "messenger.imHeader.toLogin": "  ",
    "messenger.list.content.image": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.imHeader.LoginTip": "      ",
    "messenger.list.content.audio": "",
    "messenger.imHeader.noData": "    ",
    "messenger.list.content.behavior": "",
    "messenger.imHeader.message": "",
    "messenger.list.content.businessCard": " ",
    "messenger.list.content.aiSummary": "",
    "messenger.list.content.video": "",
    "messenger.list.content.company": "",
    "messenger.list.content.message": "",
    "messenger.reverseTip": "      .",
    "messenger.list.content.product": "",
    "messenger.imHeader.viewmore": " ",
    "messenger.list.content.ta": "",
    "messenger.list.content.text": ""
  };
  var trTr = {
    "messenger.list.content.image": "Grnt",
    "messenger.list.content.video": "Video",
    "messenger.list.content.aiSummary": "zet",
    "messenger.imHeader.viewmore": "Daha fazlas",
    "messenger.list.content.behavior": "Kart",
    "messenger.list.content.text": "Mesaj",
    "messenger.list.content.ta": "Sipari",
    "messenger.imHeader.noData": "Yeni mesaj yok",
    "messenger.list.content.file": "Dosya",
    "messenger.youReverseTip": "Bir mesaj geri ardnz.",
    "messenger.list.content.product": "rn",
    "messenger.list.content.company": "irket",
    "messenger.imHeader.toLogin": "Giri Yap",
    "messenger.imHeader.message": "Mesajlar",
    "messenger.list.content.businessCard": "Kartvizit",
    "messenger.reverseTip": "Kullanc bir mesaj geri ard.",
    "messenger.list.content.tradeAssurance": "Sipari",
    "messenger.list.content.audio": "Ses",
    "messenger.imHeader.LoginTip": "Daha fazlasn grntlemek iin oturum an",
    "messenger.list.content.message": "Mesaj"
  };
  var koKr = {
    "messenger.imHeader.viewmore": " ",
    "messenger.imHeader.message": "",
    "messenger.list.content.video": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.aiSummary": "",
    "messenger.imHeader.LoginTip": "  ",
    "messenger.list.content.text": "",
    "messenger.list.content.audio": "",
    "messenger.list.content.ta": "",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.product": "",
    "messenger.list.content.image": "",
    "messenger.youReverseTip": " .",
    "messenger.list.content.behavior": "",
    "messenger.list.content.company": "",
    "messenger.list.content.file": "",
    "messenger.imHeader.noData": "  ",
    "messenger.list.content.message": "",
    "messenger.list.content.quotation": "",
    "messenger.list.content.businessCard": "",
    "messenger.reverseTip": "  ."
  };
  var frFr = {
    "messenger.list.content.product": "Produit",
    "messenger.list.content.quotation": "Devis",
    "messenger.imHeader.message": "Messages",
    "messenger.imHeader.noData": "Pas de nouveaux messages",
    "messenger.youReverseTip": "Vous avez rappel un message.",
    "messenger.imHeader.LoginTip": "Connectez-vous pour voir plus",
    "messenger.reverseTip": "Lutilisateur a rappel un message.",
    "messenger.list.content.behavior": "Carte",
    "messenger.list.content.ta": "Commande",
    "messenger.list.content.image": "Image",
    "messenger.imHeader.viewmore": "En savoir plus",
    "messenger.list.content.aiSummary": "Rsum",
    "messenger.list.content.businessCard": "Carte de visite",
    "messenger.list.content.video": "Vido",
    "messenger.list.content.tradeAssurance": "Commande",
    "messenger.list.content.message": "Message",
    "messenger.list.content.audio": "Voix",
    "messenger.list.content.company": "Socit",
    "messenger.list.content.file": "Fichier",
    "messenger.imHeader.toLogin": "Se connecter",
    "messenger.list.content.text": "Message"
  };
  var esEs = {
    "messenger.youReverseTip": "Has eliminado un mensaje.",
    "messenger.list.content.video": "Vdeo",
    "messenger.list.content.tradeAssurance": "Pedido",
    "messenger.list.content.aiSummary": "Resumen",
    "messenger.list.content.ta": "Pedido",
    "messenger.list.content.product": "Producto",
    "messenger.imHeader.viewmore": "Ver ms",
    "messenger.list.content.image": "Imagen",
    "messenger.imHeader.LoginTip": "Inicia sesin para ver ms",
    "messenger.list.content.behavior": "Tarjeta",
    "messenger.list.content.quotation": "Presupuesto",
    "messenger.list.content.businessCard": "Tarjeta de empresa",
    "messenger.imHeader.message": "Mensajes",
    "messenger.list.content.message": "MENSAJE",
    "messenger.list.content.file": "Archivo",
    "messenger.imHeader.noData": "No hay mensajes nuevos",
    "messenger.imHeader.toLogin": "Iniciar sesin",
    "messenger.list.content.audio": "Voz",
    "messenger.reverseTip": "El usuario elimin un mensaje.",
    "messenger.list.content.text": "MENSAJE",
    "messenger.list.content.company": "Compaa"
  };
  var inId = {
    "messenger.list.content.company": "Perusahaan",
    "messenger.list.content.file": "File",
    "messenger.list.content.tradeAssurance": "Pesan",
    "messenger.list.content.product": "Produk",
    "messenger.list.content.message": "Pesan",
    "messenger.list.content.ta": "Pesan",
    "messenger.imHeader.viewmore": "Lihat Lainnya",
    "messenger.list.content.businessCard": "Kartu bisnis",
    "messenger.list.content.audio": "Suara",
    "messenger.list.content.video": "Video",
    "messenger.youReverseTip": "Anda telah menarik kembali pesan.",
    "messenger.list.content.aiSummary": "Ringkasan",
    "messenger.imHeader.message": "Pesan",
    "messenger.list.content.behavior": "Kartu",
    "messenger.imHeader.noData": "Tidak ada pesan baru",
    "messenger.list.content.image": "Gambar",
    "messenger.reverseTip": "Pengguna telah menarik kembali pesan.",
    "messenger.imHeader.LoginTip": "Masuk untuk lihat selengkapnya",
    "messenger.list.content.text": "Pesan",
    "messenger.list.content.quotation": "Penawaran"
  };
  var arSa = {
    "messenger.imHeader.LoginTip": "   ",
    "messenger.list.content.file": "",
    "messenger.list.content.quotation": " ",
    "messenger.imHeader.noData": "   ",
    "messenger.list.content.company": "",
    "messenger.list.content.text": "",
    "messenger.youReverseTip": "  .",
    "messenger.list.content.image": "",
    "messenger.list.content.product": "",
    "messenger.reverseTip": "  .",
    "messenger.list.content.message": "",
    "messenger.list.content.ta": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.imHeader.viewmore": " ",
    "messenger.list.content.businessCard": " ",
    "messenger.imHeader.message": "",
    "messenger.list.content.audio": "",
    "messenger.imHeader.toLogin": " ",
    "messenger.list.content.video": "",
    "messenger.list.content.aiSummary": "",
    "messenger.list.content.behavior": ""
  };
  var viVn = {
    "messenger.list.content.businessCard": "Danh thip",
    "messenger.imHeader.message": "Tin nhn",
    "messenger.list.content.product": "Sn phm",
    "messenger.list.content.company": "Cng ty",
    "messenger.list.content.file": "Tp tin",
    "messenger.list.content.message": "Tin nhn",
    "messenger.list.content.text": "Tin nhn",
    "messenger.list.content.image": "Hnh nh",
    "messenger.list.content.audio": "Ging ni",
    "messenger.youReverseTip": "Bn  thu hi tin nhn.",
    "messenger.reverseTip": "Ngi dng  thu hi tin nhn.",
    "messenger.list.content.aiSummary": "Tm tt",
    "messenger.list.content.video": "Video",
    "messenger.list.content.quotation": "Bo gi",
    "messenger.list.content.tradeAssurance": "t hng",
    "messenger.list.content.ta": "t hng",
    "messenger.imHeader.viewmore": "Xem thm",
    "messenger.list.content.behavior": "Th",
    "messenger.imHeader.toLogin": "ng Nhp",
    "messenger.imHeader.noData": "Khng c tin nhn mi",
    "messenger.imHeader.LoginTip": "ng nhp  xem thm"
  };
  var ptPt = {
    "messenger.imHeader.message": "Mensagens",
    "messenger.list.content.tradeAssurance": "Pedido",
    "messenger.list.content.audio": "Voz",
    "messenger.list.content.text": "Mensagem",
    "messenger.list.content.company": "Empresa",
    "messenger.list.content.ta": "Pedido",
    "messenger.imHeader.LoginTip": "Entre para ver mais",
    "messenger.list.content.aiSummary": "Resumo",
    "messenger.list.content.quotation": "Cotao",
    "messenger.list.content.businessCard": "Carto de visita",
    "messenger.imHeader.noData": "Nenhuma nova mensagem",
    "messenger.list.content.file": "Arquivo",
    "messenger.reverseTip": "O usurio cancelou uma mensagem.",
    "messenger.list.content.image": "Imagem",
    "messenger.imHeader.viewmore": "Ver Mais",
    "messenger.list.content.behavior": "Carto",
    "messenger.youReverseTip": "Voc cancelou uma mensagem.",
    "messenger.imHeader.toLogin": "Entrar",
    "messenger.list.content.video": "Vdeo",
    "messenger.list.content.message": "Mensagem",
    "messenger.list.content.product": "Produto"
  };
  var deDe = {
    "messenger.list.content.message": "Nachricht",
    "messenger.list.content.tradeAssurance": "Bestellen",
    "messenger.list.content.audio": "Sprachnachricht",
    "messenger.list.content.businessCard": "Visitenkarte",
    "messenger.list.content.image": "Bild",
    "messenger.reverseTip": "Der Benutzer hat eine Nachricht zurckgerufen.",
    "messenger.list.content.text": "Nachricht",
    "messenger.imHeader.toLogin": "Anmelden",
    "messenger.list.content.product": "Produkt",
    "messenger.list.content.behavior": "Karte",
    "messenger.youReverseTip": "Sie haben eine Nachricht zurckgerufen.",
    "messenger.list.content.company": "Unternehmen",
    "messenger.imHeader.LoginTip": "Anmelden, um mehr anzuzeigen",
    "messenger.list.content.quotation": "Angebot",
    "messenger.list.content.file": "Datei",
    "messenger.imHeader.viewmore": "Mehr anzeigen",
    "messenger.imHeader.noData": "Keine neuen Nachrichten",
    "messenger.imHeader.message": "Nachrichten",
    "messenger.list.content.aiSummary": "Zusammenfassung",
    "messenger.list.content.video": "Video"
  };
  var thTh = {
    "messenger.list.content.image": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.message": "",
    "messenger.list.content.behavior": "",
    "messenger.list.content.video": "",
    "messenger.list.content.businessCard": "",
    "messenger.list.content.company": "",
    "messenger.reverseTip": "",
    "messenger.list.content.text": "",
    "messenger.imHeader.LoginTip": "",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.product": "",
    "messenger.imHeader.viewmore": "",
    "messenger.list.content.quotation": "",
    "messenger.list.content.file": "",
    "messenger.list.content.ta": "",
    "messenger.list.content.audio": "",
    "messenger.imHeader.noData": "",
    "messenger.youReverseTip": "",
    "messenger.imHeader.message": ""
  };
  var itIt = {
    "messenger.list.content.tradeAssurance": "Ordine",
    "messenger.imHeader.message": "Messaggi",
    "messenger.list.content.aiSummary": "Riepilogo",
    "messenger.list.content.video": "Video",
    "messenger.list.content.product": "Prodotto",
    "messenger.list.content.audio": "Voce",
    "messenger.youReverseTip": "Hai richiamato un messaggio.",
    "messenger.list.content.file": "File",
    "messenger.list.content.company": "Azienda",
    "messenger.list.content.message": "Il messaggio",
    "messenger.imHeader.LoginTip": "Accedi per visualizzare altro",
    "messenger.list.content.ta": "Ordine",
    "messenger.list.content.text": "Il messaggio",
    "messenger.list.content.quotation": "Preventivo",
    "messenger.list.content.businessCard": "Biglietto da visita",
    "messenger.reverseTip": "Un messaggio  stato richiamato dall'utente.",
    "messenger.list.content.image": "Immagine",
    "messenger.list.content.behavior": "Scheda",
    "messenger.imHeader.viewmore": "Visualizza altro",
    "messenger.imHeader.toLogin": "Iscriviti",
    "messenger.imHeader.noData": "Nessun nuovo messaggio"
  };
  var nlNl = {
    "messenger.list.content.behavior": "Kaart",
    "messenger.list.content.ta": "Bestelling",
    "messenger.imHeader.LoginTip": "Meld u aan om meer te bekijken",
    "messenger.youReverseTip": "U hebt een bericht teruggeroepen.",
    "messenger.imHeader.toLogin": "Aanmelden",
    "messenger.list.content.product": "Product",
    "messenger.list.content.businessCard": "Visitekaartje",
    "messenger.list.content.company": "Bedrijf",
    "messenger.reverseTip": "De gebruiker heeft een bericht teruggeroepen.",
    "messenger.list.content.quotation": "Offerte",
    "messenger.imHeader.message": "Berichten",
    "messenger.list.content.tradeAssurance": "Bestelling",
    "messenger.list.content.video": "Video",
    "messenger.list.content.text": "Bericht",
    "messenger.imHeader.viewmore": "Meer weergeven",
    "messenger.list.content.audio": "Stem",
    "messenger.list.content.image": "Afbeelding",
    "messenger.list.content.message": "Bericht",
    "messenger.list.content.aiSummary": "Samenvatting",
    "messenger.list.content.file": "Bestand",
    "messenger.imHeader.noData": "Geen nieuwe berichten"
  };
  var ruRu = {
    "messenger.list.content.video": "",
    "messenger.list.content.product": "",
    "messenger.list.content.company": "",
    "messenger.imHeader.LoginTip": ",   ",
    "messenger.list.content.text": "",
    "messenger.imHeader.message": "",
    "messenger.list.content.behavior": "",
    "messenger.list.content.quotation": "",
    "messenger.reverseTip": "   .",
    "messenger.imHeader.noData": "  ",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.image": "",
    "messenger.imHeader.viewmore": " ",
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.aiSummary": " ",
    "messenger.list.content.audio": "",
    "messenger.youReverseTip": "   .",
    "messenger.list.content.file": "",
    "messenger.list.content.message": "",
    "messenger.list.content.ta": ""
  };
  var iwIl = {
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.businessCard": " ",
    "messenger.list.content.file": "",
    "messenger.list.content.message": "",
    "messenger.list.content.ta": "",
    "messenger.imHeader.viewmore": " ",
    "messenger.list.content.product": "",
    "messenger.reverseTip": "     .",
    "messenger.imHeader.toLogin": "",
    "messenger.list.content.quotation": " ",
    "messenger.list.content.company": "",
    "messenger.youReverseTip": " .",
    "messenger.imHeader.message": "",
    "messenger.list.content.text": "",
    "messenger.list.content.image": "",
    "messenger.list.content.behavior": "",
    "messenger.list.content.audio": "",
    "messenger.imHeader.LoginTip": "   ",
    "messenger.list.content.aiSummary": "",
    "messenger.list.content.video": "",
    "messenger.imHeader.noData": "  "
  };
  var zhTw = {
    "messenger.list.content.image": "",
    "messenger.list.content.businessCard": "",
    "messenger.list.content.message": "",
    "messenger.list.content.quotation": "",
    "messenger.list.content.audio": "",
    "messenger.list.content.text": "",
    "messenger.reverseTip": "",
    "messenger.list.content.company": "",
    "messenger.list.content.tradeAssurance": "",
    "messenger.list.content.file": "",
    "messenger.list.content.product": "",
    "messenger.list.content.ta": "",
    "messenger.youReverseTip": "",
    "messenger.list.content.video": "",
    "messenger.list.content.behavior": "",
    "messenger.list.content.aiSummary": ""
  };
  var bnIn = {
    "messenger.youReverseTip": "##@@@messenger.youReverseTip##intl-gangesweb@@@##",
    "messenger.list.content.image": "##@@@messenger.list.content.image##intl-gangesweb@@@##",
    "messenger.list.content.aiSummary": "##@@@messenger.list.content.aiSummary##intl-gangesweb@@@##",
    "messenger.list.content.message": "##@@@messenger.list.content.message##intl-gangesweb@@@##",
    "messenger.list.content.product": "##@@@messenger.list.content.product##intl-gangesweb@@@##",
    "messenger.list.content.businessCard": "##@@@messenger.list.content.businessCard##intl-gangesweb@@@##",
    "messenger.list.content.company": "##@@@messenger.list.content.company##intl-gangesweb@@@##",
    "messenger.list.content.behavior": "##@@@messenger.list.content.behavior##intl-gangesweb@@@##",
    "messenger.reverseTip": "##@@@messenger.reverseTip##intl-gangesweb@@@##",
    "messenger.list.content.ta": "##@@@messenger.list.content.ta##intl-gangesweb@@@##"
  };
  var i18n = {};
  var defaultLocale = "en-us";
  i18n["en-us"] = enUs;
  i18n["ja-jp"] = jaJp;
  i18n["zh-cn"] = zhCn;
  i18n["hi-in"] = hiIn;
  i18n["tr-tr"] = trTr;
  i18n["ko-kr"] = koKr;
  i18n["fr-fr"] = frFr;
  i18n["es-es"] = esEs;
  i18n["in-id"] = inId;
  i18n["ar-sa"] = arSa;
  i18n["vi-vn"] = viVn;
  i18n["pt-pt"] = ptPt;
  i18n["de-de"] = deDe;
  i18n["th-th"] = thTh;
  i18n["it-it"] = itIt;
  i18n["nl-nl"] = nlNl;
  i18n["ru-ru"] = ruRu;
  i18n["iw-il"] = iwIl;
  i18n["zh-tw"] = zhTw;
  i18n["bn-in"] = bnIn;
  for (var locale$1 in i18n) {
    if (!i18n.hasOwnProperty(locale$1)) {
      continue;
    }
    if (locale$1 == defaultLocale) {
      continue;
    }
    for (var key in i18n[defaultLocale]) {
      if (!i18n[defaultLocale].hasOwnProperty(key)) {
        continue;
      }
      if (!i18n[locale$1].hasOwnProperty(key)) {
        i18n[locale$1][key] = i18n[defaultLocale][key];
      }
    }
  }
  i18n.appName = "intl-gangesweb";
  i18n.groupName = "im-header";
  i18n.defaultLocale = defaultLocale;
  var mcms_intlGangesweb_imHeader = i18n;
  const I18NData = /* @__PURE__ */ getDefaultExportFromCjs(mcms_intlGangesweb_imHeader);
  const locale = getBuyerLocale();
  const I18N = {
    get(key2) {
      var _a;
      let language = "en-us";
      if (locale) {
        language = `${locale.lang}-${locale.country}`.toLowerCase();
      }
      return ((_a = I18NData[language]) == null ? void 0 : _a[key2]) || key2;
    }
  };
  const isRichText = (content) => {
    if (!(typeof content === "string")) {
      return false;
    }
    return content && content.search(/<img|<strong/) > 0;
  };
  const replaceContent = (_content) => {
    let content = _content.toString();
    content = content.replace(/<img(.*?atmgateway-client.alibaba.com)/g, "<image$1");
    content = content.replace(/<img[^>]*>/gm, "[Image]");
    content = content.replace(/<(?!image|\/image|strong|\/strong).*?>/g, "");
    content = content.replace(/<image/, "<img");
    content = `<p>${content}</p>`;
    return {
      __html: content
    };
  };
  const formatContentOld = (content, imMessageType) => {
    switch (imMessageType) {
      case 1:
        content = content.toString();
        if (content.match("<img src=")) {
          return `[${I18N.get("messenger.list.content.image") || "Image"}]`;
        }
        return content;
      case 2:
        return `[${I18N.get("messenger.list.content.image") || "Image"}]`;
      case 3:
      case 53:
      case 61:
        return `[${I18N.get("messenger.list.content.file") || "File"}]`;
      case 4:
        return `[${I18N.get("messenger.list.content.audio") || "Audio"}]`;
      case 5:
      case 62:
        return `[${I18N.get("messenger.list.content.video") || "Video"}]`;
      case 50:
      case 2e3:
      case 2008:
        return `[${I18N.get("messenger.list.content.message") || "Message"}]`;
      case 52:
        return `[${I18N.get("messenger.list.content.quotation") || "Quotation"}]`;
      case 54:
        return `[${I18N.get("messenger.list.content.product") || "Product"}]`;
      case 55:
        return `[${I18N.get("messenger.list.content.company") || "Company"}]`;
      case 56:
        return `[${I18N.get("messenger.list.content.behavior") || "Behavior"}]`;
      case 57:
        return `[${I18N.get("messenger.list.content.businessCard") || "Business card"}]`;
      case 58:
        return `[${I18N.get("messenger.list.content.ta") || "TA"}]`;
      case 59:
        return `[${I18N.get("messenger.list.content.tradeAssurance") || "Trade Assurance"}]`;
      case 60:
        return `[${I18N.get("messenger.list.content.image") || "Image"}]`;
      case 63:
        return `[${I18N.get("messenger.list.content.text") || "Text"}]`;
      case 64:
        return `[${I18N.get("messenger.list.content.orderTracking") || "Order Tracking"}]`;
      case 65:
        return `[${I18N.get("messenger.list.content.businessCard") || "Business card"}]`;
      case 66:
        return `[${I18N.get("messenger.list.content.businessCard") || "Business card"}]`;
      case 2001:
        return `[${I18N.get("messenger.list.content.quotation") || "Quotation"}]`;
      case 2002:
        return `[${I18N.get("messenger.list.content.ta") || "Order"}]`;
      case 9409:
        return `[${I18N.get("messenger.list.content.aiSummary") || "Summary"}]`;
      default:
        return `[${I18N.get("messenger.list.content.message") || "Message"}]`;
    }
  };
  const formatHtmlContent = (_content, imMessageType) => {
    let content;
    content = purify.sanitize(_content);
    if (isRichText(content) && content.startsWith("<p>")) {
      return replaceContent(content);
    }
    content = content.toString();
    content = content.replace(/\/n/g, "");
    const emotions = content.match(/\/:[^\/]+\.?/g) || [];
    if (emotions.length) {
      emotions.forEach(() => {
        for (const key2 in emotionData) {
          content = content.replace(
            `[${key2}]`,
            `<img width="32px" height="32px" src="//atmgateway-client.alibaba.com/smily-big/smile_${emotionData[key2].id}.png" />`
          );
          content = content.replace(
            key2,
            `<img width="32px" height="32px" src="//atmgateway-client.alibaba.com/smily-big/smile_${emotionData[key2].id}.png" />`
          );
        }
      });
      return { __html: `${content}` };
    }
    if ([1, 100015].includes(imMessageType) && content) {
      return replaceContent(content);
    }
    return null;
  };
  const MsgUtil = {
    formatContent(contentParam = "", imMessageType) {
      const content = decodeHTML(contentParam);
      const originContent = formatContentOld(content, imMessageType);
      const htmlContent = formatHtmlContent(content, imMessageType);
      return {
        content: originContent,
        htmlContent
      };
    }
  };
  function ListItem({ itemData, isExp }) {
    const {
      fullPortrait,
      name,
      loginId,
      accountId,
      accountIdEncrypt,
      unreadCount,
      chatToken,
      companyName,
      lastMsg = {}
    } = itemData;
    const { content, sendType, viewType, time: sendTime, msgType = 1 } = lastMsg;
    const finalName = name || loginId || accountId || "";
    const formatContent = (_content = "") => {
      if (viewType === 3) {
        return sendType === "send" ? I18N.get("messenger.youReverseTip") : I18N.get("messenger.reverseTip");
      } else {
        const { content: retContent, htmlContent } = MsgUtil.formatContent(_content, msgType);
        return htmlContent || retContent;
      }
    };
    const toMessenger = () => {
      goldlog("toMessenger");
      const messengerUrl = `${getMessengerUrl()}?activeAccountId=${accountId}&activeAccountIdEncrypt=${accountIdEncrypt}&chatToken=${chatToken}`;
      window.open(messengerUrl);
    };
    const formatedContent = formatContent(content);
    return /* @__PURE__ */ React.createElement("div", { className: "im-header-list-item", onClick: toMessenger }, /* @__PURE__ */ React.createElement("div", { className: "contact-left" }, fullPortrait ? /* @__PURE__ */ React.createElement("img", { src: fullPortrait }) : /* @__PURE__ */ React.createElement(
      "div",
      {
        className: "letter",
        style: {
          backgroundColor: getAvatarBackground(finalName)
        }
      },
      finalName.slice(0, 1)
    )), /* @__PURE__ */ React.createElement("div", { className: "contact-right" }, /* @__PURE__ */ React.createElement("div", { className: "contact-info" }, /* @__PURE__ */ React.createElement("span", { className: "name", title: finalName }, finalName), Number(sendTime) > 0 && isExp && /* @__PURE__ */ React.createElement("span", { className: "contact-time" }, timeSince(sendTime))), companyName && /* @__PURE__ */ React.createElement("div", { className: "contact-company" }, companyName), formatedContent && isExp && /* @__PURE__ */ React.createElement("div", { className: "msg-wrapper" }, /* @__PURE__ */ React.createElement("div", { className: `latest-msg latest-msg-rec` }, typeof formatedContent !== "object" ? /* @__PURE__ */ React.createElement("p", { className: "latest-msg-oneline" }, /* @__PURE__ */ React.createElement("span", null, formatedContent)) : /* @__PURE__ */ React.createElement("div", { className: "latest-msg-oneline", dangerouslySetInnerHTML: formatedContent })))), /* @__PURE__ */ React.createElement("div", { className: "unread-count" }, unreadCount > 99 ? "99+" : unreadCount));
  }
  const login_url = `https://${PASSPORT_DOMAIN}/icbu_login.htm?return_url=${encodeURIComponent(
    window.location.href
  )}&scene=imHeaderNotification`;
  function List({ listData, isExp }) {
    return /* @__PURE__ */ React.createElement("div", { className: "im-header-list" }, /* @__PURE__ */ React.createElement("div", { className: "list-header" }, I18N.get("messenger.imHeader.message") || "Messages"), checkLogin() ? /* @__PURE__ */ React.createElement(React.Fragment, null, (listData == null ? void 0 : listData.length) ? listData.slice(0, isExp ? 4 : 3).map((item) => /* @__PURE__ */ React.createElement(ListItem, { key: item.accounId, itemData: item, isExp })) : /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(
      "img",
      {
        src: "https://s.alicdn.com/@img/imgextra/i4/O1CN01lnw1WK1bGeXDIoBnB_!!6000000003438-2-tps-399-303.png",
        className: "no-data-img"
      }
    ), /* @__PURE__ */ React.createElement("div", { className: "no-data-tip" }, I18N.get("messenger.imHeader.noData") || "No messages")), /* @__PURE__ */ React.createElement("div", { className: "button-bar" }, /* @__PURE__ */ React.createElement("a", { target: "_blank", href: getMessengerUrl(), rel: "noreferrer" }, /* @__PURE__ */ React.createElement("button", { className: "list-view-more", onClick: () => goldlog("viewMore") }, I18N.get("messenger.imHeader.viewmore") || "View more")))) : /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("div", { className: "login-tip" }, I18N.get("messenger.imHeader.LoginTip") || "Sign in to view messages"), /* @__PURE__ */ React.createElement("div", { className: "button-bar" }, /* @__PURE__ */ React.createElement("a", { href: login_url, rel: "noreferrer" }, /* @__PURE__ */ React.createElement("button", { className: "list-view-more", onClick: () => goldlog("toLogin") }, I18N.get("messenger.imHeader.toLogin") || "To login")))));
  }
  function getUnreadInfo(data) {
    const { ctoken, pageId, params } = data;
    const url = `//${ONETALK_DOMAIN}/message/manager/unread.htm?ctoken=${encodeURIComponent(ctoken)}&dmtrack_pageid=${encodeURIComponent(pageId)}&params=${encodeURIComponent(JSON.stringify(params))}`;
    return fetch(url, {
      method: "GET",
      credentials: "include",
      headers: {
        "content-type": "application/x-www-form-urlencoded; charset=UTF-8"
      },
      mode: "cors",
      cache: "no-cache"
    }).then((response) => response.json());
  }
  const singleChatReg = /^\d+-\d+#11011(@icbu)?$/;
  function ImHeaderNotification() {
    const [listData, setListData] = React.useState([]);
    const [unreadCount, setUnreadCount] = React.useState(0);
    const [isExp, setIsExp] = React.useState(false);
    const cbSaver = React.useRef({});
    React.useEffect(() => {
      getUnreadInfo({
        ctoken: getCtoken(),
        // @ts-ignore
        pageId: window.dmtrack_pageid || "",
        params: {
          secAccountId: localStorage.getItem("sc-header-message-account-id") || "",
          needList: true
        }
      }).then((res) => {
        const { code, data } = res;
        if (code * 1 === 200 && (data == null ? void 0 : data.list)) {
          const list = data.list.filter(
            (item) => !item.mute && !item.block && singleChatReg.test(item.cid)
          );
          setListData(list);
        }
      });
      getTreatment({
        appName: "im-messenger",
        // 
        testKey: "im_header_notification"
        // 
      }).then((res) => {
        const { treatment } = res != null ? res : {};
        if (treatment === "exp") {
          setIsExp(true);
        }
      });
      window.addEventListener(
        "message",
        (event2) => {
          if (!/onetalk\.alibaba/gi.test(event2.origin)) {
            return false;
          }
          let data;
          try {
            data = JSON.parse(event2.data);
          } catch (e) {
            console.error("==== parse message error ====", e);
          }
          if (!data) return false;
          switch (data.type) {
            case "imUnreadCountChange":
              cbSaver.current.handleUnreadCountChange(data);
              break;
          }
        },
        false
      );
    }, []);
    cbSaver.current = {
      handleUnreadCountChange: (payload) => {
        setUnreadCount(payload.unreadCnt || 0);
      }
    };
    return /* @__PURE__ */ React.createElement("div", { className: "im-header-notification", "data-tnh-auto-exp": "message", "data-tnh-auto-clk": "message" }, unreadCount > 0 && /* @__PURE__ */ React.createElement("div", { className: "unread-count" }, unreadCount > 99 ? "99+" : unreadCount), /* @__PURE__ */ React.createElement("a", { target: "_blank", href: getMessengerUrl(), rel: "noreferrer", className: "action-icon" }, SVG_MAP.message), /* @__PURE__ */ React.createElement("div", { className: "balloon-wrapper" }, /* @__PURE__ */ React.createElement(List, { listData, isExp })));
  }
  window.ImHeaderNotification = ImHeaderNotification;
  exports2.ImHeaderNotification = ImHeaderNotification;
  exports2.default = ImHeaderNotification;
  Object.defineProperties(exports2, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
});
